(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function J2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lv={exports:{}},Bu={},Mv={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xl=Symbol.for("react.element"),Z2=Symbol.for("react.portal"),eT=Symbol.for("react.fragment"),tT=Symbol.for("react.strict_mode"),rT=Symbol.for("react.profiler"),nT=Symbol.for("react.provider"),iT=Symbol.for("react.context"),sT=Symbol.for("react.forward_ref"),aT=Symbol.for("react.suspense"),oT=Symbol.for("react.memo"),lT=Symbol.for("react.lazy"),h1=Symbol.iterator;function cT(e){return e===null||typeof e!="object"?null:(e=h1&&e[h1]||e["@@iterator"],typeof e=="function"?e:null)}var bv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bv=Object.assign,Uv={};function Ta(e,t,r){this.props=e,this.context=t,this.refs=Uv,this.updater=r||bv}Ta.prototype.isReactComponent={};Ta.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ta.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wv(){}Wv.prototype=Ta.prototype;function Kh(e,t,r){this.props=e,this.context=t,this.refs=Uv,this.updater=r||bv}var Xh=Kh.prototype=new Wv;Xh.constructor=Kh;Bv(Xh,Ta.prototype);Xh.isPureReactComponent=!0;var d1=Array.isArray,Hv=Object.prototype.hasOwnProperty,Yh={current:null},Vv={key:!0,ref:!0,__self:!0,__source:!0};function zv(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Hv.call(t,n)&&!Vv.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:xl,type:e,key:s,ref:a,props:i,_owner:Yh.current}}function uT(e,t){return{$$typeof:xl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function qh(e){return typeof e=="object"&&e!==null&&e.$$typeof===xl}function fT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var p1=/\/+/g;function T0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?fT(""+e.key):t.toString(36)}function gc(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case xl:case Z2:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+T0(a,0):n,d1(i)?(r="",e!=null&&(r=e.replace(p1,"$&/")+"/"),gc(i,t,r,"",function(c){return c})):i!=null&&(qh(i)&&(i=uT(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(p1,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",d1(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+T0(s,o);a+=gc(s,t,r,l,i)}else if(l=cT(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+T0(s,o++),a+=gc(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Hl(e,t,r){if(e==null)return e;var n=[],i=0;return gc(e,n,"","",function(s){return t.call(r,s,i++)}),n}function hT(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var sr={current:null},vc={transition:null},dT={ReactCurrentDispatcher:sr,ReactCurrentBatchConfig:vc,ReactCurrentOwner:Yh};function jv(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:Hl,forEach:function(e,t,r){Hl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Hl(e,function(){t++}),t},toArray:function(e){return Hl(e,function(t){return t})||[]},only:function(e){if(!qh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ae.Component=Ta;Ae.Fragment=eT;Ae.Profiler=rT;Ae.PureComponent=Kh;Ae.StrictMode=tT;Ae.Suspense=aT;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dT;Ae.act=jv;Ae.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Bv({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Yh.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Hv.call(t,l)&&!Vv.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:xl,type:e.type,key:i,ref:s,props:n,_owner:a}};Ae.createContext=function(e){return e={$$typeof:iT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:nT,_context:e},e.Consumer=e};Ae.createElement=zv;Ae.createFactory=function(e){var t=zv.bind(null,e);return t.type=e,t};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(e){return{$$typeof:sT,render:e}};Ae.isValidElement=qh;Ae.lazy=function(e){return{$$typeof:lT,_payload:{_status:-1,_result:e},_init:hT}};Ae.memo=function(e,t){return{$$typeof:oT,type:e,compare:t===void 0?null:t}};Ae.startTransition=function(e){var t=vc.transition;vc.transition={};try{e()}finally{vc.transition=t}};Ae.unstable_act=jv;Ae.useCallback=function(e,t){return sr.current.useCallback(e,t)};Ae.useContext=function(e){return sr.current.useContext(e)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(e){return sr.current.useDeferredValue(e)};Ae.useEffect=function(e,t){return sr.current.useEffect(e,t)};Ae.useId=function(){return sr.current.useId()};Ae.useImperativeHandle=function(e,t,r){return sr.current.useImperativeHandle(e,t,r)};Ae.useInsertionEffect=function(e,t){return sr.current.useInsertionEffect(e,t)};Ae.useLayoutEffect=function(e,t){return sr.current.useLayoutEffect(e,t)};Ae.useMemo=function(e,t){return sr.current.useMemo(e,t)};Ae.useReducer=function(e,t,r){return sr.current.useReducer(e,t,r)};Ae.useRef=function(e){return sr.current.useRef(e)};Ae.useState=function(e){return sr.current.useState(e)};Ae.useSyncExternalStore=function(e,t,r){return sr.current.useSyncExternalStore(e,t,r)};Ae.useTransition=function(){return sr.current.useTransition()};Ae.version="18.3.1";Mv.exports=Ae;var Ke=Mv.exports;const pT=J2(Ke);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mT=Ke,gT=Symbol.for("react.element"),vT=Symbol.for("react.fragment"),xT=Object.prototype.hasOwnProperty,_T=mT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yT={key:!0,ref:!0,__self:!0,__source:!0};function $v(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)xT.call(t,n)&&!yT.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:gT,type:e,key:s,ref:a,props:i,_owner:_T.current}}Bu.Fragment=vT;Bu.jsx=$v;Bu.jsxs=$v;Lv.exports=Bu;var K=Lv.exports,Gv={exports:{}},Tr={},Kv={exports:{}},Xv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,M){var te=J.length;J.push(M);e:for(;0<te;){var ue=te-1>>>1,I=J[ue];if(0<i(I,M))J[ue]=M,J[te]=I,te=ue;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var M=J[0],te=J.pop();if(te!==M){J[0]=te;e:for(var ue=0,I=J.length,V=I>>>1;ue<V;){var L=2*(ue+1)-1,P=J[L],X=L+1,ne=J[X];if(0>i(P,te))X<I&&0>i(ne,P)?(J[ue]=ne,J[X]=te,ue=X):(J[ue]=P,J[L]=te,ue=L);else if(X<I&&0>i(ne,te))J[ue]=ne,J[X]=te,ue=X;else break e}}return M}function i(J,M){var te=J.sortIndex-M.sortIndex;return te!==0?te:J.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,h=3,d=!1,p=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(J){for(var M=r(c);M!==null;){if(M.callback===null)n(c);else if(M.startTime<=J)n(c),M.sortIndex=M.expirationTime,t(l,M);else break;M=r(c)}}function S(J){if(m=!1,g(J),!p)if(r(l)!==null)p=!0,de(D);else{var M=r(c);M!==null&&ce(S,M.startTime-J)}}function D(J,M){p=!1,m&&(m=!1,v(O),O=-1),d=!0;var te=h;try{for(g(M),f=r(l);f!==null&&(!(f.expirationTime>M)||J&&!U());){var ue=f.callback;if(typeof ue=="function"){f.callback=null,h=f.priorityLevel;var I=ue(f.expirationTime<=M);M=e.unstable_now(),typeof I=="function"?f.callback=I:f===r(l)&&n(l),g(M)}else n(l);f=r(l)}if(f!==null)var V=!0;else{var L=r(c);L!==null&&ce(S,L.startTime-M),V=!1}return V}finally{f=null,h=te,d=!1}}var k=!1,E=null,O=-1,N=5,B=-1;function U(){return!(e.unstable_now()-B<N)}function b(){if(E!==null){var J=e.unstable_now();B=J;var M=!0;try{M=E(!0,J)}finally{M?Y():(k=!1,E=null)}}else k=!1}var Y;if(typeof x=="function")Y=function(){x(b)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,ie=me.port2;me.port1.onmessage=b,Y=function(){ie.postMessage(null)}}else Y=function(){_(b,0)};function de(J){E=J,k||(k=!0,Y())}function ce(J,M){O=_(function(){J(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){p||d||(p=!0,de(D))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(J){switch(h){case 1:case 2:case 3:var M=3;break;default:M=h}var te=h;h=M;try{return J()}finally{h=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,M){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var te=h;h=J;try{return M()}finally{h=te}},e.unstable_scheduleCallback=function(J,M,te){var ue=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?ue+te:ue):te=ue,J){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=te+I,J={id:u++,callback:M,priorityLevel:J,startTime:te,expirationTime:I,sortIndex:-1},te>ue?(J.sortIndex=te,t(c,J),r(l)===null&&J===r(c)&&(m?(v(O),O=-1):m=!0,ce(S,te-ue))):(J.sortIndex=I,t(l,J),p||d||(p=!0,de(D))),J},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(J){var M=h;return function(){var te=h;h=M;try{return J.apply(this,arguments)}finally{h=te}}}})(Xv);Kv.exports=Xv;var ET=Kv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wT=Ke,Er=ET;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yv=new Set,Lo={};function gs(e,t){aa(e,t),aa(e+"Capture",t)}function aa(e,t){for(Lo[e]=t,e=0;e<t.length;e++)Yv.add(t[e])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yf=Object.prototype.hasOwnProperty,TT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m1={},g1={};function kT(e){return yf.call(g1,e)?!0:yf.call(m1,e)?!1:TT.test(e)?g1[e]=!0:(m1[e]=!0,!1)}function ST(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CT(e,t,r,n){if(t===null||typeof t>"u"||ST(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ar(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pt[e]=new ar(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pt[t]=new ar(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pt[e]=new ar(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pt[e]=new ar(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pt[e]=new ar(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pt[e]=new ar(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pt[e]=new ar(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pt[e]=new ar(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pt[e]=new ar(e,5,!1,e.toLowerCase(),null,!1,!1)});var Qh=/[\-:]([a-z])/g;function Jh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Qh,Jh);Pt[t]=new ar(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Qh,Jh);Pt[t]=new ar(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Qh,Jh);Pt[t]=new ar(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pt[e]=new ar(e,1,!1,e.toLowerCase(),null,!1,!1)});Pt.xlinkHref=new ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pt[e]=new ar(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zh(e,t,r,n){var i=Pt.hasOwnProperty(t)?Pt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CT(t,r,i,n)&&(r=null),n||i===null?kT(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var jn=wT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vl=Symbol.for("react.element"),Ns=Symbol.for("react.portal"),Ds=Symbol.for("react.fragment"),ed=Symbol.for("react.strict_mode"),Ef=Symbol.for("react.profiler"),qv=Symbol.for("react.provider"),Qv=Symbol.for("react.context"),td=Symbol.for("react.forward_ref"),wf=Symbol.for("react.suspense"),Tf=Symbol.for("react.suspense_list"),rd=Symbol.for("react.memo"),Jn=Symbol.for("react.lazy"),Jv=Symbol.for("react.offscreen"),v1=Symbol.iterator;function Va(e){return e===null||typeof e!="object"?null:(e=v1&&e[v1]||e["@@iterator"],typeof e=="function"?e:null)}var Ze=Object.assign,k0;function eo(e){if(k0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);k0=t&&t[1]||""}return`
`+k0+e}var S0=!1;function C0(e,t){if(!e||S0)return"";S0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{S0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?eo(e):""}function AT(e){switch(e.tag){case 5:return eo(e.type);case 16:return eo("Lazy");case 13:return eo("Suspense");case 19:return eo("SuspenseList");case 0:case 2:case 15:return e=C0(e.type,!1),e;case 11:return e=C0(e.type.render,!1),e;case 1:return e=C0(e.type,!0),e;default:return""}}function kf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ds:return"Fragment";case Ns:return"Portal";case Ef:return"Profiler";case ed:return"StrictMode";case wf:return"Suspense";case Tf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qv:return(e.displayName||"Context")+".Consumer";case qv:return(e._context.displayName||"Context")+".Provider";case td:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case rd:return t=e.displayName||null,t!==null?t:kf(e.type)||"Memo";case Jn:t=e._payload,e=e._init;try{return kf(e(t))}catch{}}return null}function IT(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kf(t);case 8:return t===ed?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ii(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function FT(e){var t=Zv(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zl(e){e._valueTracker||(e._valueTracker=FT(e))}function ex(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Zv(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Oc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Sf(e,t){var r=t.checked;return Ze({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function x1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ii(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tx(e,t){t=t.checked,t!=null&&Zh(e,"checked",t,!1)}function Cf(e,t){tx(e,t);var r=Ii(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Af(e,t.type,r):t.hasOwnProperty("defaultValue")&&Af(e,t.type,Ii(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Af(e,t,r){(t!=="number"||Oc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var to=Array.isArray;function Gs(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ii(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function If(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Ze({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function y1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Q(92));if(to(r)){if(1<r.length)throw Error(Q(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ii(r)}}function rx(e,t){var r=Ii(t.value),n=Ii(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function E1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ff(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var jl,ix=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(jl=jl||document.createElement("div"),jl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=jl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var uo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RT=["Webkit","ms","Moz","O"];Object.keys(uo).forEach(function(e){RT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),uo[t]=uo[e]})});function sx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||uo.hasOwnProperty(e)&&uo[e]?(""+t).trim():t+"px"}function ax(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=sx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var NT=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rf(e,t){if(t){if(NT[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function Nf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Df=null;function nd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Of=null,Ks=null,Xs=null;function w1(e){if(e=El(e)){if(typeof Of!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=zu(t),Of(e.stateNode,e.type,t))}}function ox(e){Ks?Xs?Xs.push(e):Xs=[e]:Ks=e}function lx(){if(Ks){var e=Ks,t=Xs;if(Xs=Ks=null,w1(e),t)for(e=0;e<t.length;e++)w1(t[e])}}function cx(e,t){return e(t)}function ux(){}var A0=!1;function fx(e,t,r){if(A0)return e(t,r);A0=!0;try{return cx(e,t,r)}finally{A0=!1,(Ks!==null||Xs!==null)&&(ux(),lx())}}function bo(e,t){var r=e.stateNode;if(r===null)return null;var n=zu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Q(231,t,typeof r));return r}var Pf=!1;if(Mn)try{var za={};Object.defineProperty(za,"passive",{get:function(){Pf=!0}}),window.addEventListener("test",za,za),window.removeEventListener("test",za,za)}catch{Pf=!1}function DT(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var fo=!1,Pc=null,Lc=!1,Lf=null,OT={onError:function(e){fo=!0,Pc=e}};function PT(e,t,r,n,i,s,a,o,l){fo=!1,Pc=null,DT.apply(OT,arguments)}function LT(e,t,r,n,i,s,a,o,l){if(PT.apply(this,arguments),fo){if(fo){var c=Pc;fo=!1,Pc=null}else throw Error(Q(198));Lc||(Lc=!0,Lf=c)}}function vs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function hx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function T1(e){if(vs(e)!==e)throw Error(Q(188))}function MT(e){var t=e.alternate;if(!t){if(t=vs(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return T1(i),e;if(s===n)return T1(i),t;s=s.sibling}throw Error(Q(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Q(189))}}if(r.alternate!==n)throw Error(Q(190))}if(r.tag!==3)throw Error(Q(188));return r.stateNode.current===r?e:t}function dx(e){return e=MT(e),e!==null?px(e):null}function px(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=px(e);if(t!==null)return t;e=e.sibling}return null}var mx=Er.unstable_scheduleCallback,k1=Er.unstable_cancelCallback,bT=Er.unstable_shouldYield,BT=Er.unstable_requestPaint,ct=Er.unstable_now,UT=Er.unstable_getCurrentPriorityLevel,id=Er.unstable_ImmediatePriority,gx=Er.unstable_UserBlockingPriority,Mc=Er.unstable_NormalPriority,WT=Er.unstable_LowPriority,vx=Er.unstable_IdlePriority,Uu=null,fn=null;function HT(e){if(fn&&typeof fn.onCommitFiberRoot=="function")try{fn.onCommitFiberRoot(Uu,e,void 0,(e.current.flags&128)===128)}catch{}}var Qr=Math.clz32?Math.clz32:jT,VT=Math.log,zT=Math.LN2;function jT(e){return e>>>=0,e===0?32:31-(VT(e)/zT|0)|0}var $l=64,Gl=4194304;function ro(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function bc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=ro(o):(s&=a,s!==0&&(n=ro(s)))}else a=r&~i,a!==0?n=ro(a):s!==0&&(n=ro(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Qr(t),i=1<<r,n|=e[r],t&=~i;return n}function $T(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GT(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Qr(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=$T(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Mf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xx(){var e=$l;return $l<<=1,!($l&4194240)&&($l=64),e}function I0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function _l(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qr(t),e[t]=r}function KT(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Qr(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function sd(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Qr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Me=0;function _x(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yx,ad,Ex,wx,Tx,bf=!1,Kl=[],di=null,pi=null,mi=null,Bo=new Map,Uo=new Map,ei=[],XT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function S1(e,t){switch(e){case"focusin":case"focusout":di=null;break;case"dragenter":case"dragleave":pi=null;break;case"mouseover":case"mouseout":mi=null;break;case"pointerover":case"pointerout":Bo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(t.pointerId)}}function ja(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=El(t),t!==null&&ad(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function YT(e,t,r,n,i){switch(t){case"focusin":return di=ja(di,e,t,r,n,i),!0;case"dragenter":return pi=ja(pi,e,t,r,n,i),!0;case"mouseover":return mi=ja(mi,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Bo.set(s,ja(Bo.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Uo.set(s,ja(Uo.get(s)||null,e,t,r,n,i)),!0}return!1}function kx(e){var t=Xi(e.target);if(t!==null){var r=vs(t);if(r!==null){if(t=r.tag,t===13){if(t=hx(r),t!==null){e.blockedOn=t,Tx(e.priority,function(){Ex(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Bf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Df=n,r.target.dispatchEvent(n),Df=null}else return t=El(r),t!==null&&ad(t),e.blockedOn=r,!1;t.shift()}return!0}function C1(e,t,r){xc(e)&&r.delete(t)}function qT(){bf=!1,di!==null&&xc(di)&&(di=null),pi!==null&&xc(pi)&&(pi=null),mi!==null&&xc(mi)&&(mi=null),Bo.forEach(C1),Uo.forEach(C1)}function $a(e,t){e.blockedOn===t&&(e.blockedOn=null,bf||(bf=!0,Er.unstable_scheduleCallback(Er.unstable_NormalPriority,qT)))}function Wo(e){function t(i){return $a(i,e)}if(0<Kl.length){$a(Kl[0],e);for(var r=1;r<Kl.length;r++){var n=Kl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(di!==null&&$a(di,e),pi!==null&&$a(pi,e),mi!==null&&$a(mi,e),Bo.forEach(t),Uo.forEach(t),r=0;r<ei.length;r++)n=ei[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ei.length&&(r=ei[0],r.blockedOn===null);)kx(r),r.blockedOn===null&&ei.shift()}var Ys=jn.ReactCurrentBatchConfig,Bc=!0;function QT(e,t,r,n){var i=Me,s=Ys.transition;Ys.transition=null;try{Me=1,od(e,t,r,n)}finally{Me=i,Ys.transition=s}}function JT(e,t,r,n){var i=Me,s=Ys.transition;Ys.transition=null;try{Me=4,od(e,t,r,n)}finally{Me=i,Ys.transition=s}}function od(e,t,r,n){if(Bc){var i=Bf(e,t,r,n);if(i===null)B0(e,t,n,Uc,r),S1(e,n);else if(YT(i,e,t,r,n))n.stopPropagation();else if(S1(e,n),t&4&&-1<XT.indexOf(e)){for(;i!==null;){var s=El(i);if(s!==null&&yx(s),s=Bf(e,t,r,n),s===null&&B0(e,t,n,Uc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else B0(e,t,n,null,r)}}var Uc=null;function Bf(e,t,r,n){if(Uc=null,e=nd(n),e=Xi(e),e!==null)if(t=vs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=hx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Uc=e,null}function Sx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(UT()){case id:return 1;case gx:return 4;case Mc:case WT:return 16;case vx:return 536870912;default:return 16}default:return 16}}var li=null,ld=null,_c=null;function Cx(){if(_c)return _c;var e,t=ld,r=t.length,n,i="value"in li?li.value:li.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return _c=i.slice(e,1<n?1-n:void 0)}function yc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Xl(){return!0}function A1(){return!1}function kr(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Xl:A1,this.isPropagationStopped=A1,this}return Ze(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Xl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Xl)},persist:function(){},isPersistent:Xl}),t}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cd=kr(ka),yl=Ze({},ka,{view:0,detail:0}),ZT=kr(yl),F0,R0,Ga,Wu=Ze({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ud,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ga&&(Ga&&e.type==="mousemove"?(F0=e.screenX-Ga.screenX,R0=e.screenY-Ga.screenY):R0=F0=0,Ga=e),F0)},movementY:function(e){return"movementY"in e?e.movementY:R0}}),I1=kr(Wu),ek=Ze({},Wu,{dataTransfer:0}),tk=kr(ek),rk=Ze({},yl,{relatedTarget:0}),N0=kr(rk),nk=Ze({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),ik=kr(nk),sk=Ze({},ka,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ak=kr(sk),ok=Ze({},ka,{data:0}),F1=kr(ok),lk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ck={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fk(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=uk[e])?!!t[e]:!1}function ud(){return fk}var hk=Ze({},yl,{key:function(e){if(e.key){var t=lk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ck[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ud,charCode:function(e){return e.type==="keypress"?yc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dk=kr(hk),pk=Ze({},Wu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R1=kr(pk),mk=Ze({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ud}),gk=kr(mk),vk=Ze({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),xk=kr(vk),_k=Ze({},Wu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yk=kr(_k),Ek=[9,13,27,32],fd=Mn&&"CompositionEvent"in window,ho=null;Mn&&"documentMode"in document&&(ho=document.documentMode);var wk=Mn&&"TextEvent"in window&&!ho,Ax=Mn&&(!fd||ho&&8<ho&&11>=ho),N1=" ",D1=!1;function Ix(e,t){switch(e){case"keyup":return Ek.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Os=!1;function Tk(e,t){switch(e){case"compositionend":return Fx(t);case"keypress":return t.which!==32?null:(D1=!0,N1);case"textInput":return e=t.data,e===N1&&D1?null:e;default:return null}}function kk(e,t){if(Os)return e==="compositionend"||!fd&&Ix(e,t)?(e=Cx(),_c=ld=li=null,Os=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ax&&t.locale!=="ko"?null:t.data;default:return null}}var Sk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Sk[e.type]:t==="textarea"}function Rx(e,t,r,n){ox(n),t=Wc(t,"onChange"),0<t.length&&(r=new cd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var po=null,Ho=null;function Ck(e){Hx(e,0)}function Hu(e){var t=Ms(e);if(ex(t))return e}function Ak(e,t){if(e==="change")return t}var Nx=!1;if(Mn){var D0;if(Mn){var O0="oninput"in document;if(!O0){var P1=document.createElement("div");P1.setAttribute("oninput","return;"),O0=typeof P1.oninput=="function"}D0=O0}else D0=!1;Nx=D0&&(!document.documentMode||9<document.documentMode)}function L1(){po&&(po.detachEvent("onpropertychange",Dx),Ho=po=null)}function Dx(e){if(e.propertyName==="value"&&Hu(Ho)){var t=[];Rx(t,Ho,e,nd(e)),fx(Ck,t)}}function Ik(e,t,r){e==="focusin"?(L1(),po=t,Ho=r,po.attachEvent("onpropertychange",Dx)):e==="focusout"&&L1()}function Fk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Hu(Ho)}function Rk(e,t){if(e==="click")return Hu(t)}function Nk(e,t){if(e==="input"||e==="change")return Hu(t)}function Dk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tn=typeof Object.is=="function"?Object.is:Dk;function Vo(e,t){if(tn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!yf.call(t,i)||!tn(e[i],t[i]))return!1}return!0}function M1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function b1(e,t){var r=M1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=M1(r)}}function Ox(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ox(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Px(){for(var e=window,t=Oc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Oc(e.document)}return t}function hd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ok(e){var t=Px(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ox(r.ownerDocument.documentElement,r)){if(n!==null&&hd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=b1(r,s);var a=b1(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pk=Mn&&"documentMode"in document&&11>=document.documentMode,Ps=null,Uf=null,mo=null,Wf=!1;function B1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Wf||Ps==null||Ps!==Oc(n)||(n=Ps,"selectionStart"in n&&hd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),mo&&Vo(mo,n)||(mo=n,n=Wc(Uf,"onSelect"),0<n.length&&(t=new cd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ps)))}function Yl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ls={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},P0={},Lx={};Mn&&(Lx=document.createElement("div").style,"AnimationEvent"in window||(delete Ls.animationend.animation,delete Ls.animationiteration.animation,delete Ls.animationstart.animation),"TransitionEvent"in window||delete Ls.transitionend.transition);function Vu(e){if(P0[e])return P0[e];if(!Ls[e])return e;var t=Ls[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Lx)return P0[e]=t[r];return e}var Mx=Vu("animationend"),bx=Vu("animationiteration"),Bx=Vu("animationstart"),Ux=Vu("transitionend"),Wx=new Map,U1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(e,t){Wx.set(e,t),gs(t,[e])}for(var L0=0;L0<U1.length;L0++){var M0=U1[L0],Lk=M0.toLowerCase(),Mk=M0[0].toUpperCase()+M0.slice(1);Li(Lk,"on"+Mk)}Li(Mx,"onAnimationEnd");Li(bx,"onAnimationIteration");Li(Bx,"onAnimationStart");Li("dblclick","onDoubleClick");Li("focusin","onFocus");Li("focusout","onBlur");Li(Ux,"onTransitionEnd");aa("onMouseEnter",["mouseout","mouseover"]);aa("onMouseLeave",["mouseout","mouseover"]);aa("onPointerEnter",["pointerout","pointerover"]);aa("onPointerLeave",["pointerout","pointerover"]);gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var no="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bk=new Set("cancel close invalid load scroll toggle".split(" ").concat(no));function W1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,LT(n,t,void 0,e),e.currentTarget=null}function Hx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;W1(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;W1(i,o,c),s=l}}}if(Lc)throw e=Lf,Lc=!1,Lf=null,e}function je(e,t){var r=t[$f];r===void 0&&(r=t[$f]=new Set);var n=e+"__bubble";r.has(n)||(Vx(t,e,2,!1),r.add(n))}function b0(e,t,r){var n=0;t&&(n|=4),Vx(r,e,n,t)}var ql="_reactListening"+Math.random().toString(36).slice(2);function zo(e){if(!e[ql]){e[ql]=!0,Yv.forEach(function(r){r!=="selectionchange"&&(bk.has(r)||b0(r,!1,e),b0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ql]||(t[ql]=!0,b0("selectionchange",!1,t))}}function Vx(e,t,r,n){switch(Sx(t)){case 1:var i=QT;break;case 4:i=JT;break;default:i=od}r=i.bind(null,t,r,e),i=void 0,!Pf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function B0(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Xi(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}fx(function(){var c=s,u=nd(r),f=[];e:{var h=Wx.get(e);if(h!==void 0){var d=cd,p=e;switch(e){case"keypress":if(yc(r)===0)break e;case"keydown":case"keyup":d=dk;break;case"focusin":p="focus",d=N0;break;case"focusout":p="blur",d=N0;break;case"beforeblur":case"afterblur":d=N0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=I1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=tk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=gk;break;case Mx:case bx:case Bx:d=ik;break;case Ux:d=xk;break;case"scroll":d=ZT;break;case"wheel":d=yk;break;case"copy":case"cut":case"paste":d=ak;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=R1}var m=(t&4)!==0,_=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var x=c,g;x!==null;){g=x;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,v!==null&&(S=bo(x,v),S!=null&&m.push(jo(x,S,g)))),_)break;x=x.return}0<m.length&&(h=new d(h,p,null,r,u),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",h&&r!==Df&&(p=r.relatedTarget||r.fromElement)&&(Xi(p)||p[bn]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(p=r.relatedTarget||r.toElement,d=c,p=p?Xi(p):null,p!==null&&(_=vs(p),p!==_||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=c),d!==p)){if(m=I1,S="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(m=R1,S="onPointerLeave",v="onPointerEnter",x="pointer"),_=d==null?h:Ms(d),g=p==null?h:Ms(p),h=new m(S,x+"leave",d,r,u),h.target=_,h.relatedTarget=g,S=null,Xi(u)===c&&(m=new m(v,x+"enter",p,r,u),m.target=g,m.relatedTarget=_,S=m),_=S,d&&p)t:{for(m=d,v=p,x=0,g=m;g;g=As(g))x++;for(g=0,S=v;S;S=As(S))g++;for(;0<x-g;)m=As(m),x--;for(;0<g-x;)v=As(v),g--;for(;x--;){if(m===v||v!==null&&m===v.alternate)break t;m=As(m),v=As(v)}m=null}else m=null;d!==null&&H1(f,h,d,m,!1),p!==null&&_!==null&&H1(f,_,p,m,!0)}}e:{if(h=c?Ms(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var D=Ak;else if(O1(h))if(Nx)D=Nk;else{D=Fk;var k=Ik}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(D=Rk);if(D&&(D=D(e,c))){Rx(f,D,r,u);break e}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Af(h,"number",h.value)}switch(k=c?Ms(c):window,e){case"focusin":(O1(k)||k.contentEditable==="true")&&(Ps=k,Uf=c,mo=null);break;case"focusout":mo=Uf=Ps=null;break;case"mousedown":Wf=!0;break;case"contextmenu":case"mouseup":case"dragend":Wf=!1,B1(f,r,u);break;case"selectionchange":if(Pk)break;case"keydown":case"keyup":B1(f,r,u)}var E;if(fd)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Os?Ix(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(Ax&&r.locale!=="ko"&&(Os||O!=="onCompositionStart"?O==="onCompositionEnd"&&Os&&(E=Cx()):(li=u,ld="value"in li?li.value:li.textContent,Os=!0)),k=Wc(c,O),0<k.length&&(O=new F1(O,e,null,r,u),f.push({event:O,listeners:k}),E?O.data=E:(E=Fx(r),E!==null&&(O.data=E)))),(E=wk?Tk(e,r):kk(e,r))&&(c=Wc(c,"onBeforeInput"),0<c.length&&(u=new F1("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=E))}Hx(f,t)})}function jo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Wc(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=bo(e,r),s!=null&&n.unshift(jo(e,s,i)),s=bo(e,t),s!=null&&n.push(jo(e,s,i))),e=e.return}return n}function As(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function H1(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=bo(r,s),l!=null&&a.unshift(jo(r,l,o))):i||(l=bo(r,s),l!=null&&a.push(jo(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Bk=/\r\n?/g,Uk=/\u0000|\uFFFD/g;function V1(e){return(typeof e=="string"?e:""+e).replace(Bk,`
`).replace(Uk,"")}function Ql(e,t,r){if(t=V1(t),V1(e)!==t&&r)throw Error(Q(425))}function Hc(){}var Hf=null,Vf=null;function zf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jf=typeof setTimeout=="function"?setTimeout:void 0,Wk=typeof clearTimeout=="function"?clearTimeout:void 0,z1=typeof Promise=="function"?Promise:void 0,Hk=typeof queueMicrotask=="function"?queueMicrotask:typeof z1<"u"?function(e){return z1.resolve(null).then(e).catch(Vk)}:jf;function Vk(e){setTimeout(function(){throw e})}function U0(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Wo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Wo(t)}function gi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function j1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),un="__reactFiber$"+Sa,$o="__reactProps$"+Sa,bn="__reactContainer$"+Sa,$f="__reactEvents$"+Sa,zk="__reactListeners$"+Sa,jk="__reactHandles$"+Sa;function Xi(e){var t=e[un];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bn]||r[un]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=j1(e);e!==null;){if(r=e[un])return r;e=j1(e)}return t}e=r,r=e.parentNode}return null}function El(e){return e=e[un]||e[bn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ms(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function zu(e){return e[$o]||null}var Gf=[],bs=-1;function Mi(e){return{current:e}}function $e(e){0>bs||(e.current=Gf[bs],Gf[bs]=null,bs--)}function Ve(e,t){bs++,Gf[bs]=e.current,e.current=t}var Fi={},$t=Mi(Fi),hr=Mi(!1),ns=Fi;function oa(e,t){var r=e.type.contextTypes;if(!r)return Fi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function dr(e){return e=e.childContextTypes,e!=null}function Vc(){$e(hr),$e($t)}function $1(e,t,r){if($t.current!==Fi)throw Error(Q(168));Ve($t,t),Ve(hr,r)}function zx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Q(108,IT(e)||"Unknown",i));return Ze({},r,n)}function zc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fi,ns=$t.current,Ve($t,e),Ve(hr,hr.current),!0}function G1(e,t,r){var n=e.stateNode;if(!n)throw Error(Q(169));r?(e=zx(e,t,ns),n.__reactInternalMemoizedMergedChildContext=e,$e(hr),$e($t),Ve($t,e)):$e(hr),Ve(hr,r)}var Tn=null,ju=!1,W0=!1;function jx(e){Tn===null?Tn=[e]:Tn.push(e)}function $k(e){ju=!0,jx(e)}function bi(){if(!W0&&Tn!==null){W0=!0;var e=0,t=Me;try{var r=Tn;for(Me=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Tn=null,ju=!1}catch(i){throw Tn!==null&&(Tn=Tn.slice(e+1)),mx(id,bi),i}finally{Me=t,W0=!1}}return null}var Bs=[],Us=0,jc=null,$c=0,Rr=[],Nr=0,is=null,kn=1,Sn="";function zi(e,t){Bs[Us++]=$c,Bs[Us++]=jc,jc=e,$c=t}function $x(e,t,r){Rr[Nr++]=kn,Rr[Nr++]=Sn,Rr[Nr++]=is,is=e;var n=kn;e=Sn;var i=32-Qr(n)-1;n&=~(1<<i),r+=1;var s=32-Qr(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,kn=1<<32-Qr(t)+i|r<<i|n,Sn=s+e}else kn=1<<s|r<<i|n,Sn=e}function dd(e){e.return!==null&&(zi(e,1),$x(e,1,0))}function pd(e){for(;e===jc;)jc=Bs[--Us],Bs[Us]=null,$c=Bs[--Us],Bs[Us]=null;for(;e===is;)is=Rr[--Nr],Rr[Nr]=null,Sn=Rr[--Nr],Rr[Nr]=null,kn=Rr[--Nr],Rr[Nr]=null}var yr=null,_r=null,Xe=!1,$r=null;function Gx(e,t){var r=Dr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function K1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,yr=e,_r=gi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,yr=e,_r=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=is!==null?{id:kn,overflow:Sn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Dr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,yr=e,_r=null,!0):!1;default:return!1}}function Kf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xf(e){if(Xe){var t=_r;if(t){var r=t;if(!K1(e,t)){if(Kf(e))throw Error(Q(418));t=gi(r.nextSibling);var n=yr;t&&K1(e,t)?Gx(n,r):(e.flags=e.flags&-4097|2,Xe=!1,yr=e)}}else{if(Kf(e))throw Error(Q(418));e.flags=e.flags&-4097|2,Xe=!1,yr=e}}}function X1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;yr=e}function Jl(e){if(e!==yr)return!1;if(!Xe)return X1(e),Xe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zf(e.type,e.memoizedProps)),t&&(t=_r)){if(Kf(e))throw Kx(),Error(Q(418));for(;t;)Gx(e,t),t=gi(t.nextSibling)}if(X1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_r=gi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_r=null}}else _r=yr?gi(e.stateNode.nextSibling):null;return!0}function Kx(){for(var e=_r;e;)e=gi(e.nextSibling)}function la(){_r=yr=null,Xe=!1}function md(e){$r===null?$r=[e]:$r.push(e)}var Gk=jn.ReactCurrentBatchConfig;function Ka(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Q(309));var n=r.stateNode}if(!n)throw Error(Q(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Q(284));if(!r._owner)throw Error(Q(290,e))}return e}function Zl(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Y1(e){var t=e._init;return t(e._payload)}function Xx(e){function t(v,x){if(e){var g=v.deletions;g===null?(v.deletions=[x],v.flags|=16):g.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=yi(v,x),v.index=0,v.sibling=null,v}function s(v,x,g){return v.index=g,e?(g=v.alternate,g!==null?(g=g.index,g<x?(v.flags|=2,x):g):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,x,g,S){return x===null||x.tag!==6?(x=K0(g,v.mode,S),x.return=v,x):(x=i(x,g),x.return=v,x)}function l(v,x,g,S){var D=g.type;return D===Ds?u(v,x,g.props.children,S,g.key):x!==null&&(x.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Jn&&Y1(D)===x.type)?(S=i(x,g.props),S.ref=Ka(v,x,g),S.return=v,S):(S=Ac(g.type,g.key,g.props,null,v.mode,S),S.ref=Ka(v,x,g),S.return=v,S)}function c(v,x,g,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==g.containerInfo||x.stateNode.implementation!==g.implementation?(x=X0(g,v.mode,S),x.return=v,x):(x=i(x,g.children||[]),x.return=v,x)}function u(v,x,g,S,D){return x===null||x.tag!==7?(x=es(g,v.mode,S,D),x.return=v,x):(x=i(x,g),x.return=v,x)}function f(v,x,g){if(typeof x=="string"&&x!==""||typeof x=="number")return x=K0(""+x,v.mode,g),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Vl:return g=Ac(x.type,x.key,x.props,null,v.mode,g),g.ref=Ka(v,null,x),g.return=v,g;case Ns:return x=X0(x,v.mode,g),x.return=v,x;case Jn:var S=x._init;return f(v,S(x._payload),g)}if(to(x)||Va(x))return x=es(x,v.mode,g,null),x.return=v,x;Zl(v,x)}return null}function h(v,x,g,S){var D=x!==null?x.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return D!==null?null:o(v,x,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Vl:return g.key===D?l(v,x,g,S):null;case Ns:return g.key===D?c(v,x,g,S):null;case Jn:return D=g._init,h(v,x,D(g._payload),S)}if(to(g)||Va(g))return D!==null?null:u(v,x,g,S,null);Zl(v,g)}return null}function d(v,x,g,S,D){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(g)||null,o(x,v,""+S,D);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Vl:return v=v.get(S.key===null?g:S.key)||null,l(x,v,S,D);case Ns:return v=v.get(S.key===null?g:S.key)||null,c(x,v,S,D);case Jn:var k=S._init;return d(v,x,g,k(S._payload),D)}if(to(S)||Va(S))return v=v.get(g)||null,u(x,v,S,D,null);Zl(x,S)}return null}function p(v,x,g,S){for(var D=null,k=null,E=x,O=x=0,N=null;E!==null&&O<g.length;O++){E.index>O?(N=E,E=null):N=E.sibling;var B=h(v,E,g[O],S);if(B===null){E===null&&(E=N);break}e&&E&&B.alternate===null&&t(v,E),x=s(B,x,O),k===null?D=B:k.sibling=B,k=B,E=N}if(O===g.length)return r(v,E),Xe&&zi(v,O),D;if(E===null){for(;O<g.length;O++)E=f(v,g[O],S),E!==null&&(x=s(E,x,O),k===null?D=E:k.sibling=E,k=E);return Xe&&zi(v,O),D}for(E=n(v,E);O<g.length;O++)N=d(E,v,O,g[O],S),N!==null&&(e&&N.alternate!==null&&E.delete(N.key===null?O:N.key),x=s(N,x,O),k===null?D=N:k.sibling=N,k=N);return e&&E.forEach(function(U){return t(v,U)}),Xe&&zi(v,O),D}function m(v,x,g,S){var D=Va(g);if(typeof D!="function")throw Error(Q(150));if(g=D.call(g),g==null)throw Error(Q(151));for(var k=D=null,E=x,O=x=0,N=null,B=g.next();E!==null&&!B.done;O++,B=g.next()){E.index>O?(N=E,E=null):N=E.sibling;var U=h(v,E,B.value,S);if(U===null){E===null&&(E=N);break}e&&E&&U.alternate===null&&t(v,E),x=s(U,x,O),k===null?D=U:k.sibling=U,k=U,E=N}if(B.done)return r(v,E),Xe&&zi(v,O),D;if(E===null){for(;!B.done;O++,B=g.next())B=f(v,B.value,S),B!==null&&(x=s(B,x,O),k===null?D=B:k.sibling=B,k=B);return Xe&&zi(v,O),D}for(E=n(v,E);!B.done;O++,B=g.next())B=d(E,v,O,B.value,S),B!==null&&(e&&B.alternate!==null&&E.delete(B.key===null?O:B.key),x=s(B,x,O),k===null?D=B:k.sibling=B,k=B);return e&&E.forEach(function(b){return t(v,b)}),Xe&&zi(v,O),D}function _(v,x,g,S){if(typeof g=="object"&&g!==null&&g.type===Ds&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Vl:e:{for(var D=g.key,k=x;k!==null;){if(k.key===D){if(D=g.type,D===Ds){if(k.tag===7){r(v,k.sibling),x=i(k,g.props.children),x.return=v,v=x;break e}}else if(k.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Jn&&Y1(D)===k.type){r(v,k.sibling),x=i(k,g.props),x.ref=Ka(v,k,g),x.return=v,v=x;break e}r(v,k);break}else t(v,k);k=k.sibling}g.type===Ds?(x=es(g.props.children,v.mode,S,g.key),x.return=v,v=x):(S=Ac(g.type,g.key,g.props,null,v.mode,S),S.ref=Ka(v,x,g),S.return=v,v=S)}return a(v);case Ns:e:{for(k=g.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===g.containerInfo&&x.stateNode.implementation===g.implementation){r(v,x.sibling),x=i(x,g.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=X0(g,v.mode,S),x.return=v,v=x}return a(v);case Jn:return k=g._init,_(v,x,k(g._payload),S)}if(to(g))return p(v,x,g,S);if(Va(g))return m(v,x,g,S);Zl(v,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,g),x.return=v,v=x):(r(v,x),x=K0(g,v.mode,S),x.return=v,v=x),a(v)):r(v,x)}return _}var ca=Xx(!0),Yx=Xx(!1),Gc=Mi(null),Kc=null,Ws=null,gd=null;function vd(){gd=Ws=Kc=null}function xd(e){var t=Gc.current;$e(Gc),e._currentValue=t}function Yf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function qs(e,t){Kc=e,gd=Ws=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ur=!0),e.firstContext=null)}function Lr(e){var t=e._currentValue;if(gd!==e)if(e={context:e,memoizedValue:t,next:null},Ws===null){if(Kc===null)throw Error(Q(308));Ws=e,Kc.dependencies={lanes:0,firstContext:e}}else Ws=Ws.next=e;return t}var Yi=null;function _d(e){Yi===null?Yi=[e]:Yi.push(e)}function qx(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,_d(t)):(r.next=i.next,i.next=r),t.interleaved=r,Bn(e,n)}function Bn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Zn=!1;function yd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Dn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,De&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Bn(e,r)}return i=n.interleaved,i===null?(t.next=t,_d(n)):(t.next=i.next,i.next=t),n.interleaved=t,Bn(e,r)}function Ec(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sd(e,r)}}function q1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Xc(e,t,r,n){var i=e.updateQueue;Zn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,d=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,d=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(d,f,h):p,h==null)break e;f=Ze({},f,h);break e;case 2:Zn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else d={eventTime:d,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);as|=a,e.lanes=a,e.memoizedState=f}}function Q1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Q(191,i));i.call(n)}}}var wl={},hn=Mi(wl),Go=Mi(wl),Ko=Mi(wl);function qi(e){if(e===wl)throw Error(Q(174));return e}function Ed(e,t){switch(Ve(Ko,t),Ve(Go,e),Ve(hn,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ff(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ff(t,e)}$e(hn),Ve(hn,t)}function ua(){$e(hn),$e(Go),$e(Ko)}function Jx(e){qi(Ko.current);var t=qi(hn.current),r=Ff(t,e.type);t!==r&&(Ve(Go,e),Ve(hn,r))}function wd(e){Go.current===e&&($e(hn),$e(Go))}var Qe=Mi(0);function Yc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var H0=[];function Td(){for(var e=0;e<H0.length;e++)H0[e]._workInProgressVersionPrimary=null;H0.length=0}var wc=jn.ReactCurrentDispatcher,V0=jn.ReactCurrentBatchConfig,ss=0,Je=null,gt=null,kt=null,qc=!1,go=!1,Xo=0,Kk=0;function bt(){throw Error(Q(321))}function kd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!tn(e[r],t[r]))return!1;return!0}function Sd(e,t,r,n,i,s){if(ss=s,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wc.current=e===null||e.memoizedState===null?Qk:Jk,e=r(n,i),go){s=0;do{if(go=!1,Xo=0,25<=s)throw Error(Q(301));s+=1,kt=gt=null,t.updateQueue=null,wc.current=Zk,e=r(n,i)}while(go)}if(wc.current=Qc,t=gt!==null&&gt.next!==null,ss=0,kt=gt=Je=null,qc=!1,t)throw Error(Q(300));return e}function Cd(){var e=Xo!==0;return Xo=0,e}function cn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?Je.memoizedState=kt=e:kt=kt.next=e,kt}function Mr(){if(gt===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=gt.next;var t=kt===null?Je.memoizedState:kt.next;if(t!==null)kt=t,gt=e;else{if(e===null)throw Error(Q(310));gt=e,e={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},kt===null?Je.memoizedState=kt=e:kt=kt.next=e}return kt}function Yo(e,t){return typeof t=="function"?t(e):t}function z0(e){var t=Mr(),r=t.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=e;var n=gt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((ss&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,Je.lanes|=u,as|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,tn(n,t.memoizedState)||(ur=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Je.lanes|=s,as|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function j0(e){var t=Mr(),r=t.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);tn(s,t.memoizedState)||(ur=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Zx(){}function e_(e,t){var r=Je,n=Mr(),i=t(),s=!tn(n.memoizedState,i);if(s&&(n.memoizedState=i,ur=!0),n=n.queue,Ad(n_.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||kt!==null&&kt.memoizedState.tag&1){if(r.flags|=2048,qo(9,r_.bind(null,r,n,i,t),void 0,null),Ct===null)throw Error(Q(349));ss&30||t_(r,t,i)}return i}function t_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function r_(e,t,r,n){t.value=r,t.getSnapshot=n,i_(t)&&s_(e)}function n_(e,t,r){return r(function(){i_(t)&&s_(e)})}function i_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!tn(e,r)}catch{return!0}}function s_(e){var t=Bn(e,1);t!==null&&Jr(t,e,1,-1)}function J1(e){var t=cn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=qk.bind(null,Je,e),[t.memoizedState,e]}function qo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function a_(){return Mr().memoizedState}function Tc(e,t,r,n){var i=cn();Je.flags|=e,i.memoizedState=qo(1|t,r,void 0,n===void 0?null:n)}function $u(e,t,r,n){var i=Mr();n=n===void 0?null:n;var s=void 0;if(gt!==null){var a=gt.memoizedState;if(s=a.destroy,n!==null&&kd(n,a.deps)){i.memoizedState=qo(t,r,s,n);return}}Je.flags|=e,i.memoizedState=qo(1|t,r,s,n)}function Z1(e,t){return Tc(8390656,8,e,t)}function Ad(e,t){return $u(2048,8,e,t)}function o_(e,t){return $u(4,2,e,t)}function l_(e,t){return $u(4,4,e,t)}function c_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function u_(e,t,r){return r=r!=null?r.concat([e]):null,$u(4,4,c_.bind(null,t,e),r)}function Id(){}function f_(e,t){var r=Mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kd(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function h_(e,t){var r=Mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kd(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function d_(e,t,r){return ss&21?(tn(r,t)||(r=xx(),Je.lanes|=r,as|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ur=!0),e.memoizedState=r)}function Xk(e,t){var r=Me;Me=r!==0&&4>r?r:4,e(!0);var n=V0.transition;V0.transition={};try{e(!1),t()}finally{Me=r,V0.transition=n}}function p_(){return Mr().memoizedState}function Yk(e,t,r){var n=_i(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},m_(e))g_(t,r);else if(r=qx(e,t,r,n),r!==null){var i=er();Jr(r,e,n,i),v_(r,t,n)}}function qk(e,t,r){var n=_i(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(m_(e))g_(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,tn(o,a)){var l=t.interleaved;l===null?(i.next=i,_d(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=qx(e,t,i,n),r!==null&&(i=er(),Jr(r,e,n,i),v_(r,t,n))}}function m_(e){var t=e.alternate;return e===Je||t!==null&&t===Je}function g_(e,t){go=qc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function v_(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sd(e,r)}}var Qc={readContext:Lr,useCallback:bt,useContext:bt,useEffect:bt,useImperativeHandle:bt,useInsertionEffect:bt,useLayoutEffect:bt,useMemo:bt,useReducer:bt,useRef:bt,useState:bt,useDebugValue:bt,useDeferredValue:bt,useTransition:bt,useMutableSource:bt,useSyncExternalStore:bt,useId:bt,unstable_isNewReconciler:!1},Qk={readContext:Lr,useCallback:function(e,t){return cn().memoizedState=[e,t===void 0?null:t],e},useContext:Lr,useEffect:Z1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Tc(4194308,4,c_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Tc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Tc(4,2,e,t)},useMemo:function(e,t){var r=cn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=cn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Yk.bind(null,Je,e),[n.memoizedState,e]},useRef:function(e){var t=cn();return e={current:e},t.memoizedState=e},useState:J1,useDebugValue:Id,useDeferredValue:function(e){return cn().memoizedState=e},useTransition:function(){var e=J1(!1),t=e[0];return e=Xk.bind(null,e[1]),cn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Je,i=cn();if(Xe){if(r===void 0)throw Error(Q(407));r=r()}else{if(r=t(),Ct===null)throw Error(Q(349));ss&30||t_(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Z1(n_.bind(null,n,s,e),[e]),n.flags|=2048,qo(9,r_.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=cn(),t=Ct.identifierPrefix;if(Xe){var r=Sn,n=kn;r=(n&~(1<<32-Qr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Xo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Kk++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Jk={readContext:Lr,useCallback:f_,useContext:Lr,useEffect:Ad,useImperativeHandle:u_,useInsertionEffect:o_,useLayoutEffect:l_,useMemo:h_,useReducer:z0,useRef:a_,useState:function(){return z0(Yo)},useDebugValue:Id,useDeferredValue:function(e){var t=Mr();return d_(t,gt.memoizedState,e)},useTransition:function(){var e=z0(Yo)[0],t=Mr().memoizedState;return[e,t]},useMutableSource:Zx,useSyncExternalStore:e_,useId:p_,unstable_isNewReconciler:!1},Zk={readContext:Lr,useCallback:f_,useContext:Lr,useEffect:Ad,useImperativeHandle:u_,useInsertionEffect:o_,useLayoutEffect:l_,useMemo:h_,useReducer:j0,useRef:a_,useState:function(){return j0(Yo)},useDebugValue:Id,useDeferredValue:function(e){var t=Mr();return gt===null?t.memoizedState=e:d_(t,gt.memoizedState,e)},useTransition:function(){var e=j0(Yo)[0],t=Mr().memoizedState;return[e,t]},useMutableSource:Zx,useSyncExternalStore:e_,useId:p_,unstable_isNewReconciler:!1};function zr(e,t){if(e&&e.defaultProps){t=Ze({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qf(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ze({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Gu={isMounted:function(e){return(e=e._reactInternals)?vs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=er(),i=_i(e),s=Dn(n,i);s.payload=t,r!=null&&(s.callback=r),t=vi(e,s,i),t!==null&&(Jr(t,e,i,n),Ec(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=er(),i=_i(e),s=Dn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=vi(e,s,i),t!==null&&(Jr(t,e,i,n),Ec(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=er(),n=_i(e),i=Dn(r,n);i.tag=2,t!=null&&(i.callback=t),t=vi(e,i,n),t!==null&&(Jr(t,e,n,r),Ec(t,e,n))}};function em(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Vo(r,n)||!Vo(i,s):!0}function x_(e,t,r){var n=!1,i=Fi,s=t.contextType;return typeof s=="object"&&s!==null?s=Lr(s):(i=dr(t)?ns:$t.current,n=t.contextTypes,s=(n=n!=null)?oa(e,i):Fi),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Gu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function tm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Gu.enqueueReplaceState(t,t.state,null)}function Qf(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},yd(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Lr(s):(s=dr(t)?ns:$t.current,i.context=oa(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(qf(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Gu.enqueueReplaceState(i,i.state,null),Xc(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function fa(e,t){try{var r="",n=t;do r+=AT(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function $0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Jf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var eS=typeof WeakMap=="function"?WeakMap:Map;function __(e,t,r){r=Dn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Zc||(Zc=!0,lh=n),Jf(e,t)},r}function y_(e,t,r){r=Dn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Jf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Jf(e,t),typeof n!="function"&&(xi===null?xi=new Set([this]):xi.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function rm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new eS;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=pS.bind(null,e,t,r),t.then(e,e))}function nm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function im(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Dn(-1,1),t.tag=2,vi(r,t,1))),r.lanes|=1),e)}var tS=jn.ReactCurrentOwner,ur=!1;function Yt(e,t,r,n){t.child=e===null?Yx(t,null,r,n):ca(t,e.child,r,n)}function sm(e,t,r,n,i){r=r.render;var s=t.ref;return qs(t,i),n=Sd(e,t,r,n,s,i),r=Cd(),e!==null&&!ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Un(e,t,i)):(Xe&&r&&dd(t),t.flags|=1,Yt(e,t,n,i),t.child)}function am(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Md(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,E_(e,t,s,n,i)):(e=Ac(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Vo,r(a,n)&&e.ref===t.ref)return Un(e,t,i)}return t.flags|=1,e=yi(s,n),e.ref=t.ref,e.return=t,t.child=e}function E_(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Vo(s,n)&&e.ref===t.ref)if(ur=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(ur=!0);else return t.lanes=e.lanes,Un(e,t,i)}return Zf(e,t,r,n,i)}function w_(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Vs,gr),gr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(Vs,gr),gr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Ve(Vs,gr),gr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Ve(Vs,gr),gr|=n;return Yt(e,t,i,r),t.child}function T_(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Zf(e,t,r,n,i){var s=dr(r)?ns:$t.current;return s=oa(t,s),qs(t,i),r=Sd(e,t,r,n,s,i),n=Cd(),e!==null&&!ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Un(e,t,i)):(Xe&&n&&dd(t),t.flags|=1,Yt(e,t,r,i),t.child)}function om(e,t,r,n,i){if(dr(r)){var s=!0;zc(t)}else s=!1;if(qs(t,i),t.stateNode===null)kc(e,t),x_(t,r,n),Qf(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Lr(c):(c=dr(r)?ns:$t.current,c=oa(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&tm(t,a,n,c),Zn=!1;var h=t.memoizedState;a.state=h,Xc(t,n,a,i),l=t.memoizedState,o!==n||h!==l||hr.current||Zn?(typeof u=="function"&&(qf(t,r,u,n),l=t.memoizedState),(o=Zn||em(t,r,o,n,h,l,c))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Qx(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:zr(t.type,o),a.props=c,f=t.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Lr(l):(l=dr(r)?ns:$t.current,l=oa(t,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==l)&&tm(t,a,n,l),Zn=!1,h=t.memoizedState,a.state=h,Xc(t,n,a,i);var p=t.memoizedState;o!==f||h!==p||hr.current||Zn?(typeof d=="function"&&(qf(t,r,d,n),p=t.memoizedState),(c=Zn||em(t,r,c,n,h,p,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,p,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return eh(e,t,r,n,s,i)}function eh(e,t,r,n,i,s){T_(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&G1(t,r,!1),Un(e,t,s);n=t.stateNode,tS.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=ca(t,e.child,null,s),t.child=ca(t,null,o,s)):Yt(e,t,o,s),t.memoizedState=n.state,i&&G1(t,r,!0),t.child}function k_(e){var t=e.stateNode;t.pendingContext?$1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$1(e,t.context,!1),Ed(e,t.containerInfo)}function lm(e,t,r,n,i){return la(),md(i),t.flags|=256,Yt(e,t,r,n),t.child}var th={dehydrated:null,treeContext:null,retryLane:0};function rh(e){return{baseLanes:e,cachePool:null,transitions:null}}function S_(e,t,r){var n=t.pendingProps,i=Qe.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ve(Qe,i&1),e===null)return Xf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Yu(a,n,0,null),e=es(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=rh(r),t.memoizedState=th,e):Fd(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return rS(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=yi(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=yi(o,s):(s=es(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?rh(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=th,n}return s=e.child,e=s.sibling,n=yi(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Fd(e,t){return t=Yu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ec(e,t,r,n){return n!==null&&md(n),ca(t,e.child,null,r),e=Fd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rS(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=$0(Error(Q(422))),ec(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Yu({mode:"visible",children:n.children},i,0,null),s=es(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ca(t,e.child,null,a),t.child.memoizedState=rh(a),t.memoizedState=th,s);if(!(t.mode&1))return ec(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Q(419)),n=$0(s,n,void 0),ec(e,t,a,n)}if(o=(a&e.childLanes)!==0,ur||o){if(n=Ct,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Bn(e,i),Jr(n,e,i,-1))}return Ld(),n=$0(Error(Q(421))),ec(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=mS.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,_r=gi(i.nextSibling),yr=t,Xe=!0,$r=null,e!==null&&(Rr[Nr++]=kn,Rr[Nr++]=Sn,Rr[Nr++]=is,kn=e.id,Sn=e.overflow,is=t),t=Fd(t,n.children),t.flags|=4096,t)}function cm(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Yf(e.return,t,r)}function G0(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function C_(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Yt(e,t,n.children,r),n=Qe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cm(e,r,t);else if(e.tag===19)cm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ve(Qe,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Yc(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),G0(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Yc(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}G0(t,!0,r,null,s);break;case"together":G0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function kc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Un(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),as|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,r=yi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=yi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function nS(e,t,r){switch(t.tag){case 3:k_(t),la();break;case 5:Jx(t);break;case 1:dr(t.type)&&zc(t);break;case 4:Ed(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ve(Gc,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ve(Qe,Qe.current&1),t.flags|=128,null):r&t.child.childLanes?S_(e,t,r):(Ve(Qe,Qe.current&1),e=Un(e,t,r),e!==null?e.sibling:null);Ve(Qe,Qe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return C_(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ve(Qe,Qe.current),n)break;return null;case 22:case 23:return t.lanes=0,w_(e,t,r)}return Un(e,t,r)}var A_,nh,I_,F_;A_=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};nh=function(){};I_=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,qi(hn.current);var s=null;switch(r){case"input":i=Sf(e,i),n=Sf(e,n),s=[];break;case"select":i=Ze({},i,{value:void 0}),n=Ze({},n,{value:void 0}),s=[];break;case"textarea":i=If(e,i),n=If(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Hc)}Rf(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Lo.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Lo.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&je("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};F_=function(e,t,r,n){r!==n&&(t.flags|=4)};function Xa(e,t){if(!Xe)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function iS(e,t,r){var n=t.pendingProps;switch(pd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(t),null;case 1:return dr(t.type)&&Vc(),Bt(t),null;case 3:return n=t.stateNode,ua(),$e(hr),$e($t),Td(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Jl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$r!==null&&(fh($r),$r=null))),nh(e,t),Bt(t),null;case 5:wd(t);var i=qi(Ko.current);if(r=t.type,e!==null&&t.stateNode!=null)I_(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Q(166));return Bt(t),null}if(e=qi(hn.current),Jl(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[un]=t,n[$o]=s,e=(t.mode&1)!==0,r){case"dialog":je("cancel",n),je("close",n);break;case"iframe":case"object":case"embed":je("load",n);break;case"video":case"audio":for(i=0;i<no.length;i++)je(no[i],n);break;case"source":je("error",n);break;case"img":case"image":case"link":je("error",n),je("load",n);break;case"details":je("toggle",n);break;case"input":x1(n,s),je("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},je("invalid",n);break;case"textarea":y1(n,s),je("invalid",n)}Rf(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ql(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ql(n.textContent,o,e),i=["children",""+o]):Lo.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&je("scroll",n)}switch(r){case"input":zl(n),_1(n,s,!0);break;case"textarea":zl(n),E1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Hc)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[un]=t,e[$o]=n,A_(e,t,!1,!1),t.stateNode=e;e:{switch(a=Nf(r,n),r){case"dialog":je("cancel",e),je("close",e),i=n;break;case"iframe":case"object":case"embed":je("load",e),i=n;break;case"video":case"audio":for(i=0;i<no.length;i++)je(no[i],e);i=n;break;case"source":je("error",e),i=n;break;case"img":case"image":case"link":je("error",e),je("load",e),i=n;break;case"details":je("toggle",e),i=n;break;case"input":x1(e,n),i=Sf(e,n),je("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ze({},n,{value:void 0}),je("invalid",e);break;case"textarea":y1(e,n),i=If(e,n),je("invalid",e);break;default:i=n}Rf(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?ax(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ix(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Mo(e,l):typeof l=="number"&&Mo(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Lo.hasOwnProperty(s)?l!=null&&s==="onScroll"&&je("scroll",e):l!=null&&Zh(e,s,l,a))}switch(r){case"input":zl(e),_1(e,n,!1);break;case"textarea":zl(e),E1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ii(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Gs(e,!!n.multiple,s,!1):n.defaultValue!=null&&Gs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Hc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Bt(t),null;case 6:if(e&&t.stateNode!=null)F_(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Q(166));if(r=qi(Ko.current),qi(hn.current),Jl(t)){if(n=t.stateNode,r=t.memoizedProps,n[un]=t,(s=n.nodeValue!==r)&&(e=yr,e!==null))switch(e.tag){case 3:Ql(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ql(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[un]=t,t.stateNode=n}return Bt(t),null;case 13:if($e(Qe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xe&&_r!==null&&t.mode&1&&!(t.flags&128))Kx(),la(),t.flags|=98560,s=!1;else if(s=Jl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Q(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[un]=t}else la(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bt(t),s=!1}else $r!==null&&(fh($r),$r=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?_t===0&&(_t=3):Ld())),t.updateQueue!==null&&(t.flags|=4),Bt(t),null);case 4:return ua(),nh(e,t),e===null&&zo(t.stateNode.containerInfo),Bt(t),null;case 10:return xd(t.type._context),Bt(t),null;case 17:return dr(t.type)&&Vc(),Bt(t),null;case 19:if($e(Qe),s=t.memoizedState,s===null)return Bt(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Xa(s,!1);else{if(_t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Yc(e),a!==null){for(t.flags|=128,Xa(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ve(Qe,Qe.current&1|2),t.child}e=e.sibling}s.tail!==null&&ct()>ha&&(t.flags|=128,n=!0,Xa(s,!1),t.lanes=4194304)}else{if(!n)if(e=Yc(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Xa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Xe)return Bt(t),null}else 2*ct()-s.renderingStartTime>ha&&r!==1073741824&&(t.flags|=128,n=!0,Xa(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ct(),t.sibling=null,r=Qe.current,Ve(Qe,n?r&1|2:r&1),t):(Bt(t),null);case 22:case 23:return Pd(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?gr&1073741824&&(Bt(t),t.subtreeFlags&6&&(t.flags|=8192)):Bt(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function sS(e,t){switch(pd(t),t.tag){case 1:return dr(t.type)&&Vc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ua(),$e(hr),$e($t),Td(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wd(t),null;case 13:if($e(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));la()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(Qe),null;case 4:return ua(),null;case 10:return xd(t.type._context),null;case 22:case 23:return Pd(),null;case 24:return null;default:return null}}var tc=!1,Ht=!1,aS=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Hs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){et(e,t,n)}else r.current=null}function ih(e,t,r){try{r()}catch(n){et(e,t,n)}}var um=!1;function oS(e,t){if(Hf=Bc,e=Px(),hd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,f=e,h=null;t:for(;;){for(var d;f!==r||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=a),h===s&&++u===n&&(l=a),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Vf={focusedElem:e,selectionRange:r},Bc=!1,pe=t;pe!==null;)if(t=pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pe=e;else for(;pe!==null;){t=pe;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,_=p.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:zr(t.type,m),_);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(S){et(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,pe=e;break}pe=t.return}return p=um,um=!1,p}function vo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&ih(t,r,s)}i=i.next}while(i!==n)}}function Ku(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function sh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function R_(e){var t=e.alternate;t!==null&&(e.alternate=null,R_(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[un],delete t[$o],delete t[$f],delete t[zk],delete t[jk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function N_(e){return e.tag===5||e.tag===3||e.tag===4}function fm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||N_(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ah(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Hc));else if(n!==4&&(e=e.child,e!==null))for(ah(e,t,r),e=e.sibling;e!==null;)ah(e,t,r),e=e.sibling}function oh(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(oh(e,t,r),e=e.sibling;e!==null;)oh(e,t,r),e=e.sibling}var It=null,jr=!1;function Yn(e,t,r){for(r=r.child;r!==null;)D_(e,t,r),r=r.sibling}function D_(e,t,r){if(fn&&typeof fn.onCommitFiberUnmount=="function")try{fn.onCommitFiberUnmount(Uu,r)}catch{}switch(r.tag){case 5:Ht||Hs(r,t);case 6:var n=It,i=jr;It=null,Yn(e,t,r),It=n,jr=i,It!==null&&(jr?(e=It,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):It.removeChild(r.stateNode));break;case 18:It!==null&&(jr?(e=It,r=r.stateNode,e.nodeType===8?U0(e.parentNode,r):e.nodeType===1&&U0(e,r),Wo(e)):U0(It,r.stateNode));break;case 4:n=It,i=jr,It=r.stateNode.containerInfo,jr=!0,Yn(e,t,r),It=n,jr=i;break;case 0:case 11:case 14:case 15:if(!Ht&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&ih(r,t,a),i=i.next}while(i!==n)}Yn(e,t,r);break;case 1:if(!Ht&&(Hs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){et(r,t,o)}Yn(e,t,r);break;case 21:Yn(e,t,r);break;case 22:r.mode&1?(Ht=(n=Ht)||r.memoizedState!==null,Yn(e,t,r),Ht=n):Yn(e,t,r);break;default:Yn(e,t,r)}}function hm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new aS),t.forEach(function(n){var i=gS.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Wr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:It=o.stateNode,jr=!1;break e;case 3:It=o.stateNode.containerInfo,jr=!0;break e;case 4:It=o.stateNode.containerInfo,jr=!0;break e}o=o.return}if(It===null)throw Error(Q(160));D_(s,a,i),It=null,jr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){et(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)O_(t,e),t=t.sibling}function O_(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Wr(t,e),an(e),n&4){try{vo(3,e,e.return),Ku(3,e)}catch(m){et(e,e.return,m)}try{vo(5,e,e.return)}catch(m){et(e,e.return,m)}}break;case 1:Wr(t,e),an(e),n&512&&r!==null&&Hs(r,r.return);break;case 5:if(Wr(t,e),an(e),n&512&&r!==null&&Hs(r,r.return),e.flags&32){var i=e.stateNode;try{Mo(i,"")}catch(m){et(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&tx(i,s),Nf(o,a);var c=Nf(o,s);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];u==="style"?ax(i,f):u==="dangerouslySetInnerHTML"?ix(i,f):u==="children"?Mo(i,f):Zh(i,u,f,c)}switch(o){case"input":Cf(i,s);break;case"textarea":rx(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Gs(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?Gs(i,!!s.multiple,s.defaultValue,!0):Gs(i,!!s.multiple,s.multiple?[]:"",!1))}i[$o]=s}catch(m){et(e,e.return,m)}}break;case 6:if(Wr(t,e),an(e),n&4){if(e.stateNode===null)throw Error(Q(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){et(e,e.return,m)}}break;case 3:if(Wr(t,e),an(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Wo(t.containerInfo)}catch(m){et(e,e.return,m)}break;case 4:Wr(t,e),an(e);break;case 13:Wr(t,e),an(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Dd=ct())),n&4&&hm(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ht=(c=Ht)||u,Wr(t,e),Ht=c):Wr(t,e),an(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(pe=e,u=e.child;u!==null;){for(f=pe=u;pe!==null;){switch(h=pe,d=h.child,h.tag){case 0:case 11:case 14:case 15:vo(4,h,h.return);break;case 1:Hs(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){et(n,r,m)}}break;case 5:Hs(h,h.return);break;case 22:if(h.memoizedState!==null){pm(f);continue}}d!==null?(d.return=h,pe=d):pm(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=sx("display",a))}catch(m){et(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){et(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wr(t,e),an(e),n&4&&hm(e);break;case 21:break;default:Wr(t,e),an(e)}}function an(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(N_(r)){var n=r;break e}r=r.return}throw Error(Q(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Mo(i,""),n.flags&=-33);var s=fm(e);oh(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=fm(e);ah(e,o,a);break;default:throw Error(Q(161))}}catch(l){et(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lS(e,t,r){pe=e,P_(e)}function P_(e,t,r){for(var n=(e.mode&1)!==0;pe!==null;){var i=pe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||tc;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Ht;o=tc;var c=Ht;if(tc=a,(Ht=l)&&!c)for(pe=i;pe!==null;)a=pe,l=a.child,a.tag===22&&a.memoizedState!==null?mm(i):l!==null?(l.return=a,pe=l):mm(i);for(;s!==null;)pe=s,P_(s),s=s.sibling;pe=i,tc=o,Ht=c}dm(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,pe=s):dm(e)}}function dm(e){for(;pe!==null;){var t=pe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ht||Ku(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ht)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:zr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Q1(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Q1(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Wo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}Ht||t.flags&512&&sh(t)}catch(h){et(t,t.return,h)}}if(t===e){pe=null;break}if(r=t.sibling,r!==null){r.return=t.return,pe=r;break}pe=t.return}}function pm(e){for(;pe!==null;){var t=pe;if(t===e){pe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,pe=r;break}pe=t.return}}function mm(e){for(;pe!==null;){var t=pe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ku(4,t)}catch(l){et(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){et(t,i,l)}}var s=t.return;try{sh(t)}catch(l){et(t,s,l)}break;case 5:var a=t.return;try{sh(t)}catch(l){et(t,a,l)}}}catch(l){et(t,t.return,l)}if(t===e){pe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,pe=o;break}pe=t.return}}var cS=Math.ceil,Jc=jn.ReactCurrentDispatcher,Rd=jn.ReactCurrentOwner,Pr=jn.ReactCurrentBatchConfig,De=0,Ct=null,dt=null,Nt=0,gr=0,Vs=Mi(0),_t=0,Qo=null,as=0,Xu=0,Nd=0,xo=null,cr=null,Dd=0,ha=1/0,wn=null,Zc=!1,lh=null,xi=null,rc=!1,ci=null,eu=0,_o=0,ch=null,Sc=-1,Cc=0;function er(){return De&6?ct():Sc!==-1?Sc:Sc=ct()}function _i(e){return e.mode&1?De&2&&Nt!==0?Nt&-Nt:Gk.transition!==null?(Cc===0&&(Cc=xx()),Cc):(e=Me,e!==0||(e=window.event,e=e===void 0?16:Sx(e.type)),e):1}function Jr(e,t,r,n){if(50<_o)throw _o=0,ch=null,Error(Q(185));_l(e,r,n),(!(De&2)||e!==Ct)&&(e===Ct&&(!(De&2)&&(Xu|=r),_t===4&&ti(e,Nt)),pr(e,n),r===1&&De===0&&!(t.mode&1)&&(ha=ct()+500,ju&&bi()))}function pr(e,t){var r=e.callbackNode;GT(e,t);var n=bc(e,e===Ct?Nt:0);if(n===0)r!==null&&k1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&k1(r),t===1)e.tag===0?$k(gm.bind(null,e)):jx(gm.bind(null,e)),Hk(function(){!(De&6)&&bi()}),r=null;else{switch(_x(n)){case 1:r=id;break;case 4:r=gx;break;case 16:r=Mc;break;case 536870912:r=vx;break;default:r=Mc}r=V_(r,L_.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function L_(e,t){if(Sc=-1,Cc=0,De&6)throw Error(Q(327));var r=e.callbackNode;if(Qs()&&e.callbackNode!==r)return null;var n=bc(e,e===Ct?Nt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=tu(e,n);else{t=n;var i=De;De|=2;var s=b_();(Ct!==e||Nt!==t)&&(wn=null,ha=ct()+500,Zi(e,t));do try{hS();break}catch(o){M_(e,o)}while(!0);vd(),Jc.current=s,De=i,dt!==null?t=0:(Ct=null,Nt=0,t=_t)}if(t!==0){if(t===2&&(i=Mf(e),i!==0&&(n=i,t=uh(e,i))),t===1)throw r=Qo,Zi(e,0),ti(e,n),pr(e,ct()),r;if(t===6)ti(e,n);else{if(i=e.current.alternate,!(n&30)&&!uS(i)&&(t=tu(e,n),t===2&&(s=Mf(e),s!==0&&(n=s,t=uh(e,s))),t===1))throw r=Qo,Zi(e,0),ti(e,n),pr(e,ct()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Q(345));case 2:ji(e,cr,wn);break;case 3:if(ti(e,n),(n&130023424)===n&&(t=Dd+500-ct(),10<t)){if(bc(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){er(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=jf(ji.bind(null,e,cr,wn),t);break}ji(e,cr,wn);break;case 4:if(ti(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Qr(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=ct()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cS(n/1960))-n,10<n){e.timeoutHandle=jf(ji.bind(null,e,cr,wn),n);break}ji(e,cr,wn);break;case 5:ji(e,cr,wn);break;default:throw Error(Q(329))}}}return pr(e,ct()),e.callbackNode===r?L_.bind(null,e):null}function uh(e,t){var r=xo;return e.current.memoizedState.isDehydrated&&(Zi(e,t).flags|=256),e=tu(e,t),e!==2&&(t=cr,cr=r,t!==null&&fh(t)),e}function fh(e){cr===null?cr=e:cr.push.apply(cr,e)}function uS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!tn(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ti(e,t){for(t&=~Nd,t&=~Xu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Qr(t),n=1<<r;e[r]=-1,t&=~n}}function gm(e){if(De&6)throw Error(Q(327));Qs();var t=bc(e,0);if(!(t&1))return pr(e,ct()),null;var r=tu(e,t);if(e.tag!==0&&r===2){var n=Mf(e);n!==0&&(t=n,r=uh(e,n))}if(r===1)throw r=Qo,Zi(e,0),ti(e,t),pr(e,ct()),r;if(r===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ji(e,cr,wn),pr(e,ct()),null}function Od(e,t){var r=De;De|=1;try{return e(t)}finally{De=r,De===0&&(ha=ct()+500,ju&&bi())}}function os(e){ci!==null&&ci.tag===0&&!(De&6)&&Qs();var t=De;De|=1;var r=Pr.transition,n=Me;try{if(Pr.transition=null,Me=1,e)return e()}finally{Me=n,Pr.transition=r,De=t,!(De&6)&&bi()}}function Pd(){gr=Vs.current,$e(Vs)}function Zi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Wk(r)),dt!==null)for(r=dt.return;r!==null;){var n=r;switch(pd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Vc();break;case 3:ua(),$e(hr),$e($t),Td();break;case 5:wd(n);break;case 4:ua();break;case 13:$e(Qe);break;case 19:$e(Qe);break;case 10:xd(n.type._context);break;case 22:case 23:Pd()}r=r.return}if(Ct=e,dt=e=yi(e.current,null),Nt=gr=t,_t=0,Qo=null,Nd=Xu=as=0,cr=xo=null,Yi!==null){for(t=0;t<Yi.length;t++)if(r=Yi[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Yi=null}return e}function M_(e,t){do{var r=dt;try{if(vd(),wc.current=Qc,qc){for(var n=Je.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}qc=!1}if(ss=0,kt=gt=Je=null,go=!1,Xo=0,Rd.current=null,r===null||r.return===null){_t=1,Qo=t,dt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=Nt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=nm(a);if(d!==null){d.flags&=-257,im(d,a,o,s,t),d.mode&1&&rm(s,c,t),t=d,l=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(l),t.updateQueue=m}else p.add(l);break e}else{if(!(t&1)){rm(s,c,t),Ld();break e}l=Error(Q(426))}}else if(Xe&&o.mode&1){var _=nm(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),im(_,a,o,s,t),md(fa(l,o));break e}}s=l=fa(l,o),_t!==4&&(_t=2),xo===null?xo=[s]:xo.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=__(s,l,t);q1(s,v);break e;case 1:o=l;var x=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(xi===null||!xi.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=y_(s,o,t);q1(s,S);break e}}s=s.return}while(s!==null)}U_(r)}catch(D){t=D,dt===r&&r!==null&&(dt=r=r.return);continue}break}while(!0)}function b_(){var e=Jc.current;return Jc.current=Qc,e===null?Qc:e}function Ld(){(_t===0||_t===3||_t===2)&&(_t=4),Ct===null||!(as&268435455)&&!(Xu&268435455)||ti(Ct,Nt)}function tu(e,t){var r=De;De|=2;var n=b_();(Ct!==e||Nt!==t)&&(wn=null,Zi(e,t));do try{fS();break}catch(i){M_(e,i)}while(!0);if(vd(),De=r,Jc.current=n,dt!==null)throw Error(Q(261));return Ct=null,Nt=0,_t}function fS(){for(;dt!==null;)B_(dt)}function hS(){for(;dt!==null&&!bT();)B_(dt)}function B_(e){var t=H_(e.alternate,e,gr);e.memoizedProps=e.pendingProps,t===null?U_(e):dt=t,Rd.current=null}function U_(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=sS(r,t),r!==null){r.flags&=32767,dt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,dt=null;return}}else if(r=iS(r,t,gr),r!==null){dt=r;return}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);_t===0&&(_t=5)}function ji(e,t,r){var n=Me,i=Pr.transition;try{Pr.transition=null,Me=1,dS(e,t,r,n)}finally{Pr.transition=i,Me=n}return null}function dS(e,t,r,n){do Qs();while(ci!==null);if(De&6)throw Error(Q(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(KT(e,s),e===Ct&&(dt=Ct=null,Nt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||rc||(rc=!0,V_(Mc,function(){return Qs(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Pr.transition,Pr.transition=null;var a=Me;Me=1;var o=De;De|=4,Rd.current=null,oS(e,r),O_(r,e),Ok(Vf),Bc=!!Hf,Vf=Hf=null,e.current=r,lS(r),BT(),De=o,Me=a,Pr.transition=s}else e.current=r;if(rc&&(rc=!1,ci=e,eu=i),s=e.pendingLanes,s===0&&(xi=null),HT(r.stateNode),pr(e,ct()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Zc)throw Zc=!1,e=lh,lh=null,e;return eu&1&&e.tag!==0&&Qs(),s=e.pendingLanes,s&1?e===ch?_o++:(_o=0,ch=e):_o=0,bi(),null}function Qs(){if(ci!==null){var e=_x(eu),t=Pr.transition,r=Me;try{if(Pr.transition=null,Me=16>e?16:e,ci===null)var n=!1;else{if(e=ci,ci=null,eu=0,De&6)throw Error(Q(331));var i=De;for(De|=4,pe=e.current;pe!==null;){var s=pe,a=s.child;if(pe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(pe=c;pe!==null;){var u=pe;switch(u.tag){case 0:case 11:case 15:vo(8,u,s)}var f=u.child;if(f!==null)f.return=u,pe=f;else for(;pe!==null;){u=pe;var h=u.sibling,d=u.return;if(R_(u),u===c){pe=null;break}if(h!==null){h.return=d,pe=h;break}pe=d}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}pe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,pe=a;else e:for(;pe!==null;){if(s=pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:vo(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,pe=v;break e}pe=s.return}}var x=e.current;for(pe=x;pe!==null;){a=pe;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,pe=g;else e:for(a=x;pe!==null;){if(o=pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ku(9,o)}}catch(D){et(o,o.return,D)}if(o===a){pe=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,pe=S;break e}pe=o.return}}if(De=i,bi(),fn&&typeof fn.onPostCommitFiberRoot=="function")try{fn.onPostCommitFiberRoot(Uu,e)}catch{}n=!0}return n}finally{Me=r,Pr.transition=t}}return!1}function vm(e,t,r){t=fa(r,t),t=__(e,t,1),e=vi(e,t,1),t=er(),e!==null&&(_l(e,1,t),pr(e,t))}function et(e,t,r){if(e.tag===3)vm(e,e,r);else for(;t!==null;){if(t.tag===3){vm(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(xi===null||!xi.has(n))){e=fa(r,e),e=y_(t,e,1),t=vi(t,e,1),e=er(),t!==null&&(_l(t,1,e),pr(t,e));break}}t=t.return}}function pS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=er(),e.pingedLanes|=e.suspendedLanes&r,Ct===e&&(Nt&r)===r&&(_t===4||_t===3&&(Nt&130023424)===Nt&&500>ct()-Dd?Zi(e,0):Nd|=r),pr(e,t)}function W_(e,t){t===0&&(e.mode&1?(t=Gl,Gl<<=1,!(Gl&130023424)&&(Gl=4194304)):t=1);var r=er();e=Bn(e,t),e!==null&&(_l(e,t,r),pr(e,r))}function mS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),W_(e,r)}function gS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Q(314))}n!==null&&n.delete(t),W_(e,r)}var H_;H_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||hr.current)ur=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ur=!1,nS(e,t,r);ur=!!(e.flags&131072)}else ur=!1,Xe&&t.flags&1048576&&$x(t,$c,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;kc(e,t),e=t.pendingProps;var i=oa(t,$t.current);qs(t,r),i=Sd(null,t,n,e,i,r);var s=Cd();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dr(n)?(s=!0,zc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yd(t),i.updater=Gu,t.stateNode=i,i._reactInternals=t,Qf(t,n,e,r),t=eh(null,t,n,!0,s,r)):(t.tag=0,Xe&&s&&dd(t),Yt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(kc(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=xS(n),e=zr(n,e),i){case 0:t=Zf(null,t,n,e,r);break e;case 1:t=om(null,t,n,e,r);break e;case 11:t=sm(null,t,n,e,r);break e;case 14:t=am(null,t,n,zr(n.type,e),r);break e}throw Error(Q(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zr(n,i),Zf(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zr(n,i),om(e,t,n,i,r);case 3:e:{if(k_(t),e===null)throw Error(Q(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Qx(e,t),Xc(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=fa(Error(Q(423)),t),t=lm(e,t,n,r,i);break e}else if(n!==i){i=fa(Error(Q(424)),t),t=lm(e,t,n,r,i);break e}else for(_r=gi(t.stateNode.containerInfo.firstChild),yr=t,Xe=!0,$r=null,r=Yx(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(la(),n===i){t=Un(e,t,r);break e}Yt(e,t,n,r)}t=t.child}return t;case 5:return Jx(t),e===null&&Xf(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,zf(n,i)?a=null:s!==null&&zf(n,s)&&(t.flags|=32),T_(e,t),Yt(e,t,a,r),t.child;case 6:return e===null&&Xf(t),null;case 13:return S_(e,t,r);case 4:return Ed(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ca(t,null,n,r):Yt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zr(n,i),sm(e,t,n,i,r);case 7:return Yt(e,t,t.pendingProps,r),t.child;case 8:return Yt(e,t,t.pendingProps.children,r),t.child;case 12:return Yt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Ve(Gc,n._currentValue),n._currentValue=a,s!==null)if(tn(s.value,a)){if(s.children===i.children&&!hr.current){t=Un(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Dn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Yf(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Q(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Yf(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Yt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,qs(t,r),i=Lr(i),n=n(i),t.flags|=1,Yt(e,t,n,r),t.child;case 14:return n=t.type,i=zr(n,t.pendingProps),i=zr(n.type,i),am(e,t,n,i,r);case 15:return E_(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zr(n,i),kc(e,t),t.tag=1,dr(n)?(e=!0,zc(t)):e=!1,qs(t,r),x_(t,n,i),Qf(t,n,i,r),eh(null,t,n,!0,e,r);case 19:return C_(e,t,r);case 22:return w_(e,t,r)}throw Error(Q(156,t.tag))};function V_(e,t){return mx(e,t)}function vS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(e,t,r,n){return new vS(e,t,r,n)}function Md(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xS(e){if(typeof e=="function")return Md(e)?1:0;if(e!=null){if(e=e.$$typeof,e===td)return 11;if(e===rd)return 14}return 2}function yi(e,t){var r=e.alternate;return r===null?(r=Dr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ac(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Md(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Ds:return es(r.children,i,s,t);case ed:a=8,i|=8;break;case Ef:return e=Dr(12,r,t,i|2),e.elementType=Ef,e.lanes=s,e;case wf:return e=Dr(13,r,t,i),e.elementType=wf,e.lanes=s,e;case Tf:return e=Dr(19,r,t,i),e.elementType=Tf,e.lanes=s,e;case Jv:return Yu(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case qv:a=10;break e;case Qv:a=9;break e;case td:a=11;break e;case rd:a=14;break e;case Jn:a=16,n=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=Dr(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function es(e,t,r,n){return e=Dr(7,e,n,t),e.lanes=r,e}function Yu(e,t,r,n){return e=Dr(22,e,n,t),e.elementType=Jv,e.lanes=r,e.stateNode={isHidden:!1},e}function K0(e,t,r){return e=Dr(6,e,null,t),e.lanes=r,e}function X0(e,t,r){return t=Dr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _S(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=I0(0),this.expirationTimes=I0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=I0(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function bd(e,t,r,n,i,s,a,o,l){return e=new _S(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Dr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},yd(s),e}function yS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ns,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function z_(e){if(!e)return Fi;e=e._reactInternals;e:{if(vs(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var r=e.type;if(dr(r))return zx(e,r,t)}return t}function j_(e,t,r,n,i,s,a,o,l){return e=bd(r,n,!0,e,i,s,a,o,l),e.context=z_(null),r=e.current,n=er(),i=_i(r),s=Dn(n,i),s.callback=t??null,vi(r,s,i),e.current.lanes=i,_l(e,i,n),pr(e,n),e}function qu(e,t,r,n){var i=t.current,s=er(),a=_i(i);return r=z_(r),t.context===null?t.context=r:t.pendingContext=r,t=Dn(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=vi(i,t,a),e!==null&&(Jr(e,i,a,s),Ec(e,i,a)),a}function ru(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function xm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Bd(e,t){xm(e,t),(e=e.alternate)&&xm(e,t)}function ES(){return null}var $_=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ud(e){this._internalRoot=e}Qu.prototype.render=Ud.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));qu(e,t,null,null)};Qu.prototype.unmount=Ud.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;os(function(){qu(null,e,null,null)}),t[bn]=null}};function Qu(e){this._internalRoot=e}Qu.prototype.unstable_scheduleHydration=function(e){if(e){var t=wx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ei.length&&t!==0&&t<ei[r].priority;r++);ei.splice(r,0,e),r===0&&kx(e)}};function Wd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ju(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _m(){}function wS(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=ru(a);s.call(c)}}var a=j_(t,n,e,0,null,!1,!1,"",_m);return e._reactRootContainer=a,e[bn]=a.current,zo(e.nodeType===8?e.parentNode:e),os(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=ru(l);o.call(c)}}var l=bd(e,0,!1,null,null,!1,!1,"",_m);return e._reactRootContainer=l,e[bn]=l.current,zo(e.nodeType===8?e.parentNode:e),os(function(){qu(t,l,r,n)}),l}function Zu(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=ru(a);o.call(l)}}qu(t,a,e,i)}else a=wS(r,t,e,i,n);return ru(a)}yx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ro(t.pendingLanes);r!==0&&(sd(t,r|1),pr(t,ct()),!(De&6)&&(ha=ct()+500,bi()))}break;case 13:os(function(){var n=Bn(e,1);if(n!==null){var i=er();Jr(n,e,1,i)}}),Bd(e,1)}};ad=function(e){if(e.tag===13){var t=Bn(e,134217728);if(t!==null){var r=er();Jr(t,e,134217728,r)}Bd(e,134217728)}};Ex=function(e){if(e.tag===13){var t=_i(e),r=Bn(e,t);if(r!==null){var n=er();Jr(r,e,t,n)}Bd(e,t)}};wx=function(){return Me};Tx=function(e,t){var r=Me;try{return Me=e,t()}finally{Me=r}};Of=function(e,t,r){switch(t){case"input":if(Cf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=zu(n);if(!i)throw Error(Q(90));ex(n),Cf(n,i)}}}break;case"textarea":rx(e,r);break;case"select":t=r.value,t!=null&&Gs(e,!!r.multiple,t,!1)}};cx=Od;ux=os;var TS={usingClientEntryPoint:!1,Events:[El,Ms,zu,ox,lx,Od]},Ya={findFiberByHostInstance:Xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kS={bundleType:Ya.bundleType,version:Ya.version,rendererPackageName:Ya.rendererPackageName,rendererConfig:Ya.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:jn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dx(e),e===null?null:e.stateNode},findFiberByHostInstance:Ya.findFiberByHostInstance||ES,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nc.isDisabled&&nc.supportsFiber)try{Uu=nc.inject(kS),fn=nc}catch{}}Tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TS;Tr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wd(t))throw Error(Q(200));return yS(e,t,null,r)};Tr.createRoot=function(e,t){if(!Wd(e))throw Error(Q(299));var r=!1,n="",i=$_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=bd(e,1,!1,null,null,r,!1,n,i),e[bn]=t.current,zo(e.nodeType===8?e.parentNode:e),new Ud(t)};Tr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=dx(t),e=e===null?null:e.stateNode,e};Tr.flushSync=function(e){return os(e)};Tr.hydrate=function(e,t,r){if(!Ju(t))throw Error(Q(200));return Zu(null,e,t,!0,r)};Tr.hydrateRoot=function(e,t,r){if(!Wd(e))throw Error(Q(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=$_;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=j_(t,null,e,1,r??null,i,!1,s,a),e[bn]=t.current,zo(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Qu(t)};Tr.render=function(e,t,r){if(!Ju(t))throw Error(Q(200));return Zu(null,e,t,!1,r)};Tr.unmountComponentAtNode=function(e){if(!Ju(e))throw Error(Q(40));return e._reactRootContainer?(os(function(){Zu(null,null,e,!1,function(){e._reactRootContainer=null,e[bn]=null})}),!0):!1};Tr.unstable_batchedUpdates=Od;Tr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ju(r))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return Zu(e,t,r,!1,n)};Tr.version="18.3.1-next-f1338f8080-20240426";function G_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(G_)}catch(e){console.error(e)}}G_(),Gv.exports=Tr;var SS=Gv.exports,K_,ym=SS;K_=ym.createRoot,ym.hydrateRoot;var Em={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re=function(e,t){if(!e)throw Ca(t)},Ca=function(e){return new Error("Firebase Database ("+X_.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},CS=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],a=e[r++],o=e[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return t.join("")},Hd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],a=i+1<e.length,o=a?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,u=s>>2,f=(s&3)<<4|o>>4;let h=(o&15)<<2|c>>6,d=c&63;l||(d=64,a||(h=64)),n.push(r[u],r[f],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Y_(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):CS(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],o=i<e.length?r[e.charAt(i)]:0;++i;const c=i<e.length?r[e.charAt(i)]:64;++i;const f=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new AS;const h=s<<2|o>>4;if(n.push(h),c!==64){const d=o<<4&240|c>>2;if(n.push(d),f!==64){const p=c<<6&192|f;n.push(p)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class AS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const q_=function(e){const t=Y_(e);return Hd.encodeByteArray(t,!0)},nu=function(e){return q_(e).replace(/\./g,"")},iu=function(e){try{return Hd.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(e){return Q_(void 0,e)}function Q_(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!FS(r)||(e[r]=Q_(e[r],t[r]));return e}function FS(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS=()=>RS().__FIREBASE_DEFAULTS__,DS=()=>{if(typeof process>"u"||typeof Em>"u")return;const e=Em.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},OS=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&iu(e[1]);return t&&JSON.parse(t)},Vd=()=>{try{return NS()||DS()||OS()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},J_=e=>{var t,r;return(r=(t=Vd())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},PS=e=>{const t=J_(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},Z_=()=>{var e;return(e=Vd())===null||e===void 0?void 0:e.config},ey=e=>{var t;return(t=Vd())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[nu(JSON.stringify(r)),nu(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nr())}function MS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bS(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function ty(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function BS(){const e=nr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function ry(){return X_.NODE_ADMIN===!0}function US(){try{return typeof indexedDB=="object"}catch{return!1}}function WS(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS="FirebaseError";class Bi extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=HS,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kl.prototype.create)}}class kl{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],a=s?VS(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Bi(i,o,n)}}function VS(e,t){return e.replace(zS,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const zS=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(e){return JSON.parse(e)}function xt(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ny=function(e){let t={},r={},n={},i="";try{const s=e.split(".");t=Jo(iu(s[0])||""),r=Jo(iu(s[1])||""),i=s[2],n=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:n,signature:i}},jS=function(e){const t=ny(e),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},$S=function(e){const t=ny(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function da(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function hh(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function su(e,t,r){const n={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=t.call(r,e[i],i,e));return n}function au(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],a=t[i];if(wm(s)&&wm(a)){if(!au(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function wm(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function io(e){const t={};return e.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function so(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const n=this.W_;if(typeof t=="string")for(let f=0;f<16;f++)n[f]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let f=0;f<16;f++)n[f]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let f=16;f<80;f++){const h=n[f-3]^n[f-8]^n[f-14]^n[f-16];n[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],a=this.chain_[2],o=this.chain_[3],l=this.chain_[4],c,u;for(let f=0;f<80;f++){f<40?f<20?(c=o^s&(a^o),u=1518500249):(c=s^a^o,u=1859775393):f<60?(c=s&a|o&(s|a),u=2400959708):(c=s^a^o,u=3395469782);const h=(i<<5|i>>>27)+c+l+u+n[f]&4294967295;l=o,o=a,a=(s<<30|s>>>2)&4294967295,s=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const n=r-this.blockSize;let i=0;const s=this.buf_;let a=this.inbuf_;for(;i<r;){if(a===0)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<r;)if(s[a]=t.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}else for(;i<r;)if(s[a]=t[i],++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=r&255,r/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)t[n]=this.chain_[i]>>s&255,++n;return t}}function KS(e,t){const r=new XS(e,t);return r.subscribe.bind(r)}class XS{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let i;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");YS(t,["next","error","complete"])?i=t:i={next:t,error:r,complete:n},i.next===void 0&&(i.next=Y0),i.error===void 0&&(i.error=Y0),i.complete===void 0&&(i.complete=Y0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YS(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function Y0(){}function e0(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i>=55296&&i<=56319){const s=i-55296;n++,re(n<e.length,"Surrogate pair missing trail surrogate.");const a=e.charCodeAt(n)-56320;i=65536+(s<<10)+a}i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):i<65536?(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},t0=function(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(e){return e&&e._delegate?e._delegate:e}class ls{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new Tl;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(ZS(t))try{this.getOrInitializeService({instanceIdentifier:$i})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=$i){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=$i){return this.instances.has(t)}getOptions(t=$i){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&t(a,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:JS(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=$i){return this.component?this.component.multipleInstances?t:$i:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JS(e){return e===$i?void 0:e}function ZS(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new QS(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(be||(be={}));const tC={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},rC=be.INFO,nC={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},iC=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=nC[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class jd{constructor(t){this.name=t,this._logLevel=rC,this._logHandler=iC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in be))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?tC[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...t),this._logHandler(this,be.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...t),this._logHandler(this,be.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,be.INFO,...t),this._logHandler(this,be.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,be.WARN,...t),this._logHandler(this,be.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...t),this._logHandler(this,be.ERROR,...t)}}const sC=(e,t)=>t.some(r=>e instanceof r);let Tm,km;function aC(){return Tm||(Tm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oC(){return km||(km=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iy=new WeakMap,dh=new WeakMap,sy=new WeakMap,q0=new WeakMap,$d=new WeakMap;function lC(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(Ei(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&iy.set(r,e)}).catch(()=>{}),$d.set(t,e),t}function cC(e){if(dh.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});dh.set(e,t)}let ph={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return dh.get(e);if(t==="objectStoreNames")return e.objectStoreNames||sy.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ei(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function uC(e){ph=e(ph)}function fC(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(Q0(this),t,...r);return sy.set(n,t.sort?t.sort():[t]),Ei(n)}:oC().includes(e)?function(...t){return e.apply(Q0(this),t),Ei(iy.get(this))}:function(...t){return Ei(e.apply(Q0(this),t))}}function hC(e){return typeof e=="function"?fC(e):(e instanceof IDBTransaction&&cC(e),sC(e,aC())?new Proxy(e,ph):e)}function Ei(e){if(e instanceof IDBRequest)return lC(e);if(q0.has(e))return q0.get(e);const t=hC(e);return t!==e&&(q0.set(e,t),$d.set(t,e)),t}const Q0=e=>$d.get(e);function dC(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=Ei(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Ei(a.result),l.oldVersion,l.newVersion,Ei(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const pC=["get","getKey","getAll","getAllKeys","count"],mC=["put","add","delete","clear"],J0=new Map;function Sm(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(J0.get(t))return J0.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=mC.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||pC.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return J0.set(t,s),s}uC(e=>({...e,get:(t,r,n)=>Sm(t,r)||e.get(t,r,n),has:(t,r)=>!!Sm(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(vC(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function vC(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const mh="@firebase/app",Cm="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn=new jd("@firebase/app"),xC="@firebase/app-compat",_C="@firebase/analytics-compat",yC="@firebase/analytics",EC="@firebase/app-check-compat",wC="@firebase/app-check",TC="@firebase/auth",kC="@firebase/auth-compat",SC="@firebase/database",CC="@firebase/data-connect",AC="@firebase/database-compat",IC="@firebase/functions",FC="@firebase/functions-compat",RC="@firebase/installations",NC="@firebase/installations-compat",DC="@firebase/messaging",OC="@firebase/messaging-compat",PC="@firebase/performance",LC="@firebase/performance-compat",MC="@firebase/remote-config",bC="@firebase/remote-config-compat",BC="@firebase/storage",UC="@firebase/storage-compat",WC="@firebase/firestore",HC="@firebase/vertexai-preview",VC="@firebase/firestore-compat",zC="firebase",jC="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh="[DEFAULT]",$C={[mh]:"fire-core",[xC]:"fire-core-compat",[yC]:"fire-analytics",[_C]:"fire-analytics-compat",[wC]:"fire-app-check",[EC]:"fire-app-check-compat",[TC]:"fire-auth",[kC]:"fire-auth-compat",[SC]:"fire-rtdb",[CC]:"fire-data-connect",[AC]:"fire-rtdb-compat",[IC]:"fire-fn",[FC]:"fire-fn-compat",[RC]:"fire-iid",[NC]:"fire-iid-compat",[DC]:"fire-fcm",[OC]:"fire-fcm-compat",[PC]:"fire-perf",[LC]:"fire-perf-compat",[MC]:"fire-rc",[bC]:"fire-rc-compat",[BC]:"fire-gcs",[UC]:"fire-gcs-compat",[WC]:"fire-fst",[VC]:"fire-fst-compat",[HC]:"fire-vertex","fire-js":"fire-js",[zC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ou=new Map,GC=new Map,vh=new Map;function Am(e,t){try{e.container.addComponent(t)}catch(r){Wn.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function pa(e){const t=e.name;if(vh.has(t))return Wn.debug(`There were multiple attempts to register component ${t}.`),!1;vh.set(t,e);for(const r of ou.values())Am(r,e);for(const r of GC.values())Am(r,e);return!0}function Gd(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function Cn(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wi=new kl("app","Firebase",KC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ls("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia=jC;function ay(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:gh,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw wi.create("bad-app-name",{appName:String(i)});if(r||(r=Z_()),!r)throw wi.create("no-options");const s=ou.get(i);if(s){if(au(r,s.options)&&au(n,s.config))return s;throw wi.create("duplicate-app",{appName:i})}const a=new eC(i);for(const l of vh.values())a.addComponent(l);const o=new XC(r,n,a);return ou.set(i,o),o}function oy(e=gh){const t=ou.get(e);if(!t&&e===gh&&Z_())return ay();if(!t)throw wi.create("no-app",{appName:e});return t}function Ti(e,t,r){var n;let i=(n=$C[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Wn.warn(o.join(" "));return}pa(new ls(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC="firebase-heartbeat-database",qC=1,Zo="firebase-heartbeat-store";let Z0=null;function ly(){return Z0||(Z0=dC(YC,qC,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Zo)}catch(r){console.warn(r)}}}}).catch(e=>{throw wi.create("idb-open",{originalErrorMessage:e.message})})),Z0}async function QC(e){try{const r=(await ly()).transaction(Zo),n=await r.objectStore(Zo).get(cy(e));return await r.done,n}catch(t){if(t instanceof Bi)Wn.warn(t.message);else{const r=wi.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Wn.warn(r.message)}}}async function Im(e,t){try{const n=(await ly()).transaction(Zo,"readwrite");await n.objectStore(Zo).put(t,cy(e)),await n.done}catch(r){if(r instanceof Bi)Wn.warn(r.message);else{const n=wi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Wn.warn(n.message)}}}function cy(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=1024,ZC=30*24*60*60*1e3;class eA{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new rA(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Fm();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=ZC}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Wn.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Fm(),{heartbeatsToSend:n,unsentEntries:i}=tA(this._heartbeatsCache.heartbeats),s=nu(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Wn.warn(r),""}}}function Fm(){return new Date().toISOString().substring(0,10)}function tA(e,t=JC){const r=[];let n=e.slice();for(const i of e){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Rm(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Rm(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class rA{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return US()?WS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await QC(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Im(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Im(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Rm(e){return nu(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(e){pa(new ls("platform-logger",t=>new gC(t),"PRIVATE")),pa(new ls("heartbeat",t=>new eA(t),"PRIVATE")),Ti(mh,Cm,e),Ti(mh,Cm,"esm2017"),Ti("fire-js","")}nA("");function Kd(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function uy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const iA=uy,fy=new kl("auth","Firebase",uy());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=new jd("@firebase/auth");function sA(e,...t){lu.logLevel<=be.WARN&&lu.warn(`Auth (${Ia}): ${e}`,...t)}function Ic(e,...t){lu.logLevel<=be.ERROR&&lu.error(`Auth (${Ia}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(e,...t){throw Xd(e,...t)}function dn(e,...t){return Xd(e,...t)}function hy(e,t,r){const n=Object.assign(Object.assign({},iA()),{[t]:r});return new kl("auth","Firebase",n).create(t,{appName:e.name})}function ki(e){return hy(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Xd(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return fy.create(e,...t)}function xe(e,t,...r){if(!e)throw Xd(t,...r)}function An(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ic(t),new Error(t)}function Hn(e,t){e||An(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function aA(){return Nm()==="http:"||Nm()==="https:"}function Nm(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aA()||bS()||"connection"in navigator)?navigator.onLine:!0}function lA(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(t,r){this.shortDelay=t,this.longDelay=r,Hn(r>t,"Short delay should be less than long delay!"),this.isMobile=zd()||ty()}get(){return oA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(e,t){Hn(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;An("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;An("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;An("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=new Sl(3e4,6e4);function xs(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Ui(e,t,r,n,i={}){return py(e,i,async()=>{let s={},a={};n&&(t==="GET"?a=n:s={body:JSON.stringify(n)});const o=Aa(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},s);return MS()||(c.referrerPolicy="no-referrer"),dy.fetch()(my(e,e.config.apiHost,r,o),c)})}async function py(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},cA),t);try{const i=new hA(e),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw ic(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ic(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw ic(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw ic(e,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw hy(e,u,c);rn(e,u)}}catch(i){if(i instanceof Bi)throw i;rn(e,"network-request-failed",{message:String(i)})}}async function r0(e,t,r,n,i={}){const s=await Ui(e,t,r,n,i);return"mfaPendingCredential"in s&&rn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function my(e,t,r,n){const i=`${t}${r}?${n}`;return e.config.emulator?Yd(e.config,i):`${e.config.apiScheme}://${i}`}function fA(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class hA{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(dn(this.auth,"network-request-failed")),uA.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ic(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=dn(e,t,n);return i.customData._tokenResponse=r,i}function Dm(e){return e!==void 0&&e.enterprise!==void 0}class dA{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===t)return fA(r.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}}async function pA(e,t){return Ui(e,"GET","/v2/recaptchaConfig",xs(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mA(e,t){return Ui(e,"POST","/v1/accounts:delete",t)}async function gy(e,t){return Ui(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function gA(e,t=!1){const r=or(e),n=await r.getIdToken(t),i=qd(n);xe(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:yo(ef(i.auth_time)),issuedAtTime:yo(ef(i.iat)),expirationTime:yo(ef(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function ef(e){return Number(e)*1e3}function qd(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return Ic("JWT malformed, contained fewer than 3 sections"),null;try{const i=iu(r);return i?JSON.parse(i):(Ic("Failed to decode base64 JWT payload"),null)}catch(i){return Ic("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Om(e){const t=qd(e);return xe(t,"internal-error"),xe(typeof t.exp<"u","internal-error"),xe(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof Bi&&vA(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function vA({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=yo(this.lastLoginAt),this.creationTime=yo(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cu(e){var t;const r=e.auth,n=await e.getIdToken(),i=await el(e,gy(r,{idToken:n}));xe(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?vy(s.providerUserInfo):[],o=yA(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new _h(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,f)}async function _A(e){const t=or(e);await cu(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function yA(e,t){return[...e.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function vy(e){return e.map(t=>{var{providerId:r}=t,n=Kd(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EA(e,t){const r=await py(e,{},async()=>{const n=Aa({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,a=my(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",dy.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function wA(e,t){return Ui(e,"POST","/v2/accounts:revokeToken",xs(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){xe(t.idToken,"internal-error"),xe(typeof t.idToken<"u","internal-error"),xe(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Om(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){xe(t.length!==0,"internal-error");const r=Om(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(xe(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await EA(t,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Js;return n&&(xe(typeof n=="string","internal-error",{appName:t}),a.refreshToken=n),i&&(xe(typeof i=="string","internal-error",{appName:t}),a.accessToken=i),s&&(xe(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Js,this.toJSON())}_performRefresh(){return An("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(e,t){xe(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class In{constructor(t){var{uid:r,auth:n,stsTokenManager:i}=t,s=Kd(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _h(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await el(this,this.stsTokenManager.getToken(this.auth,t));return xe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return gA(this,t)}reload(){return _A(this)}_assign(t){this!==t&&(xe(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new In(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){xe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await cu(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cn(this.auth.app))return Promise.reject(ki(this.auth));const t=await this.getIdToken();return await el(this,mA(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,i,s,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(i=r.email)!==null&&i!==void 0?i:void 0,d=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,p=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,v=(c=r.createdAt)!==null&&c!==void 0?c:void 0,x=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:g,emailVerified:S,isAnonymous:D,providerData:k,stsTokenManager:E}=r;xe(g&&E,t,"internal-error");const O=Js.fromJSON(this.name,E);xe(typeof g=="string",t,"internal-error"),qn(f,t.name),qn(h,t.name),xe(typeof S=="boolean",t,"internal-error"),xe(typeof D=="boolean",t,"internal-error"),qn(d,t.name),qn(p,t.name),qn(m,t.name),qn(_,t.name),qn(v,t.name),qn(x,t.name);const N=new In({uid:g,auth:t,email:h,emailVerified:S,displayName:f,isAnonymous:D,photoURL:p,phoneNumber:d,tenantId:m,stsTokenManager:O,createdAt:v,lastLoginAt:x});return k&&Array.isArray(k)&&(N.providerData=k.map(B=>Object.assign({},B))),_&&(N._redirectEventId=_),N}static async _fromIdTokenResponse(t,r,n=!1){const i=new Js;i.updateFromServerResponse(r);const s=new In({uid:r.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await cu(s),s}static async _fromGetAccountInfoResponse(t,r,n){const i=r.users[0];xe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?vy(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Js;o.updateFromIdToken(n);const l=new In({uid:i.localId,auth:t,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new _h(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm=new Map;function Fn(e){Hn(e instanceof Function,"Expected a class definition");let t=Pm.get(e);return t?(Hn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Pm.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}xy.type="NONE";const Lm=xy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(e,t,r){return`firebase:${e}:${t}:${r}`}class Zs{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Fc(this.userKey,i.apiKey,s),this.fullPersistenceKey=Fc("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?In._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new Zs(Fn(Lm),t,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Fn(Lm);const a=Fc(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=In._fromJSON(t,u);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Zs(s,t,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Zs(s,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(wy(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(_y(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ky(t))return"Blackberry";if(Sy(t))return"Webos";if(yy(t))return"Safari";if((t.includes("chrome/")||Ey(t))&&!t.includes("edge/"))return"Chrome";if(Ty(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function _y(e=nr()){return/firefox\//i.test(e)}function yy(e=nr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Ey(e=nr()){return/crios\//i.test(e)}function wy(e=nr()){return/iemobile/i.test(e)}function Ty(e=nr()){return/android/i.test(e)}function ky(e=nr()){return/blackberry/i.test(e)}function Sy(e=nr()){return/webos/i.test(e)}function Qd(e=nr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function TA(e=nr()){var t;return Qd(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function kA(){return BS()&&document.documentMode===10}function Cy(e=nr()){return Qd(e)||Ty(e)||Sy(e)||ky(e)||/windows phone/i.test(e)||wy(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(e,t=[]){let r;switch(e){case"Browser":r=Mm(nr());break;case"Worker":r=`${Mm(nr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ia}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CA(e,t={}){return Ui(e,"GET","/v2/passwordPolicy",xs(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=6;class IA{constructor(t){var r,n,i,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:AA,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),i&&(r.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(t,r,n,i){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bm(this),this.idTokenSubscription=new bm(this),this.beforeStateQueue=new SA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Fn(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Zs.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await gy(this,{idToken:t}),n=await In._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(Cn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return xe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await cu(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=lA()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Cn(this.app))return Promise.reject(ki(this));const r=t?or(t):null;return r&&xe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&xe(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Cn(this.app)?Promise.reject(ki(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Cn(this.app)?Promise.reject(ki(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fn(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await CA(this),r=new IA(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new kl("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await wA(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Fn(t)||this._popupRedirectResolver;xe(r,this,"argument-error"),this.redirectPersistenceManager=await Zs.create(this,[Fn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(xe(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return xe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Ay(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&sA(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Fa(e){return or(e)}class bm{constructor(t){this.auth=t,this.observer=null,this.addObserver=KS(r=>this.observer=r)}get next(){return xe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RA(e){n0=e}function Iy(e){return n0.loadJS(e)}function NA(){return n0.recaptchaEnterpriseScript}function DA(){return n0.gapiScript}function OA(e){return`__${e}${Math.floor(Math.random()*1e6)}`}const PA="recaptcha-enterprise",LA="NO_RECAPTCHA";class MA{constructor(t){this.type=PA,this.auth=Fa(t)}async verify(t="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{pA(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new dA(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;Dm(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:t}).then(c=>{a(c)}).catch(()=>{a(LA)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&Dm(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=NA();l.length!==0&&(l+=o),Iy(l).then(()=>{i(o,s,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function Bm(e,t,r,n=!1){const i=new MA(e);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},t);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Um(e,t,r,n){var i;if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Bm(e,t,r,r==="getOobCode");return n(e,s)}else return n(e,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Bm(e,t,r,r==="getOobCode");return n(e,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(e,t){const r=Gd(e,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(au(s,t??{}))return i;rn(i,"already-initialized")}return r.initialize({options:t})}function BA(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Fn);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function UA(e,t,r){const n=Fa(e);xe(n._canInitEmulator,n,"emulator-config-failed"),xe(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!1,s=Fy(t),{host:a,port:o}=WA(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),HA()}function Fy(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function WA(e){const t=Fy(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:Wm(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Wm(a)}}}function Wm(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function HA(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return An("not implemented")}_getIdTokenResponse(t){return An("not implemented")}_linkToIdToken(t,r){return An("not implemented")}_getReauthenticationResolver(t){return An("not implemented")}}async function VA(e,t){return Ui(e,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zA(e,t){return r0(e,"POST","/v1/accounts:signInWithPassword",xs(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jA(e,t){return r0(e,"POST","/v1/accounts:signInWithEmailLink",xs(e,t))}async function $A(e,t){return r0(e,"POST","/v1/accounts:signInWithEmailLink",xs(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl extends Jd{constructor(t,r,n,i=null){super("password",n),this._email=t,this._password=r,this._tenantId=i}static _fromEmailAndPassword(t,r){return new tl(t,r,"password")}static _fromEmailAndCode(t,r,n=null){return new tl(t,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Um(t,r,"signInWithPassword",zA);case"emailLink":return jA(t,{email:this._email,oobCode:this._password});default:rn(t,"internal-error")}}async _linkToIdToken(t,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Um(t,n,"signUpPassword",VA);case"emailLink":return $A(t,{idToken:r,email:this._email,oobCode:this._password});default:rn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ea(e,t){return r0(e,"POST","/v1/accounts:signInWithIdp",xs(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="http://localhost";class cs extends Jd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new cs(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):rn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i}=r,s=Kd(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new cs(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return ea(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,ea(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,ea(t,r)}buildRequest(){const t={requestUri:GA,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Aa(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function XA(e){const t=io(so(e)).link,r=t?io(so(t)).deep_link_id:null,n=io(so(e)).deep_link_id;return(n?io(so(n)).link:null)||n||r||t||e}class Zd{constructor(t){var r,n,i,s,a,o;const l=io(so(t)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,f=KA((i=l.mode)!==null&&i!==void 0?i:null);xe(c&&u&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(t){const r=XA(t);try{return new Zd(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(){this.providerId=Ra.PROVIDER_ID}static credential(t,r){return tl._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const n=Zd.parseLink(r);return xe(n,"argument-error"),tl._fromEmailAndCode(t,n.code,n.tenantId)}}Ra.PROVIDER_ID="password";Ra.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ra.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl extends Ry{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri extends Cl{constructor(){super("facebook.com")}static credential(t){return cs._fromParams({providerId:ri.PROVIDER_ID,signInMethod:ri.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ri.credentialFromTaggedObject(t)}static credentialFromError(t){return ri.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ri.credential(t.oauthAccessToken)}catch{return null}}}ri.FACEBOOK_SIGN_IN_METHOD="facebook.com";ri.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends Cl{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return cs._fromParams({providerId:ni.PROVIDER_ID,signInMethod:ni.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return ni.credentialFromTaggedObject(t)}static credentialFromError(t){return ni.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return ni.credential(r,n)}catch{return null}}}ni.GOOGLE_SIGN_IN_METHOD="google.com";ni.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii extends Cl{constructor(){super("github.com")}static credential(t){return cs._fromParams({providerId:ii.PROVIDER_ID,signInMethod:ii.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ii.credentialFromTaggedObject(t)}static credentialFromError(t){return ii.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ii.credential(t.oauthAccessToken)}catch{return null}}}ii.GITHUB_SIGN_IN_METHOD="github.com";ii.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si extends Cl{constructor(){super("twitter.com")}static credential(t,r){return cs._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return si.credentialFromTaggedObject(t)}static credentialFromError(t){return si.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return si.credential(r,n)}catch{return null}}}si.TWITTER_SIGN_IN_METHOD="twitter.com";si.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,i=!1){const s=await In._fromIdTokenResponse(t,n,i),a=Hm(n);return new ma({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const i=Hm(n);return new ma({user:t,providerId:i,_tokenResponse:n,operationType:r})}}function Hm(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu extends Bi{constructor(t,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,uu.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,i){return new uu(t,r,n,i)}}function Ny(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?uu._fromErrorAndOperation(e,s,t,n):s})}async function YA(e,t,r=!1){const n=await el(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return ma._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qA(e,t,r=!1){const{auth:n}=e;if(Cn(n.app))return Promise.reject(ki(n));const i="reauthenticate";try{const s=await el(e,Ny(n,i,t,e),r);xe(s.idToken,n,"internal-error");const a=qd(s.idToken);xe(a,n,"internal-error");const{sub:o}=a;return xe(e.uid===o,n,"user-mismatch"),ma._forOperation(e,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&rn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dy(e,t,r=!1){if(Cn(e.app))return Promise.reject(ki(e));const n="signIn",i=await Ny(e,n,t),s=await ma._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function QA(e,t){return Dy(Fa(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JA(e){const t=Fa(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function ZA(e,t,r){return Cn(e.app)?Promise.reject(ki(e)):QA(or(e),Ra.credential(t,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&JA(e),n})}function eI(e,t,r,n){return or(e).onIdTokenChanged(t,r,n)}function tI(e,t,r){return or(e).beforeAuthStateChanged(t,r)}function rI(e,t,r,n){return or(e).onAuthStateChanged(t,r,n)}function nI(e){return or(e).signOut()}const fu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(fu,"1"),this.storage.removeItem(fu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=1e3,sI=10;class Py extends Oy{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Cy(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&t(r,i,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);kA()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,sI):i()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},iI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}Py.type="LOCAL";const aI=Py;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly extends Oy{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}Ly.type="SESSION";const My=Ly;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(i=>i.isListeningto(t));if(r)return r;const n=new i0(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await oI(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}i0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=ep("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(h.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function cI(e){pn().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function uI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fI(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function hI(){return by()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="firebaseLocalStorageDb",dI=1,hu="firebaseLocalStorage",Uy="fbase_key";class Al{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function s0(e,t){return e.transaction([hu],t?"readwrite":"readonly").objectStore(hu)}function pI(){const e=indexedDB.deleteDatabase(By);return new Al(e).toPromise()}function yh(){const e=indexedDB.open(By,dI);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(hu,{keyPath:Uy})}catch(i){r(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(hu)?t(n):(n.close(),await pI(),t(await yh()))})})}async function Vm(e,t,r){const n=s0(e,!0).put({[Uy]:t,value:r});return new Al(n).toPromise()}async function mI(e,t){const r=s0(e,!1).get(t),n=await new Al(r).toPromise();return n===void 0?null:n.value}function zm(e,t){const r=s0(e,!0).delete(t);return new Al(r).toPromise()}const gI=800,vI=3;class Wy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yh(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>vI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return by()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=i0._getInstance(hI()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await uI(),!this.activeServiceWorker)return;this.sender=new lI(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||fI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await yh();return await Vm(t,fu,"1"),await zm(t,fu),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Vm(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>mI(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>zm(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=s0(i,!1).getAll();return new Al(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),gI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Wy.type="LOCAL";const xI=Wy;new Sl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(e,t){return t?Fn(t):(xe(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp extends Jd{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ea(t,this._buildIdpRequest())}_linkToIdToken(t,r){return ea(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return ea(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function yI(e){return Dy(e.auth,new tp(e),e.bypassAuthState)}function EI(e){const{auth:t,user:r}=e;return xe(r,t,"internal-error"),qA(r,new tp(e),e.bypassAuthState)}async function wI(e){const{auth:t,user:r}=e;return xe(r,t,"internal-error"),YA(r,new tp(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(t,r,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return yI;case"linkViaPopup":case"linkViaRedirect":return wI;case"reauthViaPopup":case"reauthViaRedirect":return EI;default:rn(this.auth,"internal-error")}}resolve(t){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=new Sl(2e3,1e4);class zs extends Hy{constructor(t,r,n,i,s){super(t,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,zs.currentPopupAction&&zs.currentPopupAction.cancel(),zs.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return xe(t,this.auth,"internal-error"),t}async onExecution(){Hn(this.filter.length===1,"Popup operations only handle one event");const t=ep();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(dn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(dn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zs.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,TI.get())};t()}}zs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI="pendingRedirect",Rc=new Map;class SI extends Hy{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=Rc.get(this.auth._key());if(!t){try{const n=await CI(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}Rc.set(this.auth._key(),t)}return this.bypassAuthState||Rc.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CI(e,t){const r=FI(t),n=II(e);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function AI(e,t){Rc.set(e._key(),t)}function II(e){return Fn(e._redirectPersistence)}function FI(e){return Fc(kI,e.config.apiKey,e.name)}async function RI(e,t,r=!1){if(Cn(e.app))return Promise.reject(ki(e));const n=Fa(e),i=_I(n,t),a=await new SI(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=10*60*1e3;class DI{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!OI(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!Vy(t)){const i=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(dn(this.auth,i))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=NI&&this.cachedEventUids.clear(),this.cachedEventUids.has(jm(t))}saveEventToCache(t){this.cachedEventUids.add(jm(t)),this.lastProcessedEventTime=Date.now()}}function jm(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function Vy({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function OI(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Vy(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PI(e,t={}){return Ui(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MI=/^https?/;async function bI(e){if(e.config.emulator)return;const{authorizedDomains:t}=await PI(e);for(const r of t)try{if(BI(r))return}catch{}rn(e,"unauthorized-domain")}function BI(e){const t=xh(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!MI.test(r))return!1;if(LI.test(e))return n===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new Sl(3e4,6e4);function $m(){const e=pn().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function WI(e){return new Promise((t,r)=>{var n,i,s;function a(){$m(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$m(),r(dn(e,"network-request-failed"))},timeout:UI.get()})}if(!((i=(n=pn().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((s=pn().gapi)===null||s===void 0)&&s.load)a();else{const o=OA("iframefcb");return pn()[o]=()=>{gapi.load?a():r(dn(e,"network-request-failed"))},Iy(`${DA()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw Nc=null,t})}let Nc=null;function HI(e){return Nc=Nc||WI(e),Nc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=new Sl(5e3,15e3),zI="__/auth/iframe",jI="emulator/auth/iframe",$I={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},GI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function KI(e){const t=e.config;xe(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Yd(t,jI):`https://${e.config.authDomain}/${zI}`,n={apiKey:t.apiKey,appName:e.name,v:Ia},i=GI.get(e.config.apiHost);i&&(n.eid=i);const s=e._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Aa(n).slice(1)}`}async function XI(e){const t=await HI(e),r=pn().gapi;return xe(r,e,"internal-error"),t.open({where:document.body,url:KI(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$I,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=dn(e,"network-request-failed"),o=pn().setTimeout(()=>{s(a)},VI.get());function l(){pn().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qI=500,QI=600,JI="_blank",ZI="http://localhost";class Gm{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function e4(e,t,r,n=qI,i=QI){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},YI),{width:n.toString(),height:i.toString(),top:s,left:a}),c=nr().toLowerCase();r&&(o=Ey(c)?JI:r),_y(c)&&(t=t||ZI,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[d,p])=>`${h}${d}=${p},`,"");if(TA(c)&&o!=="_self")return t4(t||"",o),new Gm(null);const f=window.open(t||"",o,u);xe(f,e,"popup-blocked");try{f.focus()}catch{}return new Gm(f)}function t4(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4="__/auth/handler",n4="emulator/auth/handler",i4=encodeURIComponent("fac");async function Km(e,t,r,n,i,s){xe(e.config.authDomain,e,"auth-domain-config-required"),xe(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:Ia,eventId:i};if(t instanceof Ry){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",hh(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,f]of Object.entries({}))a[u]=f}if(t instanceof Cl){const u=t.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${i4}=${encodeURIComponent(l)}`:"";return`${s4(e)}?${Aa(o).slice(1)}${c}`}function s4({config:e}){return e.emulator?Yd(e,n4):`https://${e.authDomain}/${r4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf="webStorageSupport";class a4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=My,this._completeRedirectFn=RI,this._overrideRedirectResult=AI}async _openPopup(t,r,n,i){var s;Hn((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Km(t,r,n,xh(),i);return e4(t,a,ep())}async _openRedirect(t,r,n,i){await this._originValidation(t);const s=await Km(t,r,n,xh(),i);return cI(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Hn(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await XI(t),n=new DI(t);return r.register("authEvent",i=>(xe(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(tf,{type:tf},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[tf];a!==void 0&&r(!!a),rn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=bI(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return Cy()||yy()||Qd()}}const o4=a4;var Xm="@firebase/auth",Ym="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){xe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function u4(e){pa(new ls("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;xe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ay(e)},c=new FA(n,i,s,l);return BA(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),pa(new ls("auth-internal",t=>{const r=Fa(t.getProvider("auth").getImmediate());return(n=>new l4(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ti(Xm,Ym,c4(e)),Ti(Xm,Ym,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=5*60,h4=ey("authIdTokenMaxAge")||f4;let qm=null;const d4=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>h4)return;const i=r==null?void 0:r.token;qm!==i&&(qm=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function zy(e=oy()){const t=Gd(e,"auth");if(t.isInitialized())return t.getImmediate();const r=bA(e,{popupRedirectResolver:o4,persistence:[xI,aI,My]}),n=ey("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=d4(s.toString());tI(r,a,()=>a(r.currentUser)),eI(r,o=>a(o))}}const i=J_("auth");return i&&UA(r,`http://${i}`),r}function p4(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}RA({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=i=>{const s=dn("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",p4().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});u4("Browser");var m4="firebase",g4="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ti(m4,g4,"app");var Qm={};const Jm="@firebase/database",Zm="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jy="";function v4(e){jy=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),xt(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:Jo(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return gn(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new x4(t)}}catch{}return new _4},Qi=$y("localStorage"),y4=$y("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=new jd("@firebase/database"),E4=function(){let e=1;return function(){return e++}}(),Gy=function(e){const t=qS(e),r=new GS;r.update(t);const n=r.digest();return Hd.encodeByteArray(n)},Il=function(...e){let t="";for(let r=0;r<e.length;r++){const n=e[r];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?t+=Il.apply(null,n):typeof n=="object"?t+=xt(n):t+=n,t+=" "}return t};let Eo=null,eg=!0;const w4=function(e,t){re(!t,"Can't turn on custom loggers persistently."),ta.logLevel=be.VERBOSE,Eo=ta.log.bind(ta)},Rt=function(...e){if(eg===!0&&(eg=!1,Eo===null&&y4.get("logging_enabled")===!0&&w4()),Eo){const t=Il.apply(null,e);Eo(t)}},Fl=function(e){return function(...t){Rt(e,...t)}},Eh=function(...e){const t="FIREBASE INTERNAL ERROR: "+Il(...e);ta.error(t)},Vn=function(...e){const t=`FIREBASE FATAL ERROR: ${Il(...e)}`;throw ta.error(t),new Error(t)},tr=function(...e){const t="FIREBASE WARNING: "+Il(...e);ta.warn(t)},T4=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&tr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},rp=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},k4=function(e){if(document.readyState==="complete")e();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},ga="[MIN_NAME]",us="[MAX_NAME]",_s=function(e,t){if(e===t)return 0;if(e===ga||t===us)return-1;if(t===ga||e===us)return 1;{const r=tg(e),n=tg(t);return r!==null?n!==null?r-n===0?e.length-t.length:r-n:-1:n!==null?1:e<t?-1:1}},S4=function(e,t){return e===t?0:e<t?-1:1},qa=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+xt(t))},np=function(e){if(typeof e!="object"||e===null)return xt(e);const t=[];for(const n in e)t.push(n);t.sort();let r="{";for(let n=0;n<t.length;n++)n!==0&&(r+=","),r+=xt(t[n]),r+=":",r+=np(e[t[n]]);return r+="}",r},Ky=function(e,t){const r=e.length;if(r<=t)return[e];const n=[];for(let i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n};function Lt(e,t){for(const r in e)e.hasOwnProperty(r)&&t(r,e[r])}const Xy=function(e){re(!rp(e),"Invalid JSON number");const t=11,r=52,n=(1<<t-1)-1;let i,s,a,o,l;e===0?(s=0,a=0,i=1/e===-1/0?1:0):(i=e<0,e=Math.abs(e),e>=Math.pow(2,1-n)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),n),s=o+n,a=Math.round(e*Math.pow(2,r-o)-Math.pow(2,r))):(s=0,a=Math.round(e/Math.pow(2,1-n-r))));const c=[];for(l=r;l;l-=1)c.push(a%2?1:0),a=Math.floor(a/2);for(l=t;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const u=c.join("");let f="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},C4=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},A4=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function I4(e,t){let r="Unknown Error";e==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?r="Client doesn't have permission to access the desired data.":e==="unavailable"&&(r="The service is unavailable");const n=new Error(e+" at "+t._path.toString()+": "+r);return n.code=e.toUpperCase(),n}const F4=new RegExp("^-?(0*)\\d{1,10}$"),R4=-2147483648,N4=2147483647,tg=function(e){if(F4.test(e)){const t=Number(e);if(t>=R4&&t<=N4)return t}return null},Na=function(e){try{e()}catch(t){setTimeout(()=>{const r=t.stack||"";throw tr("Exception was thrown by user callback.",r),t},Math.floor(0))}},D4=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},wo=function(e,t){const r=setTimeout(e,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(t,r){this.appName_=t,this.appCheckProvider=r,this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(n=>this.appCheck=n)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((r,n)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,n):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)===null||r===void 0||r.get().then(n=>n.addTokenListener(t))}notifyForInvalidToken(){tr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(t,r,n){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(Rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,n)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,n):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',tr(t)}}class Dc{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Dc.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip="5",Yy="v",qy="s",Qy="r",Jy="f",Zy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,eE="ls",tE="p",wh="ac",rE="websocket",nE="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(t,r,n,i,s=!1,a="",o=!1,l=!1){this.secure=r,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=l,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Qi.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Qi.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function L4(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function sE(e,t,r){re(typeof t=="string","typeof type must == string"),re(typeof r=="object","typeof params must == object");let n;if(t===rE)n=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===nE)n=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);L4(e)&&(r.ns=e.namespace);const i=[];return Lt(r,(s,a)=>{i.push(s+"="+a)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(){this.counters_={}}incrementCounter(t,r=1){gn(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return IS(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf={},nf={};function sp(e){const t=e.toString();return rf[t]||(rf[t]=new M4),rf[t]}function b4(e,t){const r=e.toString();return nf[r]||(nf[r]=t()),nf[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&Na(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg="start",U4="close",W4="pLPCommand",H4="pRTLPCB",aE="id",oE="pw",lE="ser",V4="cb",z4="seg",j4="ts",$4="d",G4="dframe",cE=1870,uE=30,K4=cE-uE,X4=25e3,Y4=3e4;class js{constructor(t,r,n,i,s,a,o){this.connId=t,this.repoInfo=r,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Fl(t),this.stats_=sp(r),this.urlFn=l=>(this.appCheckToken&&(l[wh]=this.appCheckToken),sE(r,nE,l))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new B4(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Y4)),k4(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ap((...s)=>{const[a,o,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===rg)this.id=o,this.password=l;else if(a===U4)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...s)=>{const[a,o]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const n={};n[rg]="t",n[lE]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[V4]=this.scriptTagHolder.uniqueCallbackIdentifier),n[Yy]=ip,this.transportSessionId&&(n[qy]=this.transportSessionId),this.lastSessionId&&(n[eE]=this.lastSessionId),this.applicationId&&(n[tE]=this.applicationId),this.appCheckToken&&(n[wh]=this.appCheckToken),typeof location<"u"&&location.hostname&&Zy.test(location.hostname)&&(n[Qy]=Jy);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){js.forceAllow_=!0}static forceDisallow(){js.forceDisallow_=!0}static isAvailable(){return js.forceAllow_?!0:!js.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!C4()&&!A4()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=xt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=q_(r),i=Ky(n,K4);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const n={};n[G4]="t",n[aE]=t,n[oE]=r,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=xt(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class ap{constructor(t,r,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=E4(),window[W4+this.uniqueCallbackIdentifier]=t,window[H4+this.uniqueCallbackIdentifier]=r,this.myIFrame=ap.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){Rt("frame writing exception"),o.stack&&Rt(o.stack),Rt(o)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Rt("No IE domain setting required")}catch{const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[aE]=this.myID,t[oE]=this.myPW,t[lE]=this.currentSerial;let r=this.urlFn(t),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+uE+n.length<=cE;){const a=this.pendingSegs.shift();n=n+"&"+z4+i+"="+a.seg+"&"+j4+i+"="+a.ts+"&"+$4+i+"="+a.d,i++}return r=r+n,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,n){this.pendingSegs.push({seg:t,ts:r,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const n=()=>{this.outstandingRequests.delete(r),this.newRequest_()},i=setTimeout(n,Math.floor(X4)),s=()=>{clearTimeout(i),n()};this.addTag(t,s)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())},n.onerror=()=>{Rt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=16384,Q4=45e3;let du=null;typeof MozWebSocket<"u"?du=MozWebSocket:typeof WebSocket<"u"&&(du=WebSocket);class Gr{constructor(t,r,n,i,s,a,o){this.connId=t,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Fl(this.connId),this.stats_=sp(r),this.connURL=Gr.connectionURL_(r,a,o,i,n),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,n,i,s){const a={};return a[Yy]=ip,typeof location<"u"&&location.hostname&&Zy.test(location.hostname)&&(a[Qy]=Jy),r&&(a[qy]=r),n&&(a[eE]=n),i&&(a[wh]=i),s&&(a[tE]=s),sE(t,rE,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Qi.set("previous_websocket_failure",!0);try{let n;ry(),this.mySock=new du(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Gr.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(r);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&du!==null&&!Gr.forceDisallow_}static previouslyFailed(){return Qi.isInMemoryStorage||Qi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Qi.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const n=Jo(r);this.onMessage(n)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(re(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const n=this.extractFrameCount_(r);n!==null&&this.appendFrame_(n)}}send(t){this.resetKeepAlive();const r=xt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=Ky(r,q4);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Q4))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Gr.responsesRequiredToBeHealthy=2;Gr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[js,Gr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Gr&&Gr.isAvailable();let n=r&&!Gr.previouslyFailed();if(t.webSocketOnly&&(r||tr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Gr];else{const i=this.transports_=[];for(const s of rl.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);rl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}rl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4=6e4,Z4=5e3,eF=10*1024,tF=100*1024,sf="t",ng="d",rF="s",ig="r",nF="e",sg="o",ag="a",og="n",lg="p",iF="h";class sF{constructor(t,r,n,i,s,a,o,l,c,u){this.id=t,this.repoInfo_=r,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Fl("c:"+this.id+":"),this.transportManager_=new rl(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,n)},Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=wo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>tF?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>eF?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(sf in t){const r=t[sf];r===ag?this.upgradeIfSecondaryHealthy_():r===ig?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===sg&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=qa("t",t),n=qa("d",t);if(r==="c")this.onSecondaryControl_(n);else if(r==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:lg,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ag,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:og,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=qa("t",t),n=qa("d",t);r==="c"?this.onControl_(n):r==="d"&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=qa(sf,t);if(ng in t){const n=t[ng];if(r===iF){const i=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(r===og){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===rF?this.onConnectionShutdown_(n):r===ig?this.onReset_(n):r===nF?Eh("Server Error: "+n):r===sg?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Eh("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),ip!==n&&tr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),wo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(J4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):wo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Z4))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:lg,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Qi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{put(t,r,n,i){}merge(t,r,n,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,n){}onDisconnectMerge(t,r,n){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(t){this.allowedEvents_=t,this.listeners_={},re(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,r)}}on(t,r,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:n});const i=this.getInitialEvent(t);i&&r.apply(n,i)}off(t,r,n){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let s=0;s<i.length;s++)if(i[s].callback===r&&(!n||n===i[s].context)){i.splice(s,1);return}}validateEventType_(t){re(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu extends hE{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!zd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new pu}getInitialEvent(t){return re(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=32,ug=768;class Be{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function Le(){return new Be("")}function Te(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Ri(e){return e.pieces_.length-e.pieceNum_}function He(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Be(e.pieces_,t)}function op(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function aF(e){let t="";for(let r=e.pieceNum_;r<e.pieces_.length;r++)e.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[r])));return t||"/"}function nl(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function dE(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let r=e.pieceNum_;r<e.pieces_.length-1;r++)t.push(e.pieces_[r]);return new Be(t,0)}function rt(e,t){const r=[];for(let n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);if(t instanceof Be)for(let n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{const n=t.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&r.push(n[i])}return new Be(r,0)}function Ce(e){return e.pieceNum_>=e.pieces_.length}function Jt(e,t){const r=Te(e),n=Te(t);if(r===null)return t;if(r===n)return Jt(He(e),He(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function oF(e,t){const r=nl(e,0),n=nl(t,0);for(let i=0;i<r.length&&i<n.length;i++){const s=_s(r[i],n[i]);if(s!==0)return s}return r.length===n.length?0:r.length<n.length?-1:1}function lp(e,t){if(Ri(e)!==Ri(t))return!1;for(let r=e.pieceNum_,n=t.pieceNum_;r<=e.pieces_.length;r++,n++)if(e.pieces_[r]!==t.pieces_[n])return!1;return!0}function Or(e,t){let r=e.pieceNum_,n=t.pieceNum_;if(Ri(e)>Ri(t))return!1;for(;r<e.pieces_.length;){if(e.pieces_[r]!==t.pieces_[n])return!1;++r,++n}return!0}class lF{constructor(t,r){this.errorPrefix_=r,this.parts_=nl(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=t0(this.parts_[n]);pE(this)}}function cF(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=t0(t),pE(e)}function uF(e){const t=e.parts_.pop();e.byteLength_-=t0(t),e.parts_.length>0&&(e.byteLength_-=1)}function pE(e){if(e.byteLength_>ug)throw new Error(e.errorPrefix_+"has a key path longer than "+ug+" bytes ("+e.byteLength_+").");if(e.parts_.length>cg)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+cg+") or object contains a cycle "+Gi(e))}function Gi(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp extends hE{constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const n=!document[t];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}static getInstance(){return new cp}getInitialEvent(t){return re(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=1e3,fF=60*5*1e3,fg=30*1e3,hF=1.3,dF=3e4,pF="server_kill",hg=3;class On extends fE{constructor(t,r,n,i,s,a,o,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=l,this.id=On.nextPersistentConnectionId_++,this.log_=Fl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Qa,this.maxReconnectDelay_=fF,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ry())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");cp.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&pu.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,n){const i=++this.requestNumber_,s={r:i,a:t,b:r};this.log_(xt(s)),re(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[i]=n)}get(t){this.initConnection_();const r=new Tl,i={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?r.resolve(o):r.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,n,i){this.initConnection_();const s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),re(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),re(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:r,query:t,tag:n};this.listens.get(a).set(s,o),this.connected_&&this.sendListen_(o)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})}sendListen_(t){const r=t.query,n=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,o=>{const l=o.d,c=o.s;On.warnOnListenWarnings_(l,r),(this.listens.get(n)&&this.listens.get(n).get(i))===t&&(this.log_("listen response",o),c!=="ok"&&this.removeListen_(n,i),t.onComplete&&t.onComplete(c,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&gn(t,"w")){const n=da(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();tr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||$S(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=fg)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=jS(t)?"auth":"gauth",n={cred:t};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(r,n,i=>{const s=i.s,a=i.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,n=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,n)})}unlisten(t,r){const n=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),re(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t._queryObject,r)}sendUnlisten_(t,r,n,i){this.log_("Unlisten on "+t+" for "+r);const s={p:t},a="n";i&&(s.q=n,s.t=i),this.sendRequest(a,s)}onDisconnectPut(t,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:n})}onDisconnectMerge(t,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:n})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,n,i){const s={p:r,d:n};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(t,r,n,i){this.putInternal("p",t,r,n,i)}merge(t,r,n,i){this.putInternal("m",t,r,n,i)}putInternal(t,r,n,i,s){this.initConnection_();const a={p:r,d:n};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,n,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,n=>{if(n.s!=="ok"){const s=n.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+xt(t));const r=t.r,n=this.requestCBHash_[r];n&&(delete this.requestCBHash_[r],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Eh("Unrecognized action received from server: "+xt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){re(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Qa,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Qa,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>dF&&(this.reconnectDelay_=Qa),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=new Date().getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*hF)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+On.nextConnectionId_++,s=this.lastSessionId;let a=!1,o=null;const l=function(){o?o.close():(a=!0,n())},c=function(f){re(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);a?Rt("getToken() completed but was canceled"):(Rt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,o=new sF(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,n,d=>{tr(d+" ("+this.repoInfo_.toString()+")"),this.interrupt(pF)},s))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&tr(f),l())}}}interrupt(t){Rt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Rt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],hh(this.interruptReasons_)&&(this.reconnectDelay_=Qa,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let n;r?n=r.map(s=>np(s)).join("$"):n="default";const i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,r){const n=new Be(t).toString();let i;if(this.listens.has(n)){const s=this.listens.get(n);i=s.get(r),s.delete(r),s.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(t,r){Rt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=hg&&(this.reconnectDelay_=fg,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Rt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=hg&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+jy.replace(/\./g,"-")]=1,zd()?t["framework.cordova"]=1:ty()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=pu.getInstance().currentlyOnline();return hh(this.interruptReasons_)&&t}}On.nextPersistentConnectionId_=0;On.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new ke(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const n=new ke(ga,t),i=new ke(ga,r);return this.compare(n,i)!==0}minPost(){return ke.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sc;class mE extends a0{static get __EMPTY_NODE(){return sc}static set __EMPTY_NODE(t){sc=t}compare(t,r){return _s(t.name,r.name)}isDefinedOn(t){throw Ca("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return ke.MIN}maxPost(){return new ke(us,sc)}makePost(t,r){return re(typeof t=="string","KeyIndex indexValue must always be a string."),new ke(t,sc)}toString(){return".key"}}const ra=new mE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(t,r,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!t.isEmpty();)if(t=t,a=r?n(t.key,r):1,i&&(a*=-1),a<0)this.isReverse_?t=t.left:t=t.right;else if(a===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class St{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??St.RED,this.left=i??fr.EMPTY_NODE,this.right=s??fr.EMPTY_NODE}copy(t,r,n,i,s){return new St(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return fr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let n,i;if(n=this,r(t,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,r),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),r(t,n.key)===0){if(n.right.isEmpty())return fr.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,r))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}St.RED=!0;St.BLACK=!1;class mF{copy(t,r,n,i,s){return this}insert(t,r,n){return new St(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class fr{constructor(t,r=fr.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new fr(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,St.BLACK,null,null))}remove(t){return new fr(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,St.BLACK,null,null))}get(t){let r,n=this.root_;for(;!n.isEmpty();){if(r=this.comparator_(t,n.key),r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}getPredecessorKey(t){let r,n=this.root_,i=null;for(;!n.isEmpty();)if(r=this.comparator_(t,n.key),r===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else r<0?n=n.left:r>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new ac(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new ac(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new ac(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new ac(this.root_,null,this.comparator_,!0,t)}}fr.EMPTY_NODE=new mF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(e,t){return _s(e.name,t.name)}function up(e,t){return _s(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Th;function vF(e){Th=e}const gE=function(e){return typeof e=="number"?"number:"+Xy(e):"string:"+e},vE=function(e){if(e.isLeafNode()){const t=e.val();re(typeof t=="string"||typeof t=="number"||typeof t=="object"&&gn(t,".sv"),"Priority must be a string or number.")}else re(e===Th||e.isEmpty(),"priority of unexpected type.");re(e===Th||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dg;class wt{constructor(t,r=wt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,re(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),vE(this.priorityNode_)}static set __childrenNodeConstructor(t){dg=t}static get __childrenNodeConstructor(){return dg}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new wt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:wt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ce(t)?this:Te(t)===".priority"?this.priorityNode_:wt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:wt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const n=Te(t);return n===null?r:r.isEmpty()&&n!==".priority"?this:(re(n!==".priority"||Ri(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,wt.__childrenNodeConstructor.EMPTY_NODE.updateChild(He(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+gE(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=Xy(this.value_):t+=this.value_,this.lazyHash_=Gy(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===wt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof wt.__childrenNodeConstructor?-1:(re(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,n=typeof this.value_,i=wt.VALUE_TYPE_ORDER.indexOf(r),s=wt.VALUE_TYPE_ORDER.indexOf(n);return re(i>=0,"Unknown leaf type: "+r),re(s>=0,"Unknown leaf type: "+n),i===s?n==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}wt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xE,_E;function xF(e){xE=e}function _F(e){_E=e}class yF extends a0{compare(t,r){const n=t.node.getPriority(),i=r.node.getPriority(),s=n.compareTo(i);return s===0?_s(t.name,r.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return ke.MIN}maxPost(){return new ke(us,new wt("[PRIORITY-POST]",_E))}makePost(t,r){const n=xE(t);return new ke(r,new wt("[PRIORITY-POST]",n))}toString(){return".priority"}}const nt=new yF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF=Math.log(2);class wF{constructor(t){const r=s=>parseInt(Math.log(s)/EF,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const i=n(this.count);this.bits_=t+1&i}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const mu=function(e,t,r,n){e.sort(t);const i=function(l,c){const u=c-l;let f,h;if(u===0)return null;if(u===1)return f=e[l],h=r?r(f):f,new St(h,f.node,St.BLACK,null,null);{const d=parseInt(u/2,10)+l,p=i(l,d),m=i(d+1,c);return f=e[d],h=r?r(f):f,new St(h,f.node,St.BLACK,p,m)}},s=function(l){let c=null,u=null,f=e.length;const h=function(p,m){const _=f-p,v=f;f-=p;const x=i(_+1,v),g=e[_],S=r?r(g):g;d(new St(S,g.node,m,null,x))},d=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){const m=l.nextBitIsOne(),_=Math.pow(2,l.count-(p+1));m?h(_,St.BLACK):(h(_,St.BLACK),h(_,St.RED))}return u},a=new wF(e.length),o=s(a);return new fr(n||t,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let af;const Is={};class Rn{constructor(t,r){this.indexes_=t,this.indexSet_=r}static get Default(){return re(Is&&nt,"ChildrenNode.ts has not been loaded"),af=af||new Rn({".priority":Is},{".priority":nt}),af}get(t){const r=da(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof fr?r:null}hasIndex(t){return gn(this.indexSet_,t.toString())}addIndex(t,r){re(t!==ra,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const s=r.getIterator(ke.Wrap);let a=s.getNext();for(;a;)i=i||t.isDefinedOn(a.node),n.push(a),a=s.getNext();let o;i?o=mu(n,t.getCompare()):o=Is;const l=t.toString(),c=Object.assign({},this.indexSet_);c[l]=t;const u=Object.assign({},this.indexes_);return u[l]=o,new Rn(u,c)}addToIndexes(t,r){const n=su(this.indexes_,(i,s)=>{const a=da(this.indexSet_,s);if(re(a,"Missing index implementation for "+s),i===Is)if(a.isDefinedOn(t.node)){const o=[],l=r.getIterator(ke.Wrap);let c=l.getNext();for(;c;)c.name!==t.name&&o.push(c),c=l.getNext();return o.push(t),mu(o,a.getCompare())}else return Is;else{const o=r.get(t.name);let l=i;return o&&(l=l.remove(new ke(t.name,o))),l.insert(t,t.node)}});return new Rn(n,this.indexSet_)}removeFromIndexes(t,r){const n=su(this.indexes_,i=>{if(i===Is)return i;{const s=r.get(t.name);return s?i.remove(new ke(t.name,s)):i}});return new Rn(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ja;class ge{constructor(t,r,n){this.children_=t,this.priorityNode_=r,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&vE(this.priorityNode_),this.children_.isEmpty()&&re(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ja||(Ja=new ge(new fr(up),null,Rn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ja}updatePriority(t){return this.children_.isEmpty()?this:new ge(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?Ja:r}}getChild(t){const r=Te(t);return r===null?this:this.getImmediateChild(r).getChild(He(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(re(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const n=new ke(t,r);let i,s;r.isEmpty()?(i=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(n,this.children_));const a=i.isEmpty()?Ja:this.priorityNode_;return new ge(i,a,s)}}updateChild(t,r){const n=Te(t);if(n===null)return r;{re(Te(t)!==".priority"||Ri(t)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(He(t),r);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let n=0,i=0,s=!0;if(this.forEachChild(nt,(a,o)=>{r[a]=o.val(t),n++,s&&ge.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):s=!1}),!t&&s&&i<2*n){const a=[];for(const o in r)a[o]=r[o];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+gE(this.getPriority().val())+":"),this.forEachChild(nt,(r,n)=>{const i=n.hash();i!==""&&(t+=":"+r+":"+i)}),this.lazyHash_=t===""?"":Gy(t)}return this.lazyHash_}getPredecessorChildName(t,r,n){const i=this.resolveIndex_(n);if(i){const s=i.getPredecessorKey(new ke(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const n=r.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new ke(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const n=r.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new ke(r,this.children_.get(r)):null}forEachChild(t,r){const n=this.resolveIndex_(t);return n?n.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const n=this.resolveIndex_(r);if(n)return n.getIteratorFrom(t,i=>i);{const i=this.children_.getIteratorFrom(t.name,ke.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,t)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const n=this.resolveIndex_(r);if(n)return n.getReverseIteratorFrom(t,i=>i);{const i=this.children_.getReverseIteratorFrom(t.name,ke.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,t)>0;)i.getNext(),s=i.peek();return i}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Rl?-1:0}withIndex(t){if(t===ra||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new ge(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ra||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const n=this.getIterator(nt),i=r.getIterator(nt);let s=n.getNext(),a=i.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=n.getNext(),a=i.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ra?null:this.indexMap_.get(t.toString())}}ge.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class TF extends ge{constructor(){super(new fr(up),ge.EMPTY_NODE,Rn.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ge.EMPTY_NODE}isEmpty(){return!1}}const Rl=new TF;Object.defineProperties(ke,{MIN:{value:new ke(ga,ge.EMPTY_NODE)},MAX:{value:new ke(us,Rl)}});mE.__EMPTY_NODE=ge.EMPTY_NODE;wt.__childrenNodeConstructor=ge;vF(Rl);_F(Rl);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF=!0;function vt(e,t=null){if(e===null)return ge.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),re(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const r=e;return new wt(r,vt(t))}if(!(e instanceof Array)&&kF){const r=[];let n=!1;if(Lt(e,(a,o)=>{if(a.substring(0,1)!=="."){const l=vt(o);l.isEmpty()||(n=n||!l.getPriority().isEmpty(),r.push(new ke(a,l)))}}),r.length===0)return ge.EMPTY_NODE;const s=mu(r,gF,a=>a.name,up);if(n){const a=mu(r,nt.getCompare());return new ge(s,vt(t),new Rn({".priority":a},{".priority":nt}))}else return new ge(s,vt(t),Rn.Default)}else{let r=ge.EMPTY_NODE;return Lt(e,(n,i)=>{if(gn(e,n)&&n.substring(0,1)!=="."){const s=vt(i);(s.isLeafNode()||!s.isEmpty())&&(r=r.updateImmediateChild(n,s))}}),r.updatePriority(vt(t))}}xF(vt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF extends a0{constructor(t){super(),this.indexPath_=t,re(!Ce(t)&&Te(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const n=this.extractChild(t.node),i=this.extractChild(r.node),s=n.compareTo(i);return s===0?_s(t.name,r.name):s}makePost(t,r){const n=vt(t),i=ge.EMPTY_NODE.updateChild(this.indexPath_,n);return new ke(r,i)}maxPost(){const t=ge.EMPTY_NODE.updateChild(this.indexPath_,Rl);return new ke(us,t)}toString(){return nl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF extends a0{compare(t,r){const n=t.node.compareTo(r.node);return n===0?_s(t.name,r.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return ke.MIN}maxPost(){return ke.MAX}makePost(t,r){const n=vt(t);return new ke(r,n)}toString(){return".value"}}const AF=new CF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yE(e){return{type:"value",snapshotNode:e}}function va(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function il(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function sl(e,t,r){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:r}}function IF(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(t){this.index_=t}updateChild(t,r,n,i,s,a){re(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=t.getImmediateChild(r);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()||(a!=null&&(n.isEmpty()?t.hasChild(r)?a.trackChildChange(il(r,o)):re(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(va(r,n)):a.trackChildChange(sl(r,n,o))),t.isLeafNode()&&n.isEmpty())?t:t.updateImmediateChild(r,n).withIndex(this.index_)}updateFullNode(t,r,n){return n!=null&&(t.isLeafNode()||t.forEachChild(nt,(i,s)=>{r.hasChild(i)||n.trackChildChange(il(i,s))}),r.isLeafNode()||r.forEachChild(nt,(i,s)=>{if(t.hasChild(i)){const a=t.getImmediateChild(i);a.equals(s)||n.trackChildChange(sl(i,s,a))}else n.trackChildChange(va(i,s))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?ge.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(t){this.indexedFilter_=new fp(t.getIndex()),this.index_=t.getIndex(),this.startPost_=al.getStartPost_(t),this.endPost_=al.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&n}updateChild(t,r,n,i,s,a){return this.matches(new ke(r,n))||(n=ge.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,n,i,s,a)}updateFullNode(t,r,n){r.isLeafNode()&&(r=ge.EMPTY_NODE);let i=r.withIndex(this.index_);i=i.updatePriority(ge.EMPTY_NODE);const s=this;return r.forEachChild(nt,(a,o)=>{s.matches(new ke(a,o))||(i=i.updateImmediateChild(a,ge.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,n)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=r=>{const n=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new al(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,n,i,s,a){return this.rangedFilter_.matches(new ke(r,n))||(n=ge.EMPTY_NODE),t.getImmediateChild(r).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,n,i,s,a):this.fullLimitUpdateChild_(t,r,n,s,a)}updateFullNode(t,r,n){let i;if(r.isLeafNode()||r.isEmpty())i=ge.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){i=ge.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;s.hasNext()&&a<this.limit_;){const o=s.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{i=r.withIndex(this.index_),i=i.updatePriority(ge.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let a=0;for(;s.hasNext();){const o=s.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:i=i.updateImmediateChild(o.name,ge.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,n,i,s){let a;if(this.reverse_){const f=this.index_.getCompare();a=(h,d)=>f(d,h)}else a=this.index_.getCompare();const o=t;re(o.numChildren()===this.limit_,"");const l=new ke(r,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(o.hasChild(r)){const f=o.getImmediateChild(r);let h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===r||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const d=h==null?1:a(h,l);if(u&&!n.isEmpty()&&d>=0)return s!=null&&s.trackChildChange(sl(r,n,f)),o.updateImmediateChild(r,n);{s!=null&&s.trackChildChange(il(r,f));const m=o.updateImmediateChild(r,ge.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s!=null&&s.trackChildChange(va(h.name,h.node)),m.updateImmediateChild(h.name,h.node)):m}}else return n.isEmpty()?t:u&&a(c,l)>=0?(s!=null&&(s.trackChildChange(il(c.name,c.node)),s.trackChildChange(va(r,n))),o.updateImmediateChild(r,n).updateImmediateChild(c.name,ge.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=nt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return re(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return re(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ga}hasEnd(){return this.endSet_}getIndexEndValue(){return re(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return re(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:us}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return re(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===nt}copy(){const t=new hp;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function RF(e){return e.loadsAllData()?new fp(e.getIndex()):e.hasLimit()?new FF(e):new al(e)}function pg(e){const t={};if(e.isDefault())return t;let r;if(e.index_===nt?r="$priority":e.index_===AF?r="$value":e.index_===ra?r="$key":(re(e.index_ instanceof SF,"Unrecognized index type!"),r=e.index_.toString()),t.orderBy=xt(r),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=xt(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+xt(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=xt(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+xt(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function mg(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let r=e.viewFrom_;r===""&&(e.isViewFromLeft()?r="l":r="r"),t.vf=r}return e.index_!==nt&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu extends fE{constructor(t,r,n,i){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Fl("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(re(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,r,n,i){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const a=gu.getListenId_(t,n),o={};this.listens_[a]=o;const l=pg(t._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let f=u;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(s,f,!1,n),da(this.listens_,a)===o){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(t,r){const n=gu.getListenId_(t,r);delete this.listens_[n]}get(t){const r=pg(t._queryParams),n=t._path.toString(),i=new Tl;return this.restRequest_(n+".json",r,(s,a)=>{let o=a;s===404&&(o=null,s=null),s===null?(this.onDataUpdate_(n,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(t){}restRequest_(t,r={},n){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(r.auth=i.accessToken),s&&s.token&&(r.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+Aa(r);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let l=null;if(o.status>=200&&o.status<300){try{l=Jo(o.responseText)}catch{tr("Failed to parse JSON response for "+a+": "+o.responseText)}n(null,l)}else o.status!==401&&o.status!==404&&tr("Got unsuccessful REST response for "+a+" Status: "+o.status),n(o.status);n=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(){this.rootNode_=ge.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(){return{value:null,children:new Map}}function EE(e,t,r){if(Ce(t))e.value=r,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,r);else{const n=Te(t);e.children.has(n)||e.children.set(n,vu());const i=e.children.get(n);t=He(t),EE(i,t,r)}}function kh(e,t,r){e.value!==null?r(t,e.value):DF(e,(n,i)=>{const s=new Be(t.toString()+"/"+n);kh(i,s,r)})}function DF(e,t){e.children.forEach((r,n)=>{t(n,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r=Object.assign({},t);return this.last_&&Lt(this.last_,(n,i)=>{r[n]=r[n]-i}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg=10*1e3,PF=30*1e3,LF=5*60*1e3;class MF{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new OF(t);const n=gg+(PF-gg)*Math.random();wo(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),r={};let n=!1;Lt(t,(i,s)=>{s>0&&gn(this.statsToReport_,i)&&(r[i]=s,n=!0)}),n&&this.server_.reportStats(r),wo(this.reportStats_.bind(this),Math.floor(Math.random()*2*LF))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xr;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Xr||(Xr={}));function dp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function pp(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function mp(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(t,r,n){this.path=t,this.affectedTree=r,this.revert=n,this.type=Xr.ACK_USER_WRITE,this.source=dp()}operationForChild(t){if(Ce(this.path)){if(this.affectedTree.value!=null)return re(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Be(t));return new xu(Le(),r,this.revert)}}else return re(Te(this.path)===t,"operationForChild called for unrelated child."),new xu(He(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(t,r){this.source=t,this.path=r,this.type=Xr.LISTEN_COMPLETE}operationForChild(t){return Ce(this.path)?new ol(this.source,Le()):new ol(this.source,He(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(t,r,n){this.source=t,this.path=r,this.snap=n,this.type=Xr.OVERWRITE}operationForChild(t){return Ce(this.path)?new fs(this.source,Le(),this.snap.getImmediateChild(t)):new fs(this.source,He(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(t,r,n){this.source=t,this.path=r,this.children=n,this.type=Xr.MERGE}operationForChild(t){if(Ce(this.path)){const r=this.children.subtree(new Be(t));return r.isEmpty()?null:r.value?new fs(this.source,Le(),r.value):new xa(this.source,Le(),r)}else return re(Te(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new xa(this.source,He(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(t,r,n){this.node_=t,this.fullyInitialized_=r,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ce(t))return this.isFullyInitialized()&&!this.filtered_;const r=Te(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function BF(e,t,r,n){const i=[],s=[];return t.forEach(a=>{a.type==="child_changed"&&e.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(IF(a.childName,a.snapshotNode))}),Za(e,i,"child_removed",t,n,r),Za(e,i,"child_added",t,n,r),Za(e,i,"child_moved",s,n,r),Za(e,i,"child_changed",t,n,r),Za(e,i,"value",t,n,r),i}function Za(e,t,r,n,i,s){const a=n.filter(o=>o.type===r);a.sort((o,l)=>WF(e,o,l)),a.forEach(o=>{const l=UF(e,o,s);i.forEach(c=>{c.respondsTo(o.type)&&t.push(c.createEvent(l,e.query_))})})}function UF(e,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function WF(e,t,r){if(t.childName==null||r.childName==null)throw Ca("Should only compare child_ events.");const n=new ke(t.childName,t.snapshotNode),i=new ke(r.childName,r.snapshotNode);return e.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(e,t){return{eventCache:e,serverCache:t}}function To(e,t,r,n){return o0(new Ni(t,r,n),e.serverCache)}function wE(e,t,r,n){return o0(e.eventCache,new Ni(t,r,n))}function _u(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function hs(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let of;const HF=()=>(of||(of=new fr(S4)),of);class We{constructor(t,r=HF()){this.value=t,this.children=r}static fromObject(t){let r=new We(null);return Lt(t,(n,i)=>{r=r.set(new Be(n),i)}),r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:Le(),value:this.value};if(Ce(t))return null;{const n=Te(t),i=this.children.get(n);if(i!==null){const s=i.findRootMostMatchingPathAndValue(He(t),r);return s!=null?{path:rt(new Be(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ce(t))return this;{const r=Te(t),n=this.children.get(r);return n!==null?n.subtree(He(t)):new We(null)}}set(t,r){if(Ce(t))return new We(r,this.children);{const n=Te(t),s=(this.children.get(n)||new We(null)).set(He(t),r),a=this.children.insert(n,s);return new We(this.value,a)}}remove(t){if(Ce(t))return this.children.isEmpty()?new We(null):new We(null,this.children);{const r=Te(t),n=this.children.get(r);if(n){const i=n.remove(He(t));let s;return i.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,i),this.value===null&&s.isEmpty()?new We(null):new We(this.value,s)}else return this}}get(t){if(Ce(t))return this.value;{const r=Te(t),n=this.children.get(r);return n?n.get(He(t)):null}}setTree(t,r){if(Ce(t))return r;{const n=Te(t),s=(this.children.get(n)||new We(null)).setTree(He(t),r);let a;return s.isEmpty()?a=this.children.remove(n):a=this.children.insert(n,s),new We(this.value,a)}}fold(t){return this.fold_(Le(),t)}fold_(t,r){const n={};return this.children.inorderTraversal((i,s)=>{n[i]=s.fold_(rt(t,i),r)}),r(t,this.value,n)}findOnPath(t,r){return this.findOnPath_(t,Le(),r)}findOnPath_(t,r,n){const i=this.value?n(r,this.value):!1;if(i)return i;if(Ce(t))return null;{const s=Te(t),a=this.children.get(s);return a?a.findOnPath_(He(t),rt(r,s),n):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,Le(),r)}foreachOnPath_(t,r,n){if(Ce(t))return this;{this.value&&n(r,this.value);const i=Te(t),s=this.children.get(i);return s?s.foreachOnPath_(He(t),rt(r,i),n):new We(null)}}foreach(t){this.foreach_(Le(),t)}foreach_(t,r){this.children.inorderTraversal((n,i)=>{i.foreach_(rt(t,n),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,n)=>{n.value&&t(r,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(t){this.writeTree_=t}static empty(){return new Zr(new We(null))}}function ko(e,t,r){if(Ce(t))return new Zr(new We(r));{const n=e.writeTree_.findRootMostValueAndPath(t);if(n!=null){const i=n.path;let s=n.value;const a=Jt(i,t);return s=s.updateChild(a,r),new Zr(e.writeTree_.set(i,s))}else{const i=new We(r),s=e.writeTree_.setTree(t,i);return new Zr(s)}}}function Sh(e,t,r){let n=e;return Lt(r,(i,s)=>{n=ko(n,rt(t,i),s)}),n}function vg(e,t){if(Ce(t))return Zr.empty();{const r=e.writeTree_.setTree(t,new We(null));return new Zr(r)}}function Ch(e,t){return ys(e,t)!=null}function ys(e,t){const r=e.writeTree_.findRootMostValueAndPath(t);return r!=null?e.writeTree_.get(r.path).getChild(Jt(r.path,t)):null}function xg(e){const t=[],r=e.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(nt,(n,i)=>{t.push(new ke(n,i))}):e.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&t.push(new ke(n,i.value))}),t}function Si(e,t){if(Ce(t))return e;{const r=ys(e,t);return r!=null?new Zr(new We(r)):new Zr(e.writeTree_.subtree(t))}}function Ah(e){return e.writeTree_.isEmpty()}function _a(e,t){return TE(Le(),e.writeTree_,t)}function TE(e,t,r){if(t.value!=null)return r.updateChild(e,t.value);{let n=null;return t.children.inorderTraversal((i,s)=>{i===".priority"?(re(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):r=TE(rt(e,i),s,r)}),!r.getChild(e).isEmpty()&&n!==null&&(r=r.updateChild(rt(e,".priority"),n)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(e,t){return AE(t,e)}function VF(e,t,r,n,i){re(n>e.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),e.allWrites.push({path:t,snap:r,writeId:n,visible:i}),i&&(e.visibleWrites=ko(e.visibleWrites,t,r)),e.lastWriteId=n}function zF(e,t,r,n){re(n>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:r,writeId:n,visible:!0}),e.visibleWrites=Sh(e.visibleWrites,t,r),e.lastWriteId=n}function jF(e,t){for(let r=0;r<e.allWrites.length;r++){const n=e.allWrites[r];if(n.writeId===t)return n}return null}function $F(e,t){const r=e.allWrites.findIndex(o=>o.writeId===t);re(r>=0,"removeWrite called with nonexistent writeId.");const n=e.allWrites[r];e.allWrites.splice(r,1);let i=n.visible,s=!1,a=e.allWrites.length-1;for(;i&&a>=0;){const o=e.allWrites[a];o.visible&&(a>=r&&GF(o,n.path)?i=!1:Or(n.path,o.path)&&(s=!0)),a--}if(i){if(s)return KF(e),!0;if(n.snap)e.visibleWrites=vg(e.visibleWrites,n.path);else{const o=n.children;Lt(o,l=>{e.visibleWrites=vg(e.visibleWrites,rt(n.path,l))})}return!0}else return!1}function GF(e,t){if(e.snap)return Or(e.path,t);for(const r in e.children)if(e.children.hasOwnProperty(r)&&Or(rt(e.path,r),t))return!0;return!1}function KF(e){e.visibleWrites=kE(e.allWrites,XF,Le()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function XF(e){return e.visible}function kE(e,t,r){let n=Zr.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const a=s.path;let o;if(s.snap)Or(r,a)?(o=Jt(r,a),n=ko(n,o,s.snap)):Or(a,r)&&(o=Jt(a,r),n=ko(n,Le(),s.snap.getChild(o)));else if(s.children){if(Or(r,a))o=Jt(r,a),n=Sh(n,o,s.children);else if(Or(a,r))if(o=Jt(a,r),Ce(o))n=Sh(n,Le(),s.children);else{const l=da(s.children,Te(o));if(l){const c=l.getChild(He(o));n=ko(n,Le(),c)}}}else throw Ca("WriteRecord should have .snap or .children")}}return n}function SE(e,t,r,n,i){if(!n&&!i){const s=ys(e.visibleWrites,t);if(s!=null)return s;{const a=Si(e.visibleWrites,t);if(Ah(a))return r;if(r==null&&!Ch(a,Le()))return null;{const o=r||ge.EMPTY_NODE;return _a(a,o)}}}else{const s=Si(e.visibleWrites,t);if(!i&&Ah(s))return r;if(!i&&r==null&&!Ch(s,Le()))return null;{const a=function(c){return(c.visible||i)&&(!n||!~n.indexOf(c.writeId))&&(Or(c.path,t)||Or(t,c.path))},o=kE(e.allWrites,a,t),l=r||ge.EMPTY_NODE;return _a(o,l)}}}function YF(e,t,r){let n=ge.EMPTY_NODE;const i=ys(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(nt,(s,a)=>{n=n.updateImmediateChild(s,a)}),n;if(r){const s=Si(e.visibleWrites,t);return r.forEachChild(nt,(a,o)=>{const l=_a(Si(s,new Be(a)),o);n=n.updateImmediateChild(a,l)}),xg(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}else{const s=Si(e.visibleWrites,t);return xg(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}}function qF(e,t,r,n,i){re(n||i,"Either existingEventSnap or existingServerSnap must exist");const s=rt(t,r);if(Ch(e.visibleWrites,s))return null;{const a=Si(e.visibleWrites,s);return Ah(a)?i.getChild(r):_a(a,i.getChild(r))}}function QF(e,t,r,n){const i=rt(t,r),s=ys(e.visibleWrites,i);if(s!=null)return s;if(n.isCompleteForChild(r)){const a=Si(e.visibleWrites,i);return _a(a,n.getNode().getImmediateChild(r))}else return null}function JF(e,t){return ys(e.visibleWrites,t)}function ZF(e,t,r,n,i,s,a){let o;const l=Si(e.visibleWrites,t),c=ys(l,Le());if(c!=null)o=c;else if(r!=null)o=_a(l,r);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const u=[],f=a.getCompare(),h=s?o.getReverseIteratorFrom(n,a):o.getIteratorFrom(n,a);let d=h.getNext();for(;d&&u.length<i;)f(d,n)!==0&&u.push(d),d=h.getNext();return u}else return[]}function eR(){return{visibleWrites:Zr.empty(),allWrites:[],lastWriteId:-1}}function yu(e,t,r,n){return SE(e.writeTree,e.treePath,t,r,n)}function gp(e,t){return YF(e.writeTree,e.treePath,t)}function _g(e,t,r,n){return qF(e.writeTree,e.treePath,t,r,n)}function Eu(e,t){return JF(e.writeTree,rt(e.treePath,t))}function tR(e,t,r,n,i,s){return ZF(e.writeTree,e.treePath,t,r,n,i,s)}function vp(e,t,r){return QF(e.writeTree,e.treePath,t,r)}function CE(e,t){return AE(rt(e.treePath,t),e.writeTree)}function AE(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,n=t.childName;re(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),re(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const s=i.type;if(r==="child_added"&&s==="child_removed")this.changeMap.set(n,sl(n,t.snapshotNode,i.snapshotNode));else if(r==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(r==="child_removed"&&s==="child_changed")this.changeMap.set(n,il(n,i.oldSnap));else if(r==="child_changed"&&s==="child_added")this.changeMap.set(n,va(n,t.snapshotNode));else if(r==="child_changed"&&s==="child_changed")this.changeMap.set(n,sl(n,t.snapshotNode,i.oldSnap));else throw Ca("Illegal combination of changes: "+t+" occurred after "+i)}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{getCompleteChild(t){return null}getChildAfterChild(t,r,n){return null}}const IE=new nR;class xp{constructor(t,r,n=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=n}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const n=this.optCompleteServerCache_!=null?new Ni(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return vp(this.writes_,t,n)}}getChildAfterChild(t,r,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:hs(this.viewCache_),s=tR(this.writes_,i,r,1,n,t);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(e){return{filter:e}}function sR(e,t){re(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),re(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function aR(e,t,r,n,i){const s=new rR;let a,o;if(r.type===Xr.OVERWRITE){const c=r;c.source.fromUser?a=Ih(e,t,c.path,c.snap,n,i,s):(re(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered()&&!Ce(c.path),a=wu(e,t,c.path,c.snap,n,i,o,s))}else if(r.type===Xr.MERGE){const c=r;c.source.fromUser?a=lR(e,t,c.path,c.children,n,i,s):(re(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=Fh(e,t,c.path,c.children,n,i,o,s))}else if(r.type===Xr.ACK_USER_WRITE){const c=r;c.revert?a=fR(e,t,c.path,n,i,s):a=cR(e,t,c.path,c.affectedTree,n,i,s)}else if(r.type===Xr.LISTEN_COMPLETE)a=uR(e,t,r.path,n,s);else throw Ca("Unknown operation type: "+r.type);const l=s.getChanges();return oR(t,a,l),{viewCache:a,changes:l}}function oR(e,t,r){const n=t.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=_u(e);(r.length>0||!e.eventCache.isFullyInitialized()||i&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&r.push(yE(_u(t)))}}function FE(e,t,r,n,i,s){const a=t.eventCache;if(Eu(n,r)!=null)return t;{let o,l;if(Ce(r))if(re(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const c=hs(t),u=c instanceof ge?c:ge.EMPTY_NODE,f=gp(n,u);o=e.filter.updateFullNode(t.eventCache.getNode(),f,s)}else{const c=yu(n,hs(t));o=e.filter.updateFullNode(t.eventCache.getNode(),c,s)}else{const c=Te(r);if(c===".priority"){re(Ri(r)===1,"Can't have a priority with additional path components");const u=a.getNode();l=t.serverCache.getNode();const f=_g(n,r,u,l);f!=null?o=e.filter.updatePriority(u,f):o=a.getNode()}else{const u=He(r);let f;if(a.isCompleteForChild(c)){l=t.serverCache.getNode();const h=_g(n,r,a.getNode(),l);h!=null?f=a.getNode().getImmediateChild(c).updateChild(u,h):f=a.getNode().getImmediateChild(c)}else f=vp(n,c,t.serverCache);f!=null?o=e.filter.updateChild(a.getNode(),c,f,u,i,s):o=a.getNode()}}return To(t,o,a.isFullyInitialized()||Ce(r),e.filter.filtersNodes())}}function wu(e,t,r,n,i,s,a,o){const l=t.serverCache;let c;const u=a?e.filter:e.filter.getIndexedFilter();if(Ce(r))c=u.updateFullNode(l.getNode(),n,null);else if(u.filtersNodes()&&!l.isFiltered()){const d=l.getNode().updateChild(r,n);c=u.updateFullNode(l.getNode(),d,null)}else{const d=Te(r);if(!l.isCompleteForPath(r)&&Ri(r)>1)return t;const p=He(r),_=l.getNode().getImmediateChild(d).updateChild(p,n);d===".priority"?c=u.updatePriority(l.getNode(),_):c=u.updateChild(l.getNode(),d,_,p,IE,null)}const f=wE(t,c,l.isFullyInitialized()||Ce(r),u.filtersNodes()),h=new xp(i,f,s);return FE(e,f,r,i,h,o)}function Ih(e,t,r,n,i,s,a){const o=t.eventCache;let l,c;const u=new xp(i,t,s);if(Ce(r))c=e.filter.updateFullNode(t.eventCache.getNode(),n,a),l=To(t,c,!0,e.filter.filtersNodes());else{const f=Te(r);if(f===".priority")c=e.filter.updatePriority(t.eventCache.getNode(),n),l=To(t,c,o.isFullyInitialized(),o.isFiltered());else{const h=He(r),d=o.getNode().getImmediateChild(f);let p;if(Ce(h))p=n;else{const m=u.getCompleteChild(f);m!=null?op(h)===".priority"&&m.getChild(dE(h)).isEmpty()?p=m:p=m.updateChild(h,n):p=ge.EMPTY_NODE}if(d.equals(p))l=t;else{const m=e.filter.updateChild(o.getNode(),f,p,h,u,a);l=To(t,m,o.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function yg(e,t){return e.eventCache.isCompleteForChild(t)}function lR(e,t,r,n,i,s,a){let o=t;return n.foreach((l,c)=>{const u=rt(r,l);yg(t,Te(u))&&(o=Ih(e,o,u,c,i,s,a))}),n.foreach((l,c)=>{const u=rt(r,l);yg(t,Te(u))||(o=Ih(e,o,u,c,i,s,a))}),o}function Eg(e,t,r){return r.foreach((n,i)=>{t=t.updateChild(n,i)}),t}function Fh(e,t,r,n,i,s,a,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l=t,c;Ce(r)?c=n:c=new We(null).setTree(r,n);const u=t.serverCache.getNode();return c.children.inorderTraversal((f,h)=>{if(u.hasChild(f)){const d=t.serverCache.getNode().getImmediateChild(f),p=Eg(e,d,h);l=wu(e,l,new Be(f),p,i,s,a,o)}}),c.children.inorderTraversal((f,h)=>{const d=!t.serverCache.isCompleteForChild(f)&&h.value===null;if(!u.hasChild(f)&&!d){const p=t.serverCache.getNode().getImmediateChild(f),m=Eg(e,p,h);l=wu(e,l,new Be(f),m,i,s,a,o)}}),l}function cR(e,t,r,n,i,s,a){if(Eu(i,r)!=null)return t;const o=t.serverCache.isFiltered(),l=t.serverCache;if(n.value!=null){if(Ce(r)&&l.isFullyInitialized()||l.isCompleteForPath(r))return wu(e,t,r,l.getNode().getChild(r),i,s,o,a);if(Ce(r)){let c=new We(null);return l.getNode().forEachChild(ra,(u,f)=>{c=c.set(new Be(u),f)}),Fh(e,t,r,c,i,s,o,a)}else return t}else{let c=new We(null);return n.foreach((u,f)=>{const h=rt(r,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),Fh(e,t,r,c,i,s,o,a)}}function uR(e,t,r,n,i){const s=t.serverCache,a=wE(t,s.getNode(),s.isFullyInitialized()||Ce(r),s.isFiltered());return FE(e,a,r,n,IE,i)}function fR(e,t,r,n,i,s){let a;if(Eu(n,r)!=null)return t;{const o=new xp(n,t,i),l=t.eventCache.getNode();let c;if(Ce(r)||Te(r)===".priority"){let u;if(t.serverCache.isFullyInitialized())u=yu(n,hs(t));else{const f=t.serverCache.getNode();re(f instanceof ge,"serverChildren would be complete if leaf node"),u=gp(n,f)}u=u,c=e.filter.updateFullNode(l,u,s)}else{const u=Te(r);let f=vp(n,u,t.serverCache);f==null&&t.serverCache.isCompleteForChild(u)&&(f=l.getImmediateChild(u)),f!=null?c=e.filter.updateChild(l,u,f,He(r),o,s):t.eventCache.getNode().hasChild(u)?c=e.filter.updateChild(l,u,ge.EMPTY_NODE,He(r),o,s):c=l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=yu(n,hs(t)),a.isLeafNode()&&(c=e.filter.updateFullNode(c,a,s)))}return a=t.serverCache.isFullyInitialized()||Eu(n,Le())!=null,To(t,c,a,e.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new fp(n.getIndex()),s=RF(n);this.processor_=iR(s);const a=r.serverCache,o=r.eventCache,l=i.updateFullNode(ge.EMPTY_NODE,a.getNode(),null),c=s.updateFullNode(ge.EMPTY_NODE,o.getNode(),null),u=new Ni(l,a.isFullyInitialized(),i.filtersNodes()),f=new Ni(c,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=o0(f,u),this.eventGenerator_=new bF(this.query_)}get query(){return this.query_}}function dR(e){return e.viewCache_.serverCache.getNode()}function pR(e){return _u(e.viewCache_)}function mR(e,t){const r=hs(e.viewCache_);return r&&(e.query._queryParams.loadsAllData()||!Ce(t)&&!r.getImmediateChild(Te(t)).isEmpty())?r.getChild(t):null}function wg(e){return e.eventRegistrations_.length===0}function gR(e,t){e.eventRegistrations_.push(t)}function Tg(e,t,r){const n=[];if(r){re(t==null,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach(s=>{const a=s.createCancelEvent(r,i);a&&n.push(a)})}if(t){let i=[];for(let s=0;s<e.eventRegistrations_.length;++s){const a=e.eventRegistrations_[s];if(!a.matches(t))i.push(a);else if(t.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(s+1));break}}e.eventRegistrations_=i}else e.eventRegistrations_=[];return n}function kg(e,t,r,n){t.type===Xr.MERGE&&t.source.queryId!==null&&(re(hs(e.viewCache_),"We should always have a full cache before handling merges"),re(_u(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=aR(e.processor_,i,t,r,n);return sR(e.processor_,s.viewCache),re(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,RE(e,s.changes,s.viewCache.eventCache.getNode(),null)}function vR(e,t){const r=e.viewCache_.eventCache,n=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(nt,(s,a)=>{n.push(va(s,a))}),r.isFullyInitialized()&&n.push(yE(r.getNode())),RE(e,n,r.getNode(),t)}function RE(e,t,r,n){const i=n?[n]:e.eventRegistrations_;return BF(e.eventGenerator_,t,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tu;class NE{constructor(){this.views=new Map}}function xR(e){re(!Tu,"__referenceConstructor has already been defined"),Tu=e}function _R(){return re(Tu,"Reference.ts has not been loaded"),Tu}function yR(e){return e.views.size===0}function _p(e,t,r,n){const i=t.source.queryId;if(i!==null){const s=e.views.get(i);return re(s!=null,"SyncTree gave us an op for an invalid query."),kg(s,t,r,n)}else{let s=[];for(const a of e.views.values())s=s.concat(kg(a,t,r,n));return s}}function DE(e,t,r,n,i){const s=t._queryIdentifier,a=e.views.get(s);if(!a){let o=yu(r,i?n:null),l=!1;o?l=!0:n instanceof ge?(o=gp(r,n),l=!1):(o=ge.EMPTY_NODE,l=!1);const c=o0(new Ni(o,l,!1),new Ni(n,i,!1));return new hR(t,c)}return a}function ER(e,t,r,n,i,s){const a=DE(e,t,n,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),gR(a,r),vR(a,r)}function wR(e,t,r,n){const i=t._queryIdentifier,s=[];let a=[];const o=Di(e);if(i==="default")for(const[l,c]of e.views.entries())a=a.concat(Tg(c,r,n)),wg(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=e.views.get(i);l&&(a=a.concat(Tg(l,r,n)),wg(l)&&(e.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return o&&!Di(e)&&s.push(new(_R())(t._repo,t._path)),{removed:s,events:a}}function OE(e){const t=[];for(const r of e.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function Ci(e,t){let r=null;for(const n of e.views.values())r=r||mR(n,t);return r}function PE(e,t){if(t._queryParams.loadsAllData())return c0(e);{const n=t._queryIdentifier;return e.views.get(n)}}function LE(e,t){return PE(e,t)!=null}function Di(e){return c0(e)!=null}function c0(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ku;function TR(e){re(!ku,"__referenceConstructor has already been defined"),ku=e}function kR(){return re(ku,"Reference.ts has not been loaded"),ku}let SR=1;class Sg{constructor(t){this.listenProvider_=t,this.syncPointTree_=new We(null),this.pendingWriteTree_=eR(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ME(e,t,r,n,i){return VF(e.pendingWriteTree_,t,r,n,i),i?Da(e,new fs(dp(),t,r)):[]}function CR(e,t,r,n){zF(e.pendingWriteTree_,t,r,n);const i=We.fromObject(r);return Da(e,new xa(dp(),t,i))}function ui(e,t,r=!1){const n=jF(e.pendingWriteTree_,t);if($F(e.pendingWriteTree_,t)){let s=new We(null);return n.snap!=null?s=s.set(Le(),!0):Lt(n.children,a=>{s=s.set(new Be(a),!0)}),Da(e,new xu(n.path,s,r))}else return[]}function Nl(e,t,r){return Da(e,new fs(pp(),t,r))}function AR(e,t,r){const n=We.fromObject(r);return Da(e,new xa(pp(),t,n))}function IR(e,t){return Da(e,new ol(pp(),t))}function FR(e,t,r){const n=Ep(e,r);if(n){const i=wp(n),s=i.path,a=i.queryId,o=Jt(s,t),l=new ol(mp(a),o);return Tp(e,s,l)}else return[]}function Su(e,t,r,n,i=!1){const s=t._path,a=e.syncPointTree_.get(s);let o=[];if(a&&(t._queryIdentifier==="default"||LE(a,t))){const l=wR(a,t,r,n);yR(a)&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(o=l.events,!i){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=e.syncPointTree_.findOnPath(s,(h,d)=>Di(d));if(u&&!f){const h=e.syncPointTree_.subtree(s);if(!h.isEmpty()){const d=DR(h);for(let p=0;p<d.length;++p){const m=d[p],_=m.query,v=WE(e,m);e.listenProvider_.startListening(So(_),ll(e,_),v.hashFn,v.onComplete)}}}!f&&c.length>0&&!n&&(u?e.listenProvider_.stopListening(So(t),null):c.forEach(h=>{const d=e.queryToTagMap.get(u0(h));e.listenProvider_.stopListening(So(h),d)}))}OR(e,c)}return o}function bE(e,t,r,n){const i=Ep(e,n);if(i!=null){const s=wp(i),a=s.path,o=s.queryId,l=Jt(a,t),c=new fs(mp(o),l,r);return Tp(e,a,c)}else return[]}function RR(e,t,r,n){const i=Ep(e,n);if(i){const s=wp(i),a=s.path,o=s.queryId,l=Jt(a,t),c=We.fromObject(r),u=new xa(mp(o),l,c);return Tp(e,a,u)}else return[]}function Rh(e,t,r,n=!1){const i=t._path;let s=null,a=!1;e.syncPointTree_.foreachOnPath(i,(h,d)=>{const p=Jt(h,i);s=s||Ci(d,p),a=a||Di(d)});let o=e.syncPointTree_.get(i);o?(a=a||Di(o),s=s||Ci(o,Le())):(o=new NE,e.syncPointTree_=e.syncPointTree_.set(i,o));let l;s!=null?l=!0:(l=!1,s=ge.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((d,p)=>{const m=Ci(p,Le());m&&(s=s.updateImmediateChild(d,m))}));const c=LE(o,t);if(!c&&!t._queryParams.loadsAllData()){const h=u0(t);re(!e.queryToTagMap.has(h),"View does not exist, but we have a tag");const d=PR();e.queryToTagMap.set(h,d),e.tagToQueryMap.set(d,h)}const u=l0(e.pendingWriteTree_,i);let f=ER(o,t,r,u,s,l);if(!c&&!a&&!n){const h=PE(o,t);f=f.concat(LR(e,t,h))}return f}function yp(e,t,r){const i=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(a,o)=>{const l=Jt(a,t),c=Ci(o,l);if(c)return c});return SE(i,t,s,r,!0)}function NR(e,t){const r=t._path;let n=null;e.syncPointTree_.foreachOnPath(r,(c,u)=>{const f=Jt(c,r);n=n||Ci(u,f)});let i=e.syncPointTree_.get(r);i?n=n||Ci(i,Le()):(i=new NE,e.syncPointTree_=e.syncPointTree_.set(r,i));const s=n!=null,a=s?new Ni(n,!0,!1):null,o=l0(e.pendingWriteTree_,t._path),l=DE(i,t,o,s?a.getNode():ge.EMPTY_NODE,s);return pR(l)}function Da(e,t){return BE(t,e.syncPointTree_,null,l0(e.pendingWriteTree_,Le()))}function BE(e,t,r,n){if(Ce(e.path))return UE(e,t,r,n);{const i=t.get(Le());r==null&&i!=null&&(r=Ci(i,Le()));let s=[];const a=Te(e.path),o=e.operationForChild(a),l=t.children.get(a);if(l&&o){const c=r?r.getImmediateChild(a):null,u=CE(n,a);s=s.concat(BE(o,l,c,u))}return i&&(s=s.concat(_p(i,e,n,r))),s}}function UE(e,t,r,n){const i=t.get(Le());r==null&&i!=null&&(r=Ci(i,Le()));let s=[];return t.children.inorderTraversal((a,o)=>{const l=r?r.getImmediateChild(a):null,c=CE(n,a),u=e.operationForChild(a);u&&(s=s.concat(UE(u,o,l,c)))}),i&&(s=s.concat(_p(i,e,n,r))),s}function WE(e,t){const r=t.query,n=ll(e,r);return{hashFn:()=>(dR(t)||ge.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?FR(e,r._path,n):IR(e,r._path);{const s=I4(i,r);return Su(e,r,null,s)}}}}function ll(e,t){const r=u0(t);return e.queryToTagMap.get(r)}function u0(e){return e._path.toString()+"$"+e._queryIdentifier}function Ep(e,t){return e.tagToQueryMap.get(t)}function wp(e){const t=e.indexOf("$");return re(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Be(e.substr(0,t))}}function Tp(e,t,r){const n=e.syncPointTree_.get(t);re(n,"Missing sync point for query tag that we're tracking");const i=l0(e.pendingWriteTree_,t);return _p(n,r,i,null)}function DR(e){return e.fold((t,r,n)=>{if(r&&Di(r))return[c0(r)];{let i=[];return r&&(i=OE(r)),Lt(n,(s,a)=>{i=i.concat(a)}),i}})}function So(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(kR())(e._repo,e._path):e}function OR(e,t){for(let r=0;r<t.length;++r){const n=t[r];if(!n._queryParams.loadsAllData()){const i=u0(n),s=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(s)}}}function PR(){return SR++}function LR(e,t,r){const n=t._path,i=ll(e,t),s=WE(e,r),a=e.listenProvider_.startListening(So(t),i,s.hashFn,s.onComplete),o=e.syncPointTree_.subtree(n);if(i)re(!Di(o.value),"If we're adding a query, it shouldn't be shadowed");else{const l=o.fold((c,u,f)=>{if(!Ce(c)&&u&&Di(u))return[c0(u).query];{let h=[];return u&&(h=h.concat(OE(u).map(d=>d.query))),Lt(f,(d,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){const u=l[c];e.listenProvider_.stopListening(So(u),ll(e,u))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new kp(r)}node(){return this.node_}}class Sp{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=rt(this.path_,t);return new Sp(this.syncTree_,r)}node(){return yp(this.syncTree_,this.path_)}}const MR=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},Cg=function(e,t,r){if(!e||typeof e!="object")return e;if(re(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return bR(e[".sv"],t,r);if(typeof e[".sv"]=="object")return BR(e[".sv"],t);re(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},bR=function(e,t,r){switch(e){case"timestamp":return r.timestamp;default:re(!1,"Unexpected server value: "+e)}},BR=function(e,t,r){e.hasOwnProperty("increment")||re(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const n=e.increment;typeof n!="number"&&re(!1,"Unexpected increment value: "+n);const i=t.node();if(re(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const a=i.getValue();return typeof a!="number"?n:a+n},HE=function(e,t,r,n){return Cp(t,new Sp(r,e),n)},VE=function(e,t,r){return Cp(e,new kp(t),r)};function Cp(e,t,r){const n=e.getPriority().val(),i=Cg(n,t.getImmediateChild(".priority"),r);let s;if(e.isLeafNode()){const a=e,o=Cg(a.getValue(),t,r);return o!==a.getValue()||i!==a.getPriority().val()?new wt(o,vt(i)):e}else{const a=e;return s=a,i!==a.getPriority().val()&&(s=s.updatePriority(new wt(i))),a.forEachChild(nt,(o,l)=>{const c=Cp(l,t.getImmediateChild(o),r);c!==l&&(s=s.updateImmediateChild(o,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(t="",r=null,n={children:{},childCount:0}){this.name=t,this.parent=r,this.node=n}}function Ip(e,t){let r=t instanceof Be?t:new Be(t),n=e,i=Te(r);for(;i!==null;){const s=da(n.node.children,i)||{children:{},childCount:0};n=new Ap(i,n,s),r=He(r),i=Te(r)}return n}function Oa(e){return e.node.value}function zE(e,t){e.node.value=t,Nh(e)}function jE(e){return e.node.childCount>0}function UR(e){return Oa(e)===void 0&&!jE(e)}function f0(e,t){Lt(e.node.children,(r,n)=>{t(new Ap(r,e,n))})}function $E(e,t,r,n){r&&!n&&t(e),f0(e,i=>{$E(i,t,!0,n)}),r&&n&&t(e)}function WR(e,t,r){let n=e.parent;for(;n!==null;){if(t(n))return!0;n=n.parent}return!1}function Dl(e){return new Be(e.parent===null?e.name:Dl(e.parent)+"/"+e.name)}function Nh(e){e.parent!==null&&HR(e.parent,e.name,e)}function HR(e,t,r){const n=UR(r),i=gn(e.node.children,t);n&&i?(delete e.node.children[t],e.node.childCount--,Nh(e)):!n&&!i&&(e.node.children[t]=r.node,e.node.childCount++,Nh(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR=/[\[\].#$\/\u0000-\u001F\u007F]/,zR=/[\[\].#$\u0000-\u001F\u007F]/,lf=10*1024*1024,Fp=function(e){return typeof e=="string"&&e.length!==0&&!VR.test(e)},GE=function(e){return typeof e=="string"&&e.length!==0&&!zR.test(e)},jR=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),GE(e)},$R=function(e){return e===null||typeof e=="string"||typeof e=="number"&&!rp(e)||e&&typeof e=="object"&&gn(e,".sv")},GR=function(e,t,r,n){h0(e0(e,"value"),t,r)},h0=function(e,t,r){const n=r instanceof Be?new lF(r,e):r;if(t===void 0)throw new Error(e+"contains undefined "+Gi(n));if(typeof t=="function")throw new Error(e+"contains a function "+Gi(n)+" with contents = "+t.toString());if(rp(t))throw new Error(e+"contains "+t.toString()+" "+Gi(n));if(typeof t=="string"&&t.length>lf/3&&t0(t)>lf)throw new Error(e+"contains a string greater than "+lf+" utf8 bytes "+Gi(n)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let i=!1,s=!1;if(Lt(t,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(s=!0,!Fp(a)))throw new Error(e+" contains an invalid key ("+a+") "+Gi(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);cF(n,a),h0(e,o,n),uF(n)}),i&&s)throw new Error(e+' contains ".value" child '+Gi(n)+" in addition to actual children.")}},KR=function(e,t){let r,n;for(r=0;r<t.length;r++){n=t[r];const s=nl(n);for(let a=0;a<s.length;a++)if(!(s[a]===".priority"&&a===s.length-1)){if(!Fp(s[a]))throw new Error(e+"contains an invalid key ("+s[a]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}t.sort(oF);let i=null;for(r=0;r<t.length;r++){if(n=t[r],i!==null&&Or(i,n))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+n.toString());i=n}},XR=function(e,t,r,n){const i=e0(e,"values");if(!(t&&typeof t=="object")||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Lt(t,(a,o)=>{const l=new Be(a);if(h0(i,o,rt(r,l)),op(l)===".priority"&&!$R(o))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),KR(i,s)},KE=function(e,t,r,n){if(!GE(r))throw new Error(e0(e,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},YR=function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),KE(e,t,r)},qR=function(e,t){if(Te(t)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},QR=function(e,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!Fp(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!jR(r))throw new Error(e0(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function d0(e,t){let r=null;for(let n=0;n<t.length;n++){const i=t[n],s=i.getPath();r!==null&&!lp(s,r.path)&&(e.eventLists_.push(r),r=null),r===null&&(r={events:[],path:s}),r.events.push(i)}r&&e.eventLists_.push(r)}function XE(e,t,r){d0(e,r),YE(e,n=>lp(n,t))}function br(e,t,r){d0(e,r),YE(e,n=>Or(n,t)||Or(t,n))}function YE(e,t){e.recursionDepth_++;let r=!0;for(let n=0;n<e.eventLists_.length;n++){const i=e.eventLists_[n];if(i){const s=i.path;t(s)?(ZR(e.eventLists_[n]),e.eventLists_[n]=null):r=!1}}r&&(e.eventLists_=[]),e.recursionDepth_--}function ZR(e){for(let t=0;t<e.events.length;t++){const r=e.events[t];if(r!==null){e.events[t]=null;const n=r.getEventRunner();Eo&&Rt("event: "+r.toString()),Na(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN="repo_interrupt",tN=25;class rN{constructor(t,r,n,i){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new JR,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vu(),this.transactionQueueTree_=new Ap,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function nN(e,t,r){if(e.stats_=sp(e.repoInfo_),e.forceRestClient_||D4())e.server_=new gu(e.repoInfo_,(n,i,s,a)=>{Ag(e,n,i,s,a)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>Ig(e,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{xt(r)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}e.persistentConnection_=new On(e.repoInfo_,t,(n,i,s,a)=>{Ag(e,n,i,s,a)},n=>{Ig(e,n)},n=>{sN(e,n)},e.authTokenProvider_,e.appCheckProvider_,r),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(n=>{e.server_.refreshAuthToken(n)}),e.appCheckProvider_.addTokenChangeListener(n=>{e.server_.refreshAppCheckToken(n.token)}),e.statsReporter_=b4(e.repoInfo_,()=>new MF(e.stats_,e.server_)),e.infoData_=new NF,e.infoSyncTree_=new Sg({startListening:(n,i,s,a)=>{let o=[];const l=e.infoData_.getNode(n._path);return l.isEmpty()||(o=Nl(e.infoSyncTree_,n._path,l),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),Rp(e,"connected",!1),e.serverSyncTree_=new Sg({startListening:(n,i,s,a)=>(e.server_.listen(n,s,i,(o,l)=>{const c=a(o,l);br(e.eventQueue_,n._path,c)}),[]),stopListening:(n,i)=>{e.server_.unlisten(n,i)}})}function iN(e){const r=e.infoData_.getNode(new Be(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function p0(e){return MR({timestamp:iN(e)})}function Ag(e,t,r,n,i){e.dataUpdateCount++;const s=new Be(t);r=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,r):r;let a=[];if(i)if(n){const l=su(r,c=>vt(c));a=RR(e.serverSyncTree_,s,l,i)}else{const l=vt(r);a=bE(e.serverSyncTree_,s,l,i)}else if(n){const l=su(r,c=>vt(c));a=AR(e.serverSyncTree_,s,l)}else{const l=vt(r);a=Nl(e.serverSyncTree_,s,l)}let o=s;a.length>0&&(o=ya(e,s)),br(e.eventQueue_,o,a)}function Ig(e,t){Rp(e,"connected",t),t===!1&&cN(e)}function sN(e,t){Lt(t,(r,n)=>{Rp(e,r,n)})}function Rp(e,t,r){const n=new Be("/.info/"+t),i=vt(r);e.infoData_.updateSnapshot(n,i);const s=Nl(e.infoSyncTree_,n,i);br(e.eventQueue_,n,s)}function Np(e){return e.nextWriteId_++}function aN(e,t,r){const n=NR(e.serverSyncTree_,t);return n!=null?Promise.resolve(n):e.server_.get(t).then(i=>{const s=vt(i).withIndex(t._queryParams.getIndex());Rh(e.serverSyncTree_,t,r,!0);let a;if(t._queryParams.loadsAllData())a=Nl(e.serverSyncTree_,t._path,s);else{const o=ll(e.serverSyncTree_,t);a=bE(e.serverSyncTree_,t._path,s,o)}return br(e.eventQueue_,t._path,a),Su(e.serverSyncTree_,t,r,null,!0),s},i=>(Ol(e,"get for query "+xt(t)+" failed: "+i),Promise.reject(new Error(i))))}function oN(e,t,r,n,i){Ol(e,"set",{path:t.toString(),value:r,priority:n});const s=p0(e),a=vt(r,n),o=yp(e.serverSyncTree_,t),l=VE(a,o,s),c=Np(e),u=ME(e.serverSyncTree_,t,l,c,!0);d0(e.eventQueue_,u),e.server_.put(t.toString(),a.val(!0),(h,d)=>{const p=h==="ok";p||tr("set at "+t+" failed: "+h);const m=ui(e.serverSyncTree_,c,!p);br(e.eventQueue_,t,m),Dh(e,i,h,d)});const f=Op(e,t);ya(e,f),br(e.eventQueue_,f,[])}function lN(e,t,r,n){Ol(e,"update",{path:t.toString(),value:r});let i=!0;const s=p0(e),a={};if(Lt(r,(o,l)=>{i=!1,a[o]=HE(rt(t,o),vt(l),e.serverSyncTree_,s)}),i)Rt("update() called with empty data.  Don't do anything."),Dh(e,n,"ok",void 0);else{const o=Np(e),l=CR(e.serverSyncTree_,t,a,o);d0(e.eventQueue_,l),e.server_.merge(t.toString(),r,(c,u)=>{const f=c==="ok";f||tr("update at "+t+" failed: "+c);const h=ui(e.serverSyncTree_,o,!f),d=h.length>0?ya(e,t):t;br(e.eventQueue_,d,h),Dh(e,n,c,u)}),Lt(r,c=>{const u=Op(e,rt(t,c));ya(e,u)}),br(e.eventQueue_,t,[])}}function cN(e){Ol(e,"onDisconnectEvents");const t=p0(e),r=vu();kh(e.onDisconnect_,Le(),(i,s)=>{const a=HE(i,s,e.serverSyncTree_,t);EE(r,i,a)});let n=[];kh(r,Le(),(i,s)=>{n=n.concat(Nl(e.serverSyncTree_,i,s));const a=Op(e,i);ya(e,a)}),e.onDisconnect_=vu(),br(e.eventQueue_,Le(),n)}function uN(e,t,r){let n;Te(t._path)===".info"?n=Rh(e.infoSyncTree_,t,r):n=Rh(e.serverSyncTree_,t,r),XE(e.eventQueue_,t._path,n)}function fN(e,t,r){let n;Te(t._path)===".info"?n=Su(e.infoSyncTree_,t,r):n=Su(e.serverSyncTree_,t,r),XE(e.eventQueue_,t._path,n)}function hN(e){e.persistentConnection_&&e.persistentConnection_.interrupt(eN)}function Ol(e,...t){let r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),Rt(r,...t)}function Dh(e,t,r,n){t&&Na(()=>{if(r==="ok")t(null);else{const i=(r||"error").toUpperCase();let s=i;n&&(s+=": "+n);const a=new Error(s);a.code=i,t(a)}})}function qE(e,t,r){return yp(e.serverSyncTree_,t,r)||ge.EMPTY_NODE}function Dp(e,t=e.transactionQueueTree_){if(t||m0(e,t),Oa(t)){const r=JE(e,t);re(r.length>0,"Sending zero length transaction queue"),r.every(i=>i.status===0)&&dN(e,Dl(t),r)}else jE(t)&&f0(t,r=>{Dp(e,r)})}function dN(e,t,r){const n=r.map(c=>c.currentWriteId),i=qE(e,t,n);let s=i;const a=i.hash();for(let c=0;c<r.length;c++){const u=r[c];re(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const f=Jt(t,u.path);s=s.updateChild(f,u.currentOutputSnapshotRaw)}const o=s.val(!0),l=t;e.server_.put(l.toString(),o,c=>{Ol(e,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const f=[];for(let h=0;h<r.length;h++)r[h].status=2,u=u.concat(ui(e.serverSyncTree_,r[h].currentWriteId)),r[h].onComplete&&f.push(()=>r[h].onComplete(null,!0,r[h].currentOutputSnapshotResolved)),r[h].unwatcher();m0(e,Ip(e.transactionQueueTree_,t)),Dp(e,e.transactionQueueTree_),br(e.eventQueue_,t,u);for(let h=0;h<f.length;h++)Na(f[h])}else{if(c==="datastale")for(let f=0;f<r.length;f++)r[f].status===3?r[f].status=4:r[f].status=0;else{tr("transaction at "+l.toString()+" failed: "+c);for(let f=0;f<r.length;f++)r[f].status=4,r[f].abortReason=c}ya(e,t)}},a)}function ya(e,t){const r=QE(e,t),n=Dl(r),i=JE(e,r);return pN(e,i,n),n}function pN(e,t,r){if(t.length===0)return;const n=[];let i=[];const a=t.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<t.length;o++){const l=t[o],c=Jt(r,l.path);let u=!1,f;if(re(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,f=l.abortReason,i=i.concat(ui(e.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=tN)u=!0,f="maxretry",i=i.concat(ui(e.serverSyncTree_,l.currentWriteId,!0));else{const h=qE(e,l.path,a);l.currentInputSnapshot=h;const d=t[o].update(h.val());if(d!==void 0){h0("transaction failed: Data returned ",d,l.path);let p=vt(d);typeof d=="object"&&d!=null&&gn(d,".priority")||(p=p.updatePriority(h.getPriority()));const _=l.currentWriteId,v=p0(e),x=VE(p,h,v);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=x,l.currentWriteId=Np(e),a.splice(a.indexOf(_),1),i=i.concat(ME(e.serverSyncTree_,l.path,x,l.currentWriteId,l.applyLocally)),i=i.concat(ui(e.serverSyncTree_,_,!0))}else u=!0,f="nodata",i=i.concat(ui(e.serverSyncTree_,l.currentWriteId,!0))}br(e.eventQueue_,r,i),i=[],u&&(t[o].status=2,function(h){setTimeout(h,Math.floor(0))}(t[o].unwatcher),t[o].onComplete&&(f==="nodata"?n.push(()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot)):n.push(()=>t[o].onComplete(new Error(f),!1,null))))}m0(e,e.transactionQueueTree_);for(let o=0;o<n.length;o++)Na(n[o]);Dp(e,e.transactionQueueTree_)}function QE(e,t){let r,n=e.transactionQueueTree_;for(r=Te(t);r!==null&&Oa(n)===void 0;)n=Ip(n,r),t=He(t),r=Te(t);return n}function JE(e,t){const r=[];return ZE(e,t,r),r.sort((n,i)=>n.order-i.order),r}function ZE(e,t,r){const n=Oa(t);if(n)for(let i=0;i<n.length;i++)r.push(n[i]);f0(t,i=>{ZE(e,i,r)})}function m0(e,t){const r=Oa(t);if(r){let n=0;for(let i=0;i<r.length;i++)r[i].status!==2&&(r[n]=r[i],n++);r.length=n,zE(t,r.length>0?r:void 0)}f0(t,n=>{m0(e,n)})}function Op(e,t){const r=Dl(QE(e,t)),n=Ip(e.transactionQueueTree_,t);return WR(n,i=>{cf(e,i)}),cf(e,n),$E(n,i=>{cf(e,i)}),r}function cf(e,t){const r=Oa(t);if(r){const n=[];let i=[],s=-1;for(let a=0;a<r.length;a++)r[a].status===3||(r[a].status===1?(re(s===a-1,"All SENT items should be at beginning of queue."),s=a,r[a].status=3,r[a].abortReason="set"):(re(r[a].status===0,"Unexpected transaction status in abort"),r[a].unwatcher(),i=i.concat(ui(e.serverSyncTree_,r[a].currentWriteId,!0)),r[a].onComplete&&n.push(r[a].onComplete.bind(null,new Error("set"),!1,null))));s===-1?zE(t,void 0):r.length=s+1,br(e.eventQueue_,Dl(t),i);for(let a=0;a<n.length;a++)Na(n[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(e){let t="";const r=e.split("/");for(let n=0;n<r.length;n++)if(r[n].length>0){let i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}t+="/"+i}return t}function gN(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const r of e.split("&")){if(r.length===0)continue;const n=r.split("=");n.length===2?t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):tr(`Invalid query segment '${r}' in query '${e}'`)}return t}const Fg=function(e,t){const r=vN(e),n=r.namespace;r.domain==="firebase.com"&&Vn(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&r.domain!=="localhost"&&Vn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||T4();const i=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new iE(r.host,r.secure,n,i,t,"",n!==r.subdomain),path:new Be(r.pathString)}},vN=function(e){let t="",r="",n="",i="",s="",a=!0,o="https",l=443;if(typeof e=="string"){let c=e.indexOf("//");c>=0&&(o=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");u===-1&&(u=e.length);let f=e.indexOf("?");f===-1&&(f=e.length),t=e.substring(0,Math.min(u,f)),u<f&&(i=mN(e.substring(u,f)));const h=gN(e.substring(Math.min(e.length,f)));c=t.indexOf(":"),c>=0?(a=o==="https"||o==="wss",l=parseInt(t.substring(c+1),10)):c=t.length;const d=t.slice(0,c);if(d.toLowerCase()==="localhost")r="localhost";else if(d.split(".").length<=2)r=d;else{const p=t.indexOf(".");n=t.substring(0,p).toLowerCase(),r=t.substring(p+1),s=n}"ns"in h&&(s=h.ns)}return{host:t,port:l,domain:r,subdomain:n,secure:a,scheme:o,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(t,r,n,i){this.eventType=t,this.eventRegistration=r,this.snapshot=n,this.prevName=i}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+xt(this.snapshot.exportVal())}}class _N{constructor(t,r,n){this.eventRegistration=t,this.error=r,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return re(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(t,r,n,i){this._repo=t,this._path=r,this._queryParams=n,this._orderByCalled=i}get key(){return Ce(this._path)?null:op(this._path)}get ref(){return new $n(this._repo,this._path)}get _queryIdentifier(){const t=mg(this._queryParams),r=np(t);return r==="{}"?"default":r}get _queryObject(){return mg(this._queryParams)}isEqual(t){if(t=or(t),!(t instanceof Pp))return!1;const r=this._repo===t._repo,n=lp(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return r&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+aF(this._path)}}class $n extends Pp{constructor(t,r){super(t,r,new hp,!1)}get parent(){const t=dE(this._path);return t===null?null:new $n(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class cl{constructor(t,r,n){this._node=t,this.ref=r,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new Be(t),n=Oh(this.ref,t);return new cl(this._node.getChild(r),n,nt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>t(new cl(i,Oh(this.ref,n),nt)))}hasChild(t){const r=new Be(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Cu(e,t){return e=or(e),e._checkNotDeleted("ref"),t!==void 0?Oh(e._root,t):e._root}function Oh(e,t){return e=or(e),Te(e._path)===null?YR("child","path",t):KE("child","path",t),new $n(e._repo,rt(e._path,t))}function yN(e,t){e=or(e),qR("set",e._path),GR("set",t,e._path);const r=new Tl;return oN(e._repo,e._path,t,null,r.wrapCallback(()=>{})),r.promise}function EN(e,t){XR("update",t,e._path);const r=new Tl;return lN(e._repo,e._path,t,r.wrapCallback(()=>{})),r.promise}function wN(e){e=or(e);const t=new ew(()=>{}),r=new g0(t);return aN(e._repo,e,r).then(n=>new cl(n,new $n(e._repo,e._path),e._queryParams.getIndex()))}class g0{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const n=r._queryParams.getIndex();return new xN("value",this,new cl(t.snapshotNode,new $n(r._repo,r._path),n))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new _N(this,t,r):null}matches(t){return t instanceof g0?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function TN(e,t,r,n,i){const s=new ew(r,void 0),a=new g0(s);return uN(e._repo,e,a),()=>fN(e._repo,e,a)}function kN(e,t,r,n){return TN(e,"value",t)}xR($n);TR($n);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN="FIREBASE_DATABASE_EMULATOR_HOST",Ph={};let CN=!1;function AN(e,t,r,n){e.repoInfo_=new iE(`${t}:${r}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),n&&(e.authTokenProvider_=n)}function IN(e,t,r,n,i){let s=n||e.options.databaseURL;s===void 0&&(e.options.projectId||Vn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rt("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let a=Fg(s,i),o=a.repoInfo,l;typeof process<"u"&&Qm&&(l=Qm[SN]),l?(s=`http://${l}?ns=${o.namespace}`,a=Fg(s,i),o=a.repoInfo):a.repoInfo.secure;const c=new P4(e.name,e.options,t);QR("Invalid Firebase Database URL",a),Ce(a.path)||Vn("Database URL must point to the root of a Firebase Database (not including a child path).");const u=RN(o,e,c,new O4(e.name,r));return new NN(u,e)}function FN(e,t){const r=Ph[t];(!r||r[e.key]!==e)&&Vn(`Database ${t}(${e.repoInfo_}) has already been deleted.`),hN(e),delete r[e.key]}function RN(e,t,r,n){let i=Ph[t.name];i||(i={},Ph[t.name]=i);let s=i[e.toURLString()];return s&&Vn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new rN(e,CN,r,n),i[e.toURLString()]=s,s}class NN{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(nN(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new $n(this._repo,Le())),this._rootInternal}_delete(){return this._rootInternal!==null&&(FN(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Vn("Cannot call "+t+" on a deleted database.")}}function Lh(e=oy(),t){const r=Gd(e,"database").getImmediate({identifier:t});if(!r._instanceStarted){const n=PS("database");n&&DN(r,...n)}return r}function DN(e,t,r,n={}){e=or(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&Vn("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)n.mockUserToken&&Vn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Dc(Dc.OWNER);else if(n.mockUserToken){const a=typeof n.mockUserToken=="string"?n.mockUserToken:LS(n.mockUserToken,e.app.options.projectId);s=new Dc(a)}AN(i,t,r,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(e){v4(Ia),pa(new ls("database",(t,{instanceIdentifier:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return IN(n,i,s,r)},"PUBLIC").setMultipleInstances(!0)),Ti(Jm,Zm,e),Ti(Jm,Zm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN={".sv":"timestamp"};function Rg(){return PN}On.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};On.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};ON();const LN={apiKey:"AIzaSyAninm3NdURp4BNSZrVPyOrH4-gZ3v0GtM",authDomain:"sapin-de-saint-roch.firebaseapp.com",databaseURL:"https://sapin-de-saint-roch-default-rtdb.europe-west1.firebasedatabase.app",projectId:"sapin-de-saint-roch",storageBucket:"sapin-de-saint-roch.firebasestorage.app",messagingSenderId:"1076636579999",appId:"1:1076636579999:web:5359ad872bf4152791caaa"},tw=ay(LN),rw=zy(tw),Ng=Lh(tw),MN=async(e,t)=>{try{const r=await ZA(rw,e,t);return console.log("Connexion russie"),r.user}catch(r){throw console.error("Erreur de connexion:",r),r}};function bN(){const[e,t]=Ke.useState(null),[r,n]=Ke.useState(!0);return Ke.useEffect(()=>{const i=rI(rw,s=>{t(s),n(!1)});return()=>i()},[]),{user:e,loading:r}}function BN(){const[e,t]=Ke.useState(""),[r,n]=Ke.useState(""),[i,s]=Ke.useState(""),[a,o]=Ke.useState(!1),l=async c=>{c.preventDefault(),s(""),o(!0);try{await MN(e,r)}catch(u){s("Email ou mot de passe incorrect"),console.error("Erreur de connexion:",u)}finally{o(!1)}};return K.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-red-800 to-red-600",children:K.jsxs("div",{className:"max-w-md w-full space-y-8 p-8 bg-white rounded-xl shadow-2xl",children:[K.jsxs("div",{children:[K.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-red-800",children:" Les Sapins de Saint Roch"}),K.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Connectez-vous pour accder  l'application"})]}),K.jsxs("form",{className:"mt-8 space-y-6",onSubmit:l,children:[i&&K.jsx("div",{className:"rounded-md bg-red-50 p-4",children:K.jsx("p",{className:"text-sm text-red-700",children:i})}),K.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[K.jsxs("div",{children:[K.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),K.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-red-500 focus:border-red-500 focus:z-10 sm:text-sm",placeholder:"Email",value:e,onChange:c=>t(c.target.value),disabled:a})]}),K.jsxs("div",{children:[K.jsx("label",{htmlFor:"password",className:"sr-only",children:"Mot de passe"}),K.jsx("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-red-500 focus:border-red-500 focus:z-10 sm:text-sm",placeholder:"Mot de passe",value:r,onChange:c=>n(c.target.value),disabled:a})]})]}),K.jsx("div",{children:K.jsx("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 transition-colors duration-200",children:a?"Connexion...":"Se connecter"})})]})]})})}function UN({title:e,titleId:t,...r},n){return Ke.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?Ke.createElement("title",{id:t},e):null,Ke.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const WN=Ke.forwardRef(UN);function HN({searchTerm:e,onSearchChange:t}){return K.jsxs("div",{className:"relative",children:[K.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:K.jsx(WN,{className:"h-5 w-5 text-gray-400"})}),K.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-green-500 focus:border-green-500 sm:text-sm transition-colors duration-200",placeholder:"Rechercher par nom ou tlphone...",value:e,onChange:r=>t(r.target.value)})]})}function VN({sortBy:e,onSortChange:t}){return K.jsxs("select",{value:e,onChange:r=>t(r.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-lg transition-colors duration-200",children:[K.jsx("option",{value:"name",children:"Trier par nom"}),K.jsx("option",{value:"status",children:"Trier par statut"}),K.jsx("option",{value:"size",children:"Trier par taille"}),K.jsx("option",{value:"date",children:"Trier par date de livraison souhaite"}),K.jsx("option",{value:"scout",children:"Trier par livraison scout"})]})}function zN({delivery:e,onClose:t}){const r=e.history?Object.entries(e.history).map(([n,i])=>({id:n,...i})).sort((n,i)=>i.timestamp-n.timestamp):[];return K.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 overflow-y-auto",children:K.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl my-8",children:[K.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-50 w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-700 transition-colors duration-200","aria-label":"Fermer",children:""}),K.jsx("div",{className:"mt-2",children:K.jsxs("h2",{className:"text-2xl font-bold text-gray-800 pr-8",children:["Historique des modifications - ",e.customerName]})}),K.jsx("div",{className:"mt-6 max-h-[60vh] overflow-y-auto",children:r.length===0?K.jsx("p",{className:"text-gray-600",children:"Aucun historique disponible"}):K.jsx("div",{className:"space-y-4",children:r.map(n=>K.jsxs("div",{className:"border-l-4 border-green-500 pl-4 py-2",children:[K.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2",children:[K.jsxs("div",{children:[K.jsx("p",{className:"font-medium text-gray-800",children:n.action}),K.jsxs("p",{className:"text-sm text-gray-600",children:["Par: ",n.userId]})]}),K.jsx("p",{className:"text-sm text-gray-500 whitespace-nowrap",children:n.timestamp?new Date(n.timestamp).toLocaleString():"Date inconnue"})]}),K.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Statut: ",n.previousStatus?"Livr":"Non livr","  ",n.newStatus?"Livr":"Non livr"]})]},n.id))})}),K.jsx("div",{className:"mt-6 flex justify-end",children:K.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors duration-200",children:"Fermer"})})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var nw=1252,jN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Lp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Mp=function(e){jN.indexOf(e)!=-1&&(nw=Lp[0]=e)};function $N(){Mp(1252)}var Yr=function(e){Mp(e)};function iw(){Yr(1200),$N()}function Dg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function GN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function sw(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ao=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?GN(e.slice(2)):t==254&&r==255?sw(e.slice(2)):t==65279?e.slice(1):e},oc=function(t){return String.fromCharCode(t)},Og=function(t){return String.fromCharCode(t)},ai,fi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pg(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=fi.charAt(s)+fi.charAt(a)+fi.charAt(o)+fi.charAt(l);return t}function wr(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=fi.indexOf(e.charAt(c++)),a=fi.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=fi.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=fi.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Ie=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Es=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Oi(e){return Ie?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Lg(e){return Ie?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Kr=function(t){return Ie?Es(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ws(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function bp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return bp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var oi=Ie?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Es(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function KN(e){for(var t=[],r=0,n=e.length+250,i=Oi(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Oi(65535),n=65530)}return t.push(i.slice(0,r)),oi(t)}var rr=/\u0000/g,oo=/[\u0001-\u0006]/g;function na(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function qr(e,t){var r=""+e;return r.length>=t?r:tt("0",t-r.length)+r}function Bp(e,t){var r=""+e;return r.length>=t?r:tt(" ",t-r.length)+r}function Au(e,t){var r=""+e;return r.length>=t?r:r+tt(" ",t-r.length)}function XN(e,t){var r=""+Math.round(e);return r.length>=t?r:tt("0",t-r.length)+r}function YN(e,t){var r=""+e;return r.length>=t?r:tt("0",t-r.length)+r}var Mg=Math.pow(2,32);function Fs(e,t){if(e>Mg||e<-Mg)return XN(e,t);var r=Math.round(e);return YN(r,t)}function Iu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var bg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],uf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function qN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ee={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Bg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},QN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Fu(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function Ji(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=n3(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var aw=new Date(1899,11,31,0,0,0),JN=aw.getTime(),ZN=new Date(1900,2,1,0,0,0);function ow(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=ZN&&(r+=24*60*60*1e3),(r-(JN+(e.getTimezoneOffset()-aw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Up(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function e3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function t3(e){var t=e<0?12:11,r=Up(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function r3(e){var t=Up(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ul(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=t3(e):t===10?r=e.toFixed(10).substr(0,12):r=r3(e),Up(e3(r.toUpperCase()))}function ds(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ul(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Br(14,ow(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function n3(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function i3(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return uf[r.m-1][1];case 5:return uf[r.m-1][0];default:return uf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return bg[r.q][0];default:return bg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?qr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=qr(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?qr(l,c):"";return u}function hi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var lw=/%/g;function s3(e,t,r){var n=t.replace(lw,""),i=t.length-n.length;return Pn(e,n,r*Math.pow(10,2*i))+tt("%",i)}function a3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Pn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function cw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cw(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var uw=/# (\?+)( ?)\/( ?)(\d+)/;function o3(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?tt(" ",e[1].length+1+e[4].length):Bp(a,e[1].length)+e[2]+"/"+e[3]+qr(o,e[4].length))}function l3(e,t,r){return r+(t===0?"":""+t)+tt(" ",e[1].length+2+e[4].length)}var fw=/^#*0*\.([0#]+)/,hw=/\).*[0#]/,dw=/\(###\) ###\\?-####/;function qt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ug(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Wg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function c3(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function u3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ir(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ir("n",n,r):"("+Ir("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return a3(e,t,r);if(t.indexOf("%")!==-1)return s3(e,t,r);if(t.indexOf("E")!==-1)return cw(t,r);if(t.charCodeAt(0)===36)return"$"+Ir(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Fs(l,t.length);if(t.match(/^[#?]+$/))return i=Fs(r,0),i==="0"&&(i=""),i.length>t.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(uw))return o3(s,l,c);if(t.match(/^#+0+$/))return c+Fs(l,t.length-t.indexOf("0"));if(s=t.match(fw))return i=Ug(r,s[1].length).replace(/^([^\.]+)$/,"$1."+qt(s[1])).replace(/\.$/,"."+qt(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+tt("0",qt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Ug(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+hi(Fs(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ir(e,t,-r):hi(""+(Math.floor(r)+c3(r,s[1].length)))+"."+qr(Wg(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ir(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=na(Ir(e,t.replace(/[\\-]/g,""),r)),a=0,na(na(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(t.match(dw))return i=Ir(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Fu(l,Math.pow(10,a)-1,!1),i=""+c,u=Pn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Au(o[2],a),u.length<s[4].length&&(u=qt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Fu(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bp(o[1],a)+s[2]+"/"+s[3]+Au(o[2],a):tt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Fs(r,0),t.length<=i.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return qt(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Wg(r,s[1].length),r<0?"-"+Ir(e,t,-r):hi(u3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?qr(0,3-p.length):"")+p})+"."+qr(a,s[1].length);switch(t){case"###,##0.00":return Ir(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=hi(Fs(l,0));return d!=="0"?c+d:"";case"###,###.00":return Ir(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ir(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function f3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Pn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function h3(e,t,r){var n=t.replace(lw,""),i=t.length-n.length;return Pn(e,n,r*Math.pow(10,2*i))+tt("%",i)}function pw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+pw(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ln("n",n,r):"("+ln("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return f3(e,t,r);if(t.indexOf("%")!==-1)return h3(e,t,r);if(t.indexOf("E")!==-1)return pw(t,r);if(t.charCodeAt(0)===36)return"$"+ln(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+qr(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(uw))return l3(s,l,c);if(t.match(/^#+0+$/))return c+qr(l,t.length-t.indexOf("0"));if(s=t.match(fw))return i=(""+r).replace(/^([^\.]+)$/,"$1."+qt(s[1])).replace(/\.$/,"."+qt(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+tt("0",qt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+hi(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ln(e,t,-r):hi(""+r)+"."+tt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ln(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=na(ln(e,t.replace(/[\\-]/g,""),r)),a=0,na(na(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(t.match(dw))return i=ln(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Fu(l,Math.pow(10,a)-1,!1),i=""+c,u=Pn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Au(o[2],a),u.length<s[4].length&&(u=qt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Fu(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bp(o[1],a)+s[2]+"/"+s[3]+Au(o[2],a):tt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return qt(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ln(e,t,-r):hi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?qr(0,3-p.length):"")+p})+"."+qr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=hi(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return ln(e,t.slice(0,t.lastIndexOf(".")),r)+qt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Pn(e,t,r){return(r|0)===r?ln(e,t,r):Ir(e,t,r)}function d3(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pa(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Iu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mw))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function p3(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!Iu(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),p=d==="("||d===")"?d:"t";i[i.length]={t:p,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=Ji(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ji(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=Ji(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",a+=5,h="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(mw)){if(c==null&&(c=Ji(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pa(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var _=0,v=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",_<1&&(_=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",S;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=i3(i[a].t.charCodeAt(0),i[a].v,c,v),i[a].t="t";break;case"n":case"?":for(S=a+1;i[S]!=null&&((o=i[S].t)==="?"||o==="D"||(o===" "||o==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[a].v+=i[S].v,i[S]={v:"",t:";"},++S;g+=i[a].v,a=S-1;break;case"G":i[a].t="t",i[a].v=ds(t,r);break}var D="",k,E;if(g.length>0){g.charCodeAt(0)==40?(k=t<0&&g.charCodeAt(0)===45?-t:t,E=Pn("n",g,k)):(k=t<0&&n>1?-t:t,E=Pn("n",g,k),k<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),S=E.length-1;var O=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){O=a;break}var N=i.length;if(O===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(S>=i[a].v.length-1?(S-=i[a].v.length,i[a].v=E.substr(S+1,i[a].v.length)):S<0?i[a].v="":(i[a].v=E.substr(0,S+1),S=-1),i[a].t="t",N=a);S>=0&&N<i.length&&(i[N].v=E.substr(0,S+1)+i[N].v)}else if(O!==i.length&&E.indexOf("E")===-1){for(S=E.indexOf(".")-1,a=O;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(u+1);u>=0;--u)S>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(D=E.charAt(S--)+D);i[a].v=D,i[a].t="t",N=a}for(S>=0&&N<i.length&&(i[N].v=E.substr(0,S+1)+i[N].v),S=E.indexOf(".")+1,a=O;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==O)){for(u=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,u);u<i[a].v.length;++u)S<E.length&&(D+=E.charAt(S++));i[a].v=D,i[a].t="t",N=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(k=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Pn(i[a].t,i[a].v,k),i[a].t="t");var B="";for(a=0;a!==i.length;++a)i[a]!=null&&(B+=i[a].v);return B}var Hg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function m3(e,t){var r=d3(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Hg),o=r[1].match(Hg);return Vg(t,a)?[n,r[0]]:Vg(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Br(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ee)[e],n==null&&(n=r.table&&r.table[Bg[e]]||Ee[Bg[e]]),n==null&&(n=QN[e]||"General");break}if(Iu(n,0))return ds(t,r);t instanceof Date&&(t=ow(t,r.date1904));var i=m3(n,t);if(Iu(i[1]))return ds(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return p3(i[1],t,r,i[0])}function ts(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ee[r]==null){t<0&&(t=r);continue}if(Ee[r]==e){t=r;break}}t<0&&(t=391)}return Ee[t]=e,t}function gw(){Ee=qN()}var g3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function v3(e){var t=typeof e=="number"?Ee[e]:e;return t=t.replace(vw,"(\\d+)"),new RegExp("^"+t+"$")}function x3(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(vw)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var _3=function(){var e={};e.version="1.2.0";function t(){for(var E=0,O=new Array(256),N=0;N!=256;++N)E=N,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,O[N]=E;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(E){var O=0,N=0,B=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)U[B]=E[B];for(B=0;B!=256;++B)for(N=E[B],O=256+B;O<4096;O+=256)N=U[O]=N>>>8^E[N&255];var b=[];for(B=1;B!=16;++B)b[B-1]=typeof Int32Array<"u"?U.subarray(B*256,B*256+256):U.slice(B*256,B*256+256);return b}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],p=i[9],m=i[10],_=i[11],v=i[12],x=i[13],g=i[14];function S(E,O){for(var N=O^-1,B=0,U=E.length;B<U;)N=N>>>8^r[(N^E.charCodeAt(B++))&255];return~N}function D(E,O){for(var N=O^-1,B=E.length-15,U=0;U<B;)N=g[E[U++]^N&255]^x[E[U++]^N>>8&255]^v[E[U++]^N>>16&255]^_[E[U++]^N>>>24]^m[E[U++]]^p[E[U++]]^d[E[U++]]^h[E[U++]]^f[E[U++]]^u[E[U++]]^c[E[U++]]^l[E[U++]]^o[E[U++]]^a[E[U++]]^s[E[U++]]^r[E[U++]];for(B+=15;U<B;)N=N>>>8^r[(N^E[U++])&255];return~N}function k(E,O){for(var N=O^-1,B=0,U=E.length,b=0,Y=0;B<U;)b=E.charCodeAt(B++),b<128?N=N>>>8^r[(N^b)&255]:b<2048?(N=N>>>8^r[(N^(192|b>>6&31))&255],N=N>>>8^r[(N^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,Y=E.charCodeAt(B++)&1023,N=N>>>8^r[(N^(240|b>>8&7))&255],N=N>>>8^r[(N^(128|b>>2&63))&255],N=N>>>8^r[(N^(128|Y>>6&15|(b&3)<<4))&255],N=N>>>8^r[(N^(128|Y&63))&255]):(N=N>>>8^r[(N^(224|b>>12&15))&255],N=N>>>8^r[(N^(128|b>>6&63))&255],N=N>>>8^r[(N^(128|b&63))&255]);return~N}return e.table=r,e.bstr=S,e.buf=D,e.str=k,e}(),Fe=function(){var t={};t.version="1.2.1";function r(y,C){for(var w=y.split("/"),T=C.split("/"),A=0,F=0,H=Math.min(w.length,T.length);A<H;++A){if(F=w[A].length-T[A].length)return F;if(w[A]!=T[A])return w[A]<T[A]?-1:1}return w.length-T.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var C=y.lastIndexOf("/");return C===-1?y:y.slice(0,C+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var C=y.lastIndexOf("/");return C===-1?y:y.slice(C+1)}function s(y,C){typeof C=="string"&&(C=new Date(C));var w=C.getHours();w=w<<6|C.getMinutes(),w=w<<5|C.getSeconds()>>>1,y.write_shift(2,w);var T=C.getFullYear()-1980;T=T<<4|C.getMonth()+1,T=T<<5|C.getDate(),y.write_shift(2,T)}function a(y){var C=y.read_shift(2)&65535,w=y.read_shift(2)&65535,T=new Date,A=w&31;w>>>=5;var F=w&15;w>>>=4,T.setMilliseconds(0),T.setFullYear(w+1980),T.setMonth(F-1),T.setDate(A);var H=C&31;C>>>=5;var G=C&63;return C>>>=6,T.setHours(C),T.setMinutes(G),T.setSeconds(H<<1),T}function o(y){Ft(y,0);for(var C={},w=0;y.l<=y.length-4;){var T=y.read_shift(2),A=y.read_shift(2),F=y.l+A,H={};switch(T){case 21589:w=y.read_shift(1),w&1&&(H.mtime=y.read_shift(4)),A>5&&(w&2&&(H.atime=y.read_shift(4)),w&4&&(H.ctime=y.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}y.l=F,C[T]=H}return C}var l;function c(){return l||(l={})}function u(y,C){if(y[0]==80&&y[1]==75)return f1(y,C);if((y[0]|32)==109&&(y[1]|32)==105)return G2(y,C);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var w=3,T=512,A=0,F=0,H=0,G=0,W=0,z=[],j=y.slice(0,512);Ft(j,0);var q=f(j);switch(w=q[0],w){case 3:T=512;break;case 4:T=4096;break;case 0:if(q[1]==0)return f1(y,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}T!==512&&(j=y.slice(0,T),Ft(j,28));var ae=y.slice(0,T);h(j,w);var he=j.read_shift(4,"i");if(w===3&&he!==0)throw new Error("# Directory Sectors: Expected 0 saw "+he);j.l+=4,H=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),G=j.read_shift(4,"i"),A=j.read_shift(4,"i"),W=j.read_shift(4,"i"),F=j.read_shift(4,"i");for(var ee=-1,le=0;le<109&&(ee=j.read_shift(4,"i"),!(ee<0));++le)z[le]=ee;var ye=d(y,T);_(W,F,ye,T,z);var Ye=x(ye,H,z,T);Ye[H].name="!Directory",A>0&&G!==Y&&(Ye[G].name="!MiniFAT"),Ye[z[0]].name="!FAT",Ye.fat_addrs=z,Ye.ssz=T;var qe={},Mt=[],Ua=[],Wa=[];g(H,Ye,ye,Mt,A,qe,Ua,G),p(Ua,Wa,Mt),Mt.shift();var Ha={FileIndex:Ua,FullPaths:Wa};return C&&C.raw&&(Ha.raw={header:ae,sectors:ye}),Ha}function f(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(me,"Header Signature: "),y.l+=16;var C=y.read_shift(2,"u");return[y.read_shift(2,"u"),C]}function h(y,C){var w=9;switch(y.l+=2,w=y.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function d(y,C){for(var w=Math.ceil(y.length/C)-1,T=[],A=1;A<w;++A)T[A-1]=y.slice(A*C,(A+1)*C);return T[w-1]=y.slice(w*C),T}function p(y,C,w){for(var T=0,A=0,F=0,H=0,G=0,W=w.length,z=[],j=[];T<W;++T)z[T]=j[T]=T,C[T]=w[T];for(;G<j.length;++G)T=j[G],A=y[T].L,F=y[T].R,H=y[T].C,z[T]===T&&(A!==-1&&z[A]!==A&&(z[T]=z[A]),F!==-1&&z[F]!==F&&(z[T]=z[F])),H!==-1&&(z[H]=T),A!==-1&&T!=z[T]&&(z[A]=z[T],j.lastIndexOf(A)<G&&j.push(A)),F!==-1&&T!=z[T]&&(z[F]=z[T],j.lastIndexOf(F)<G&&j.push(F));for(T=1;T<W;++T)z[T]===T&&(F!==-1&&z[F]!==F?z[T]=z[F]:A!==-1&&z[A]!==A&&(z[T]=z[A]));for(T=1;T<W;++T)if(y[T].type!==0){if(G=T,G!=z[G])do G=z[G],C[T]=C[G]+"/"+C[T];while(G!==0&&z[G]!==-1&&G!=z[G]);z[T]=-1}for(C[0]+="/",T=1;T<W;++T)y[T].type!==2&&(C[T]+="/")}function m(y,C,w){for(var T=y.start,A=y.size,F=[],H=T;w&&A>0&&H>=0;)F.push(C.slice(H*b,H*b+b)),A-=b,H=Ki(w,H*4);return F.length===0?mt(0):oi(F).slice(0,y.size)}function _(y,C,w,T,A){var F=Y;if(y===Y){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var H=w[y],G=(T>>>2)-1;if(!H)return;for(var W=0;W<G&&(F=Ki(H,W*4))!==Y;++W)A.push(F);_(Ki(H,T-4),C-1,w,T,A)}}function v(y,C,w,T,A){var F=[],H=[];A||(A=[]);var G=T-1,W=0,z=0;for(W=C;W>=0;){A[W]=!0,F[F.length]=W,H.push(y[W]);var j=w[Math.floor(W*4/T)];if(z=W*4&G,T<4+z)throw new Error("FAT boundary crossed: "+W+" 4 "+T);if(!y[j])break;W=Ki(y[j],z)}return{nodes:F,data:Jg([H])}}function x(y,C,w,T){var A=y.length,F=[],H=[],G=[],W=[],z=T-1,j=0,q=0,ae=0,he=0;for(j=0;j<A;++j)if(G=[],ae=j+C,ae>=A&&(ae-=A),!H[ae]){W=[];var ee=[];for(q=ae;q>=0;){ee[q]=!0,H[q]=!0,G[G.length]=q,W.push(y[q]);var le=w[Math.floor(q*4/T)];if(he=q*4&z,T<4+he)throw new Error("FAT boundary crossed: "+q+" 4 "+T);if(!y[le]||(q=Ki(y[le],he),ee[q]))break}F[ae]={nodes:G,data:Jg([W])}}return F}function g(y,C,w,T,A,F,H,G){for(var W=0,z=T.length?2:0,j=C[y].data,q=0,ae=0,he;q<j.length;q+=128){var ee=j.slice(q,q+128);Ft(ee,64),ae=ee.read_shift(2),he=jp(ee,0,ae-z),T.push(he);var le={name:he,type:ee.read_shift(1),color:ee.read_shift(1),L:ee.read_shift(4,"i"),R:ee.read_shift(4,"i"),C:ee.read_shift(4,"i"),clsid:ee.read_shift(16),state:ee.read_shift(4,"i"),start:0,size:0},ye=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);ye!==0&&(le.ct=S(ee,ee.l-8));var Ye=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);Ye!==0&&(le.mt=S(ee,ee.l-8)),le.start=ee.read_shift(4,"i"),le.size=ee.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=Y,le.name=""),le.type===5?(W=le.start,A>0&&W!==Y&&(C[W].name="!StreamData")):le.size>=4096?(le.storage="fat",C[le.start]===void 0&&(C[le.start]=v(w,le.start,C.fat_addrs,C.ssz)),C[le.start].name=le.name,le.content=C[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:W!==Y&&le.start!==Y&&C[W]&&(le.content=m(le,C[W].data,(C[G]||{}).data))),le.content&&Ft(le.content,0),F[he]=le,H.push(le)}}function S(y,C){return new Date((vr(y,C+4)/1e7*Math.pow(2,32)+vr(y,C)/1e7-11644473600)*1e3)}function D(y,C){return c(),u(l.readFileSync(y),C)}function k(y,C){var w=C&&C.type;switch(w||Ie&&Buffer.isBuffer(y)&&(w="buffer"),w||"base64"){case"file":return D(y,C);case"base64":return u(Kr(wr(y)),C);case"binary":return u(Kr(y),C)}return u(y,C)}function E(y,C){var w=C||{},T=w.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=T+"/",y.FileIndex[0]={name:T,type:5}),w.CLSID&&(y.FileIndex[0].clsid=w.CLSID),O(y)}function O(y){var C="Sh33tJ5";if(!Fe.find(y,"/"+C)){var w=mt(4);w[0]=55,w[1]=w[3]=50,w[2]=54,y.FileIndex.push({name:C,type:2,content:w,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+C),N(y)}}function N(y,C){E(y);for(var w=!1,T=!1,A=y.FullPaths.length-1;A>=0;--A){var F=y.FileIndex[A];switch(F.type){case 0:T?w=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(F.R*F.L*F.C)&&(w=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!C)){var H=new Date(1987,1,19),G=0,W=Object.create?Object.create(null):{},z=[];for(A=0;A<y.FullPaths.length;++A)W[y.FullPaths[A]]=!0,y.FileIndex[A].type!==0&&z.push([y.FullPaths[A],y.FileIndex[A]]);for(A=0;A<z.length;++A){var j=n(z[A][0]);T=W[j],T||(z.push([j,{name:i(j).replace("/",""),type:1,clsid:de,ct:H,mt:H,content:null}]),W[j]=!0)}for(z.sort(function(he,ee){return r(he[0],ee[0])}),y.FullPaths=[],y.FileIndex=[],A=0;A<z.length;++A)y.FullPaths[A]=z[A][0],y.FileIndex[A]=z[A][1];for(A=0;A<z.length;++A){var q=y.FileIndex[A],ae=y.FullPaths[A];if(q.name=i(ae).replace("/",""),q.L=q.R=q.C=-(q.color=1),q.size=q.content?q.content.length:0,q.start=0,q.clsid=q.clsid||de,A===0)q.C=z.length>1?1:-1,q.size=0,q.type=5;else if(ae.slice(-1)=="/"){for(G=A+1;G<z.length&&n(y.FullPaths[G])!=ae;++G);for(q.C=G>=z.length?-1:G,G=A+1;G<z.length&&n(y.FullPaths[G])!=n(ae);++G);q.R=G>=z.length?-1:G,q.type=1}else n(y.FullPaths[A+1]||"")==n(ae)&&(q.R=A+1),q.type=2}}}function B(y,C){var w=C||{};if(w.fileType=="mad")return K2(y,w);switch(N(y),w.fileType){case"zip":return W2(y,w)}var T=function(he){for(var ee=0,le=0,ye=0;ye<he.FileIndex.length;++ye){var Ye=he.FileIndex[ye];if(Ye.content){var qe=Ye.content.length;qe>0&&(qe<4096?ee+=qe+63>>6:le+=qe+511>>9)}}for(var Mt=he.FullPaths.length+3>>2,Ua=ee+7>>3,Wa=ee+127>>7,Ha=Ua+le+Mt+Wa,Vi=Ha+127>>7,w0=Vi<=109?0:Math.ceil((Vi-109)/127);Ha+Vi+w0+127>>7>Vi;)w0=++Vi<=109?0:Math.ceil((Vi-109)/127);var En=[1,w0,Vi,Wa,Mt,le,ee,0];return he.FileIndex[0].size=ee<<6,En[7]=(he.FileIndex[0].start=En[0]+En[1]+En[2]+En[3]+En[4]+En[5])+(En[6]+7>>3),En}(y),A=mt(T[7]<<9),F=0,H=0;{for(F=0;F<8;++F)A.write_shift(1,ie[F]);for(F=0;F<8;++F)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),F=0;F<3;++F)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,T[2]),A.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:Y),A.write_shift(4,T[3]),A.write_shift(-4,T[1]?T[0]-1:Y),A.write_shift(4,T[1]),F=0;F<109;++F)A.write_shift(-4,F<T[2]?T[1]+F:-1)}if(T[1])for(H=0;H<T[1];++H){for(;F<236+H*127;++F)A.write_shift(-4,F<T[2]?T[1]+F:-1);A.write_shift(-4,H===T[1]-1?Y:H+1)}var G=function(he){for(H+=he;F<H-1;++F)A.write_shift(-4,F+1);he&&(++F,A.write_shift(-4,Y))};for(H=F=0,H+=T[1];F<H;++F)A.write_shift(-4,ce.DIFSECT);for(H+=T[2];F<H;++F)A.write_shift(-4,ce.FATSECT);G(T[3]),G(T[4]);for(var W=0,z=0,j=y.FileIndex[0];W<y.FileIndex.length;++W)j=y.FileIndex[W],j.content&&(z=j.content.length,!(z<4096)&&(j.start=H,G(z+511>>9)));for(G(T[6]+7>>3);A.l&511;)A.write_shift(-4,ce.ENDOFCHAIN);for(H=F=0,W=0;W<y.FileIndex.length;++W)j=y.FileIndex[W],j.content&&(z=j.content.length,!(!z||z>=4096)&&(j.start=H,G(z+63>>6)));for(;A.l&511;)A.write_shift(-4,ce.ENDOFCHAIN);for(F=0;F<T[4]<<2;++F){var q=y.FullPaths[F];if(!q||q.length===0){for(W=0;W<17;++W)A.write_shift(4,0);for(W=0;W<3;++W)A.write_shift(4,-1);for(W=0;W<12;++W)A.write_shift(4,0);continue}j=y.FileIndex[F],F===0&&(j.start=j.size?j.start-1:Y);var ae=F===0&&w.root||j.name;if(z=2*(ae.length+1),A.write_shift(64,ae,"utf16le"),A.write_shift(2,z),A.write_shift(1,j.type),A.write_shift(1,j.color),A.write_shift(-4,j.L),A.write_shift(-4,j.R),A.write_shift(-4,j.C),j.clsid)A.write_shift(16,j.clsid,"hex");else for(W=0;W<4;++W)A.write_shift(4,0);A.write_shift(4,j.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,j.start),A.write_shift(4,j.size),A.write_shift(4,0)}for(F=1;F<y.FileIndex.length;++F)if(j=y.FileIndex[F],j.size>=4096)if(A.l=j.start+1<<9,Ie&&Buffer.isBuffer(j.content))j.content.copy(A,A.l,0,j.size),A.l+=j.size+511&-512;else{for(W=0;W<j.size;++W)A.write_shift(1,j.content[W]);for(;W&511;++W)A.write_shift(1,0)}for(F=1;F<y.FileIndex.length;++F)if(j=y.FileIndex[F],j.size>0&&j.size<4096)if(Ie&&Buffer.isBuffer(j.content))j.content.copy(A,A.l,0,j.size),A.l+=j.size+63&-64;else{for(W=0;W<j.size;++W)A.write_shift(1,j.content[W]);for(;W&63;++W)A.write_shift(1,0)}if(Ie)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function U(y,C){var w=y.FullPaths.map(function(W){return W.toUpperCase()}),T=w.map(function(W){var z=W.split("/");return z[z.length-(W.slice(-1)=="/"?2:1)]}),A=!1;C.charCodeAt(0)===47?(A=!0,C=w[0].slice(0,-1)+C):A=C.indexOf("/")!==-1;var F=C.toUpperCase(),H=A===!0?w.indexOf(F):T.indexOf(F);if(H!==-1)return y.FileIndex[H];var G=!F.match(oo);for(F=F.replace(rr,""),G&&(F=F.replace(oo,"!")),H=0;H<w.length;++H)if((G?w[H].replace(oo,"!"):w[H]).replace(rr,"")==F||(G?T[H].replace(oo,"!"):T[H]).replace(rr,"")==F)return y.FileIndex[H];return null}var b=64,Y=-2,me="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(y,C,w){c();var T=B(y,w);l.writeFileSync(C,T)}function M(y){for(var C=new Array(y.length),w=0;w<y.length;++w)C[w]=String.fromCharCode(y[w]);return C.join("")}function te(y,C){var w=B(y,C);switch(C&&C.type||"buffer"){case"file":return c(),l.writeFileSync(C.filename,w),w;case"binary":return typeof w=="string"?w:M(w);case"base64":return Pg(typeof w=="string"?w:M(w));case"buffer":if(Ie)return Buffer.isBuffer(w)?w:Es(w);case"array":return typeof w=="string"?Kr(w):w}return w}var ue;function I(y){try{var C=y.InflateRaw,w=new C;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)ue=y;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function V(y,C){if(!ue)return c1(y,C);var w=ue.InflateRaw,T=new w,A=T._processChunk(y.slice(y.l),T._finishFlushFlag);return y.l+=T.bytesRead,A}function L(y){return ue?ue.deflateRawSync(y):we(y)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(y){var C=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(C>>16|C>>8|C)&255}for(var se=typeof Uint8Array<"u",Z=se?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)Z[Ne]=fe(Ne);function R(y,C){var w=Z[y&255];return C<=8?w>>>8-C:(w=w<<8|Z[y>>8&255],C<=16?w>>>16-C:(w=w<<8|Z[y>>16&255],w>>>24-C))}function st(y,C){var w=C&7,T=C>>>3;return(y[T]|(w<=6?0:y[T+1]<<8))>>>w&3}function Pe(y,C){var w=C&7,T=C>>>3;return(y[T]|(w<=5?0:y[T+1]<<8))>>>w&7}function Ue(y,C){var w=C&7,T=C>>>3;return(y[T]|(w<=4?0:y[T+1]<<8))>>>w&15}function Se(y,C){var w=C&7,T=C>>>3;return(y[T]|(w<=3?0:y[T+1]<<8))>>>w&31}function oe(y,C){var w=C&7,T=C>>>3;return(y[T]|(w<=1?0:y[T+1]<<8))>>>w&127}function at(y,C,w){var T=C&7,A=C>>>3,F=(1<<w)-1,H=y[A]>>>T;return w<8-T||(H|=y[A+1]<<8-T,w<16-T)||(H|=y[A+2]<<16-T,w<24-T)||(H|=y[A+3]<<24-T),H&F}function Sr(y,C,w){var T=C&7,A=C>>>3;return T<=5?y[A]|=(w&7)<<T:(y[A]|=w<<T&255,y[A+1]=(w&7)>>8-T),C+3}function nn(y,C,w){var T=C&7,A=C>>>3;return w=(w&1)<<T,y[A]|=w,C+1}function _n(y,C,w){var T=C&7,A=C>>>3;return w<<=T,y[A]|=w&255,w>>>=8,y[A+1]=w,C+8}function ba(y,C,w){var T=C&7,A=C>>>3;return w<<=T,y[A]|=w&255,w>>>=8,y[A+1]=w&255,y[A+2]=w>>>8,C+16}function Kn(y,C){var w=y.length,T=2*w>C?2*w:C+5,A=0;if(w>=C)return y;if(Ie){var F=Lg(T);if(y.copy)y.copy(F);else for(;A<y.length;++A)F[A]=y[A];return F}else if(se){var H=new Uint8Array(T);if(H.set)H.set(y);else for(;A<w;++A)H[A]=y[A];return H}return y.length=T,y}function mr(y){for(var C=new Array(y),w=0;w<y;++w)C[w]=0;return C}function yn(y,C,w){var T=1,A=0,F=0,H=0,G=0,W=y.length,z=se?new Uint16Array(32):mr(32);for(F=0;F<32;++F)z[F]=0;for(F=W;F<w;++F)y[F]=0;W=y.length;var j=se?new Uint16Array(W):mr(W);for(F=0;F<W;++F)z[A=y[F]]++,T<A&&(T=A),j[F]=0;for(z[0]=0,F=1;F<=T;++F)z[F+16]=G=G+z[F-1]<<1;for(F=0;F<W;++F)G=y[F],G!=0&&(j[F]=z[G+16]++);var q=0;for(F=0;F<W;++F)if(q=y[F],q!=0)for(G=R(j[F],T)>>T-q,H=(1<<T+4-q)-1;H>=0;--H)C[G|H<<q]=q&15|F<<4;return T}var Xn=se?new Uint16Array(512):mr(512),Ba=se?new Uint16Array(32):mr(32);if(!se){for(var Xt=0;Xt<512;++Xt)Xn[Xt]=0;for(Xt=0;Xt<32;++Xt)Ba[Xt]=0}(function(){for(var y=[],C=0;C<32;C++)y.push(5);yn(y,Ba,32);var w=[];for(C=0;C<=143;C++)w.push(8);for(;C<=255;C++)w.push(9);for(;C<=279;C++)w.push(7);for(;C<=287;C++)w.push(8);yn(w,Xn,288)})();var sn=function(){for(var C=se?new Uint8Array(32768):[],w=0,T=0;w<ne.length-1;++w)for(;T<ne[w+1];++T)C[T]=w;for(;T<32768;++T)C[T]=29;var A=se?new Uint8Array(259):[];for(w=0,T=0;w<X.length-1;++w)for(;T<X[w+1];++T)A[T]=w;function F(G,W){for(var z=0;z<G.length;){var j=Math.min(65535,G.length-z),q=z+j==G.length;for(W.write_shift(1,+q),W.write_shift(2,j),W.write_shift(2,~j&65535);j-- >0;)W[W.l++]=G[z++]}return W.l}function H(G,W){for(var z=0,j=0,q=se?new Uint16Array(32768):[];j<G.length;){var ae=Math.min(65535,G.length-j);if(ae<10){for(z=Sr(W,z,+(j+ae==G.length)),z&7&&(z+=8-(z&7)),W.l=z/8|0,W.write_shift(2,ae),W.write_shift(2,~ae&65535);ae-- >0;)W[W.l++]=G[j++];z=W.l*8;continue}z=Sr(W,z,+(j+ae==G.length)+2);for(var he=0;ae-- >0;){var ee=G[j];he=(he<<5^ee)&32767;var le=-1,ye=0;if((le=q[he])&&(le|=j&-32768,le>j&&(le-=32768),le<j))for(;G[le+ye]==G[j+ye]&&ye<250;)++ye;if(ye>2){ee=A[ye],ee<=22?z=_n(W,z,Z[ee+1]>>1)-1:(_n(W,z,3),z+=5,_n(W,z,Z[ee-23]>>5),z+=3);var Ye=ee<8?0:ee-4>>2;Ye>0&&(ba(W,z,ye-X[ee]),z+=Ye),ee=C[j-le],z=_n(W,z,Z[ee]>>3),z-=3;var qe=ee<4?0:ee-2>>1;qe>0&&(ba(W,z,j-le-ne[ee]),z+=qe);for(var Mt=0;Mt<ye;++Mt)q[he]=j&32767,he=(he<<5^G[j])&32767,++j;ae-=ye-1}else ee<=143?ee=ee+48:z=nn(W,z,1),z=_n(W,z,Z[ee]),q[he]=j&32767,++j}z=_n(W,z,0)-1}return W.l=(z+7)/8|0,W.l}return function(W,z){return W.length<8?F(W,z):H(W,z)}}();function we(y){var C=mt(50+Math.floor(y.length*1.1)),w=sn(y,C);return C.slice(0,w)}var ot=se?new Uint16Array(32768):mr(32768),Cr=se?new Uint16Array(32768):mr(32768),pt=se?new Uint16Array(128):mr(128),Hi=1,l1=1;function b2(y,C){var w=Se(y,C)+257;C+=5;var T=Se(y,C)+1;C+=5;var A=Ue(y,C)+4;C+=4;for(var F=0,H=se?new Uint8Array(19):mr(19),G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,z=se?new Uint8Array(8):mr(8),j=se?new Uint8Array(8):mr(8),q=H.length,ae=0;ae<A;++ae)H[P[ae]]=F=Pe(y,C),W<F&&(W=F),z[F]++,C+=3;var he=0;for(z[0]=0,ae=1;ae<=W;++ae)j[ae]=he=he+z[ae-1]<<1;for(ae=0;ae<q;++ae)(he=H[ae])!=0&&(G[ae]=j[he]++);var ee=0;for(ae=0;ae<q;++ae)if(ee=H[ae],ee!=0){he=Z[G[ae]]>>8-ee;for(var le=(1<<7-ee)-1;le>=0;--le)pt[he|le<<ee]=ee&7|ae<<3}var ye=[];for(W=1;ye.length<w+T;)switch(he=pt[oe(y,C)],C+=he&7,he>>>=3){case 16:for(F=3+st(y,C),C+=2,he=ye[ye.length-1];F-- >0;)ye.push(he);break;case 17:for(F=3+Pe(y,C),C+=3;F-- >0;)ye.push(0);break;case 18:for(F=11+oe(y,C),C+=7;F-- >0;)ye.push(0);break;default:ye.push(he),W<he&&(W=he);break}var Ye=ye.slice(0,w),qe=ye.slice(w);for(ae=w;ae<286;++ae)Ye[ae]=0;for(ae=T;ae<30;++ae)qe[ae]=0;return Hi=yn(Ye,ot,286),l1=yn(qe,Cr,30),C}function B2(y,C){if(y[0]==3&&!(y[1]&3))return[Oi(C),2];for(var w=0,T=0,A=Lg(C||1<<18),F=0,H=A.length>>>0,G=0,W=0;!(T&1);){if(T=Pe(y,w),w+=3,T>>>1)T>>1==1?(G=9,W=5):(w=b2(y,w),G=Hi,W=l1);else{w&7&&(w+=8-(w&7));var z=y[w>>>3]|y[(w>>>3)+1]<<8;if(w+=32,z>0)for(!C&&H<F+z&&(A=Kn(A,F+z),H=A.length);z-- >0;)A[F++]=y[w>>>3],w+=8;continue}for(;;){!C&&H<F+32767&&(A=Kn(A,F+32767),H=A.length);var j=at(y,w,G),q=T>>>1==1?Xn[j]:ot[j];if(w+=q&15,q>>>=4,!(q>>>8&255))A[F++]=q;else{if(q==256)break;q-=257;var ae=q<8?0:q-4>>2;ae>5&&(ae=0);var he=F+X[q];ae>0&&(he+=at(y,w,ae),w+=ae),j=at(y,w,W),q=T>>>1==1?Ba[j]:Cr[j],w+=q&15,q>>>=4;var ee=q<4?0:q-2>>1,le=ne[q];for(ee>0&&(le+=at(y,w,ee),w+=ee),!C&&H<he&&(A=Kn(A,he+100),H=A.length);F<he;)A[F]=A[F-le],++F}}}return C?[A,w+7>>>3]:[A.slice(0,F),w+7>>>3]}function c1(y,C){var w=y.slice(y.l||0),T=B2(w,C);return y.l+=T[1],T[0]}function u1(y,C){if(y)typeof console<"u"&&console.error(C);else throw new Error(C)}function f1(y,C){var w=y;Ft(w,0);var T=[],A=[],F={FileIndex:T,FullPaths:A};E(F,{root:C.root});for(var H=w.length-4;(w[H]!=80||w[H+1]!=75||w[H+2]!=5||w[H+3]!=6)&&H>=0;)--H;w.l=H+4,w.l+=4;var G=w.read_shift(2);w.l+=6;var W=w.read_shift(4);for(w.l=W,H=0;H<G;++H){w.l+=20;var z=w.read_shift(4),j=w.read_shift(4),q=w.read_shift(2),ae=w.read_shift(2),he=w.read_shift(2);w.l+=8;var ee=w.read_shift(4),le=o(w.slice(w.l+q,w.l+q+ae));w.l+=q+ae+he;var ye=w.l;w.l=ee+4,U2(w,z,j,F,le),w.l=ye}return F}function U2(y,C,w,T,A){y.l+=2;var F=y.read_shift(2),H=y.read_shift(2),G=a(y);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var W=y.read_shift(4),z=y.read_shift(4),j=y.read_shift(4),q=y.read_shift(2),ae=y.read_shift(2),he="",ee=0;ee<q;++ee)he+=String.fromCharCode(y[y.l++]);if(ae){var le=o(y.slice(y.l,y.l+ae));(le[21589]||{}).mt&&(G=le[21589].mt),((A||{})[21589]||{}).mt&&(G=A[21589].mt)}y.l+=ae;var ye=y.slice(y.l,y.l+z);switch(H){case 8:ye=V(y,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var Ye=!1;F&8&&(W=y.read_shift(4),W==134695760&&(W=y.read_shift(4),Ye=!0),z=y.read_shift(4),j=y.read_shift(4)),z!=C&&u1(Ye,"Bad compressed size: "+C+" != "+z),j!=w&&u1(Ye,"Bad uncompressed size: "+w+" != "+j),E0(T,he,ye,{unsafe:!0,mt:G})}function W2(y,C){var w=C||{},T=[],A=[],F=mt(1),H=w.compression?8:0,G=0,W=0,z=0,j=0,q=0,ae=y.FullPaths[0],he=ae,ee=y.FileIndex[0],le=[],ye=0;for(W=1;W<y.FullPaths.length;++W)if(he=y.FullPaths[W].slice(ae.length),ee=y.FileIndex[W],!(!ee.size||!ee.content||he=="Sh33tJ5")){var Ye=j,qe=mt(he.length);for(z=0;z<he.length;++z)qe.write_shift(1,he.charCodeAt(z)&127);qe=qe.slice(0,qe.l),le[q]=_3.buf(ee.content,0);var Mt=ee.content;H==8&&(Mt=L(Mt)),F=mt(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,G),F.write_shift(2,H),ee.mt?s(F,ee.mt):F.write_shift(4,0),F.write_shift(-4,le[q]),F.write_shift(4,Mt.length),F.write_shift(4,ee.content.length),F.write_shift(2,qe.length),F.write_shift(2,0),j+=F.length,T.push(F),j+=qe.length,T.push(qe),j+=Mt.length,T.push(Mt),F=mt(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,G),F.write_shift(2,H),F.write_shift(4,0),F.write_shift(-4,le[q]),F.write_shift(4,Mt.length),F.write_shift(4,ee.content.length),F.write_shift(2,qe.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Ye),ye+=F.l,A.push(F),ye+=qe.length,A.push(qe),++q}return F=mt(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,q),F.write_shift(2,q),F.write_shift(4,ye),F.write_shift(4,j),F.write_shift(2,0),oi([oi(T),oi(A),F])}var Wl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function H2(y,C){if(y.ctype)return y.ctype;var w=y.name||"",T=w.match(/\.([^\.]+)$/);return T&&Wl[T[1]]||C&&(T=(w=C).match(/[\.\\]([^\.\\])+$/),T&&Wl[T[1]])?Wl[T[1]]:"application/octet-stream"}function V2(y){for(var C=Pg(y),w=[],T=0;T<C.length;T+=76)w.push(C.slice(T,T+76));return w.join(`\r
`)+`\r
`}function z2(y){var C=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var j=z.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],T=C.split(`\r
`),A=0;A<T.length;++A){var F=T[A];if(F.length==0){w.push("");continue}for(var H=0;H<F.length;){var G=76,W=F.slice(H,H+G);W.charAt(G-1)=="="?G--:W.charAt(G-2)=="="?G-=2:W.charAt(G-3)=="="&&(G-=3),W=F.slice(H,H+G),H+=G,H<F.length&&(W+="="),w.push(W)}}return w.join(`\r
`)}function j2(y){for(var C=[],w=0;w<y.length;++w){for(var T=y[w];w<=y.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+y[++w];C.push(T)}for(var A=0;A<C.length;++A)C[A]=C[A].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Kr(C.join(`\r
`))}function $2(y,C,w){for(var T="",A="",F="",H,G=0;G<10;++G){var W=C[G];if(!W||W.match(/^\s*$/))break;var z=W.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":T=z[2].trim();break;case"content-type":F=z[2].trim();break;case"content-transfer-encoding":A=z[2].trim();break}}switch(++G,A.toLowerCase()){case"base64":H=Kr(wr(C.slice(G).join("")));break;case"quoted-printable":H=j2(C.slice(G));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var j=E0(y,T.slice(w.length),H,{unsafe:!0});F&&(j.ctype=F)}function G2(y,C){if(M(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=C&&C.root||"",T=(Ie&&Buffer.isBuffer(y)?y.toString("binary"):M(y)).split(`\r
`),A=0,F="";for(A=0;A<T.length;++A)if(F=T[A],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),w||(w=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),F.slice(0,w.length)!=w););var H=(T[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var G="--"+(H[1]||""),W=[],z=[],j={FileIndex:W,FullPaths:z};E(j);var q,ae=0;for(A=0;A<T.length;++A){var he=T[A];he!==G&&he!==G+"--"||(ae++&&$2(j,T.slice(q,A),w),q=A)}return j}function K2(y,C){var w=C||{},T=w.boundary||"SheetJS";T="------="+T;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],F=y.FullPaths[0],H=F,G=y.FileIndex[0],W=1;W<y.FullPaths.length;++W)if(H=y.FullPaths[W].slice(F.length),G=y.FileIndex[W],!(!G.size||!G.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ye){return"_x"+ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ye){return"_u"+ye.charCodeAt(0).toString(16)+"_"});for(var z=G.content,j=Ie&&Buffer.isBuffer(z)?z.toString("binary"):M(z),q=0,ae=Math.min(1024,j.length),he=0,ee=0;ee<=ae;++ee)(he=j.charCodeAt(ee))>=32&&he<128&&++q;var le=q>=ae*4/5;A.push(T),A.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+H),A.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),A.push("Content-Type: "+H2(G,H)),A.push(""),A.push(le?z2(j):V2(j))}return A.push(T+`--\r
`),A.join(`\r
`)}function X2(y){var C={};return E(C,y),C}function E0(y,C,w,T){var A=T&&T.unsafe;A||E(y);var F=!A&&Fe.find(y,C);if(!F){var H=y.FullPaths[0];C.slice(0,H.length)==H?H=C:(H.slice(-1)!="/"&&(H+="/"),H=(H+C).replace("//","/")),F={name:i(C),type:2},y.FileIndex.push(F),y.FullPaths.push(H),A||Fe.utils.cfb_gc(y)}return F.content=w,F.size=w?w.length:0,T&&(T.CLSID&&(F.clsid=T.CLSID),T.mt&&(F.mt=T.mt),T.ct&&(F.ct=T.ct)),F}function Y2(y,C){E(y);var w=Fe.find(y,C);if(w){for(var T=0;T<y.FileIndex.length;++T)if(y.FileIndex[T]==w)return y.FileIndex.splice(T,1),y.FullPaths.splice(T,1),!0}return!1}function q2(y,C,w){E(y);var T=Fe.find(y,C);if(T){for(var A=0;A<y.FileIndex.length;++A)if(y.FileIndex[A]==T)return y.FileIndex[A].name=i(w),y.FullPaths[A]=w,!0}return!1}function Q2(y){N(y,!0)}return t.find=U,t.read=k,t.parse=u,t.write=te,t.writeFile=J,t.utils={cfb_new:X2,cfb_add:E0,cfb_del:Y2,cfb_mov:q2,cfb_gc:Q2,ReadShift:Co,CheckField:Uw,prep_blob:Ft,bconcat:oi,use_zlib:I,_deflateRaw:we,_inflateRaw:c1,consts:ce},t}();function y3(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function mn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Wp(e){for(var t=[],r=mn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Ru=new Date(1899,11,30,0,0,0);function ir(e,t){var r=e.getTime(),n=Ru.getTime()+(e.getTimezoneOffset()-Ru.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var xw=new Date,E3=Ru.getTime()+(xw.getTimezoneOffset()-Ru.getTimezoneOffset())*6e4,zg=xw.getTimezoneOffset();function v0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+E3),t.getTimezoneOffset()!==zg&&t.setTime(t.getTime()+(t.getTimezoneOffset()-zg)*6e4),t}function w3(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var jg=new Date("2017-02-19T19:06:09.000Z"),_w=isNaN(jg.getFullYear())?new Date("2/19/17"):jg,T3=_w.getFullYear()==2017;function At(e,t){var r=new Date(e);if(T3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(_w.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ps(e,t){if(Ie&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return co(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return co(sw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return co(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return co(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Dt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Dt(e[r]));return t}function tt(e,t){for(var r="";r.length<t;)r+=e;return r}function en(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var k3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ea(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&k3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var S3=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function yw(e){return e?e.content&&e.type?ps(e.content,!0):e.data?ao(e.data):e.asNodeBuffer&&Ie?ao(e.asNodeBuffer().toString("binary")):e.asBinary?ao(e.asBinary()):e._data&&e._data.getContent?ao(ps(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Ew(e){if(!e)return null;if(e.data)return Dg(e.data);if(e.asNodeBuffer&&Ie)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Dg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function C3(e){return e&&e.name.slice(-4)===".bin"?Ew(e):yw(e)}function Fr(e,t){for(var r=e.FullPaths||mn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Hp(e,t){var r=Fr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ft(e,t,r){if(!r)return C3(Hp(e,t));if(!t)return null;try{return ft(e,t)}catch{return null}}function xr(e,t,r){if(!r)return yw(Hp(e,t));if(!t)return null;try{return xr(e,t)}catch{return null}}function A3(e,t,r){return Ew(Hp(e,t))}function $g(e){for(var t=e.FullPaths||mn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function I3(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ie?n=Es(r):n=KN(r),Fe.utils.cfb_add(e,t,n)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function ww(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function lo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Tw=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,F3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Gg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,R3=/<[^>]*>/g,Kt=Tw.match(Gg)?Gg:R3,N3=/<\w*:/,D3=/<(\/?)\w+:/;function ve(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(F3),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,l=f.slice(s+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function vn(e){return e.replace(D3,"<$1")}var kw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},O3=Wp(kw),Oe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,l){return kw[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),P3=/[&<>'"]/g,L3=/[\u0000-\u001f]/g;function Vp(e){var t=e+"";return t.replace(P3,function(r){return O3[r]}).replace(/\n/g,"<br/>").replace(L3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Kg=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Ge(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ff(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Xg(e){var t=Oi(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Yg(e){return Es(e,"binary").toString("utf8")}var lc="foo bar baz",ze=Ie&&(Yg(lc)==ff(lc)&&Yg||Xg(lc)==ff(lc)&&Xg)||ff,co=Ie?function(e){return Es(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},fl=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Sw=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),M3=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),b3=/<\/?(?:vt:)?variant>/g,B3=/<(?:vt:)([^>]*)>([\s\S]*)</;function qg(e,t){var r=ve(e),n=e.match(M3(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(b3,"").match(B3);a&&i.push({v:ze(a[2]),t:a[1]})}),i}var U3=/(^\s|\s$|\n)/;function W3(e){return mn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function H3(e,t,r){return"<"+e+(r!=null?W3(r):"")+(t!=null?(t.match(U3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function zp(e){if(Ie&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ze(ws(bp(e)));throw new Error("Bad input format: expected Buffer or string")}var hl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,V3={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},z3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function j3(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function $3(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Qg=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Jg=Ie?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Es(t)})):Qg(e)}:Qg,Zg=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Nn(e,i)));return n.join("").replace(rr,"")},jp=Ie?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(rr,""):Zg(e,t,r)}:Zg,ev=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Cw=Ie?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ev(e,t,r)}:ev,tv=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Rs(e,i)));return n.join("")},Pl=Ie?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):tv(t,r,n)}:tv,Aw=function(e,t){var r=vr(e,t);return r>0?Pl(e,t+4,t+4+r-1):""},Iw=Aw,Fw=function(e,t){var r=vr(e,t);return r>0?Pl(e,t+4,t+4+r-1):""},Rw=Fw,Nw=function(e,t){var r=2*vr(e,t);return r>0?Pl(e,t+4,t+4+r-1):""},Dw=Nw,Ow=function(t,r){var n=vr(t,r);return n>0?jp(t,r+4,r+4+n):""},Pw=Ow,Lw=function(e,t){var r=vr(e,t);return r>0?Pl(e,t+4,t+4+r):""},Mw=Lw,bw=function(e,t){return j3(e,t)},Nu=bw,Bw=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ie&&(Iw=function(t,r){if(!Buffer.isBuffer(t))return Aw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Rw=function(t,r){if(!Buffer.isBuffer(t))return Fw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Dw=function(t,r){if(!Buffer.isBuffer(t))return Nw(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Pw=function(t,r){if(!Buffer.isBuffer(t))return Ow(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Mw=function(t,r){if(!Buffer.isBuffer(t))return Lw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Nu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):bw(t,r)},Bw=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Rs=function(e,t){return e[t]},Nn=function(e,t){return e[t+1]*256+e[t]},G3=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},vr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ki=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},K3=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Co(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Ie&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Nn(this,c)),c+=2;e*=2;break;case"utf8":r=Pl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=jp(this,this.l,this.l+e);break;case"wstr":return Co.call(this,e,"dbcs");case"lpstr-ansi":r=Iw(this,this.l),e=4+vr(this,this.l);break;case"lpstr-cp":r=Rw(this,this.l),e=4+vr(this,this.l);break;case"lpwstr":r=Dw(this,this.l),e=4+2*vr(this,this.l);break;case"lpp4":e=4+vr(this,this.l),r=Pw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+vr(this,this.l),r=Mw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Rs(this,this.l+e++))!==0;)s.push(oc(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Nn(this,this.l+e))!==0;)s.push(oc(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Rs(this,c),this.l=c+1,o=Co.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(oc(Nn(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Rs(this,c),this.l=c+1,o=Co.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(oc(Rs(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Rs(this,this.l),this.l++,n;case 2:return n=(t==="i"?G3:Nn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ki:K3)(this,this.l),this.l+=4,n):(i=vr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Nu(this,this.l):i=Nu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Cw(this,this.l,e);break}}return this.l+=e,r}var X3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Y3=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},q3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Q3(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)q3(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,X3(this,t,this.l);break;case 8:if(n=8,r==="f"){$3(this,t,this.l);break}case 16:break;case-4:n=4,Y3(this,t,this.l);break}return this.l+=n,this}function Uw(e,t){var r=Cw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ft(e,t){e.l=t,e.read_shift=Co,e.chk=Uw,e.write_shift=Q3}function Gt(e,t){e.l+=t}function mt(e){var t=Oi(e);return Ft(t,0),t}function Gn(e,t,r){if(e){var n,i,s;Ft(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=bu[o]||bu[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function Mh(){var e=[],t=Ie?256:2048,r=function(c){var u=mt(c);return Ft(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),oi(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function Ao(e,t,r){var n=Dt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function rv(e,t,r){var n=Dt(e);return n.s=Ao(n.s,t.s,r),n.e=Ao(n.e,t.s,r),n}function Io(e,t){if(e.cRel&&e.c<0)for(e=Dt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=_e(e);return!e.cRel&&e.cRel!=null&&(r=eD(r)),!e.rRel&&e.rRel!=null&&(r=J3(r)),r}function hf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yt(e.s.c)+":"+(e.e.cRel?"":"$")+yt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ot(e.s.r)+":"+(e.e.rRel?"":"$")+Ot(e.e.r):Io(e.s,t.biff)+":"+Io(e.e,t.biff)}function $p(e){return parseInt(Z3(e),10)-1}function Ot(e){return""+(e+1)}function J3(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z3(e){return e.replace(/\$(\d+)$/,"$1")}function Gp(e){for(var t=tD(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function yt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function eD(e){return e.replace(/^([A-Z])/,"$$$1")}function tD(e){return e.replace(/^\$([A-Z])/,"$1")}function rD(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Zt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function _e(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function La(e){var t=e.indexOf(":");return t==-1?{s:Zt(e),e:Zt(e)}:{s:Zt(e.slice(0,t)),e:Zt(e.slice(t+1))}}function Re(e,t){return typeof t>"u"||typeof t=="number"?Re(e.s,e.e):(typeof e!="string"&&(e=_e(e)),typeof t!="string"&&(t=_e(t)),e==t?e:e+":"+t)}function it(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function nv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Br(e.z,r?ir(t):t)}catch{}try{return e.w=Br((e.XF||{}).numFmtId||(r?14:0),r?ir(t):t)}catch{return""+t}}function zn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ss[e.v]||e.v:t==null?nv(e,e.v):nv(e,t))}function Wi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ww(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Zt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=it(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},p=a+f,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ee[14],n.cellDates?(d.t="d",d.w=Br(d.z,ir(d.v))):(d.t="n",d.v=ir(d.v),d.w=Br(d.z,d.v))):d.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(d.z=s[p][m].z),s[p][m]=d;else{var _=_e({c:m,r:p});s[_]&&s[_].z&&(d.z=s[_].z),s[_]=d}}}return c.s.c<1e7&&(s["!ref"]=Re(c)),s}function Ma(e,t){return Ww(null,e,t)}function nD(e){return e.read_shift(4,"i")}function jt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function iD(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Kp(e,t){var r=e.l,n=e.read_shift(1),i=jt(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(iD(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var sD=Kp;function Ur(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ts(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var aD=jt;function Xp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var oD=jt,bh=Xp;function Yp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Nu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ki(t,0)>>2;return r?i/100:i}function Hw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ks=Hw;function Vt(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function lD(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=rs[i];c&&(t.rgb=pl(c));break;case 2:t.rgb=pl([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function cD(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Vw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function uD(e){return Vw(e,1)}function fD(e){return Vw(e,2)}var qp=2,lr=3,cc=11,iv=12,Du=19,uc=64,hD=65,dD=71,pD=4108,mD=4126,Tt=80,zw=81,gD=[Tt,zw],vD={1:{n:"CodePage",t:qp},2:{n:"Category",t:Tt},3:{n:"PresentationFormat",t:Tt},4:{n:"ByteCount",t:lr},5:{n:"LineCount",t:lr},6:{n:"ParagraphCount",t:lr},7:{n:"SlideCount",t:lr},8:{n:"NoteCount",t:lr},9:{n:"HiddenCount",t:lr},10:{n:"MultimediaClipCount",t:lr},11:{n:"ScaleCrop",t:cc},12:{n:"HeadingPairs",t:pD},13:{n:"TitlesOfParts",t:mD},14:{n:"Manager",t:Tt},15:{n:"Company",t:Tt},16:{n:"LinksUpToDate",t:cc},17:{n:"CharacterCount",t:lr},19:{n:"SharedDoc",t:cc},22:{n:"HyperlinksChanged",t:cc},23:{n:"AppVersion",t:lr,p:"version"},24:{n:"DigSig",t:hD},26:{n:"ContentType",t:Tt},27:{n:"ContentStatus",t:Tt},28:{n:"Language",t:Tt},29:{n:"Version",t:Tt},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},xD={1:{n:"CodePage",t:qp},2:{n:"Title",t:Tt},3:{n:"Subject",t:Tt},4:{n:"Author",t:Tt},5:{n:"Keywords",t:Tt},6:{n:"Comments",t:Tt},7:{n:"Template",t:Tt},8:{n:"LastAuthor",t:Tt},9:{n:"RevNumber",t:Tt},10:{n:"EditTime",t:uc},11:{n:"LastPrinted",t:uc},12:{n:"CreatedDate",t:uc},13:{n:"ModifiedDate",t:uc},14:{n:"PageCount",t:lr},15:{n:"WordCount",t:lr},16:{n:"CharCount",t:lr},17:{n:"Thumbnail",t:dD},18:{n:"Application",t:Tt},19:{n:"DocSecurity",t:lr},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},sv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_D=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function yD(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ED=yD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rs=Dt(ED),Ss={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},av={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function wD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function TD(e){var t=wD();if(!e||!e.match)return t;var r={};if((e.match(Kt)||[]).forEach(function(n){var i=ve(n);switch(i[0].replace(N3,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[av[i.ContentType]]!==void 0&&t[av[i.ContentType]].push(i.PartName);break}}),t.xmlns!==V3.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var $s={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Fo(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kt)||[]).forEach(function(i){var s=ve(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:lo(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var kD="application/vnd.oasis.opendocument.spreadsheet";function SD(e,t){for(var r=zp(e),n,i;n=hl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ve(n[0],!1),i.path=="/"&&i.type!==kD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Ro=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CD=function(){for(var e=new Array(Ro.length),t=0;t<Ro.length;++t){var r=Ro[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function $w(e){var t={};e=ze(e);for(var r=0;r<Ro.length;++r){var n=Ro[r],i=e.match(CD[r]);i!=null&&i.length>0&&(t[n[1]]=Oe(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=At(t[n[1]]))}return t}var AD=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Gw(e,t,r,n){var i=[];if(typeof e=="string")i=qg(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?qg(t,n).map(function(u){return u.v}):t,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function ID(e,t,r){var n={};return t||(t={}),e=ze(e),AD.forEach(function(i){var s=(e.match(fl(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Oe(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Gw(n.HeadingPairs,n.TitlesOfParts,t,r),t}var FD=/<[^>]+>[^<]*/g;function RD(e,t){var r={},n="",i=e.match(FD);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=ve(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Oe(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Oe(u);break;case"bool":r[n]=Ge(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=At(u);break;case"cy":case"error":r[n]=Oe(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var ND={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},df;function DD(e,t,r){df||(df=Wp(ND)),t=df[t]||t,e[t]=r}function Qp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Kw(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Xw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Yw(e,t,r){return t===31?Xw(e):Kw(e,t,r)}function Uh(e,t,r){return Yw(e,t,r===!1?0:4)}function OD(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Yw(e,t,0)}function PD(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(rr,""),e.l-i&2&&(e.l+=2)}return r}function LD(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(rr,"");return r}function MD(e){var t=e.l,r=Ou(e,zw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ou(e,lr);return[r,n]}function bD(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(MD(e));return r}function ov(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(rr,"").replace(oo,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function qw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function BD(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ou(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==iv&&n!==t&&gD.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===iv?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Kw(e,n,4).replace(rr,"");case 31:return Xw(e);case 64:return Qp(e);case 65:return qw(e);case 71:return BD(e);case 80:return Uh(e,n,!s.raw).replace(rr,"");case 81:return OD(e,n).replace(rr,"");case 4108:return bD(e);case 4126:case 4127:return n==4127?PD(e):LD(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function lv(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=e.read_shift(4),f=e.read_shift(4);s[a]=[u,f+r]}s.sort(function(x,g){return x[1]-g[1]});var h={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var d=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(d=!1,e.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var p=t[s[a][0]];if(h[p.n]=Ou(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Yr(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[a][0]===1){if(o=h.CodePage=Ou(e,qp),Yr(o),l!==-1){var m=e.l;e.l=s[l][1],c=ov(e,o),e.l=m}}else if(s[a][0]===0){if(o===0){l=a,e.l=s[a+1][1];continue}c=ov(e,o)}else{var _=c[s[a][0]],v;switch(e[e.l]){case 65:e.l+=4,v=qw(e);break;case 30:e.l+=4,v=Uh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Uh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=lt(e,4);break;case 64:e.l+=4,v=At(Qp(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[_]=v}}return e.l=r+n,h}function cv(e,t,r){var n=e.content;if(!n)return{};Ft(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Fe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=lv(n,t),h={SystemIdentifier:c};for(var d in f)h[d]=f[d];if(h.FMTID=s,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=lv(n,null)}catch{}for(d in p)h[d]=p[d];return h.FMTID=[s,a],h}function Qn(e,t){return e.read_shift(t),null}function UD(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function lt(e,t){return e.read_shift(t)===1}function ht(e){return e.read_shift(2,"u")}function Qw(e,t){return UD(e,t,ht)}function WD(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Ll(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function HD(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*a),n&&(e.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ms(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ml(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ms(e,n,r)}function Cs(e,t,r){if(r.biff>5)return Ml(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function VD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function zD(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(rr,"");return n&&(e.l+=24),i}function jD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(rr,"");return r+a}function $D(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return zD(e);case"0303000000000000c000000000000046":return jD(e);default:throw new Error("Unsupported Moniker "+r)}}function fc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(rr,""):"";return r}function GD(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,l,c="",u,f;i&16&&(s=fc(e,r-e.l)),i&128&&(a=fc(e,r-e.l)),(i&257)===257&&(o=fc(e,r-e.l)),(i&257)===1&&(l=$D(e,r-e.l)),i&8&&(c=fc(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=Qp(e)),e.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),s&&(d.Tooltip=s),d}function Jw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Zw(e,t){var r=Jw(e);return r[3]=0,r}function xn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function KD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function XD(e,t,r){return t===0?"":Cs(e,t,r)}function YD(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function e2(e){var t=e.read_shift(2),r=Yp(e);return[t,r]}function qD(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Ll(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function x0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function t2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var QD=t2;function r2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function JD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ut(e){e.l+=2,e.l+=e.read_shift(2)}var eO={0:Ut,4:Ut,5:Ut,6:Ut,7:ZD,8:Ut,9:Ut,10:Ut,11:Ut,12:Ut,13:JD,14:Ut,15:Ut,16:Ut,17:Ut,18:Ut,19:Ut,20:Ut,21:r2};function tO(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(eO[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function hc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function rO(e,t){return t===0||e.read_shift(2),1200}function nO(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Cs(e,0,r);return e.read_shift(t+n-e.l),i}function iO(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function sO(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Ll(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function aO(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(HD(e));return s.Count=n,s.Unique=i,s}function oO(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function lO(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function cO(e){var t=KD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function uO(e){return e.read_shift(2),e.read_shift(4)}function uv(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function fO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function hO(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function dO(){}function pO(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Ll(e,0,r),n}function mO(e){var t=xn(e);return t.isst=e.read_shift(4),t}function gO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=xn(e);r.biff==2&&e.l++;var s=Ml(e,n-e.l,r);return i.val=s,i}function vO(e,t,r){var n=e.read_shift(2),i=Cs(e,0,r);return[n,i]}var xO=Cs;function fv(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function _O(e){var t=e.read_shift(2),r=e.read_shift(2),n=e2(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function yO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e2(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function EO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function wO(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=_D[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function TO(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=wO(e,t,n.fStyle,r),n}function kO(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function hv(e,t,r){var n=xn(e);(r.biff==2||t==9)&&++e.l;var i=WD(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function SO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=xn(e),i=Vt(e);return n.val=i,n}var dv=XD;function CO(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=ms(e,s),o=[];n>e.l;)o.push(Ml(e));return[s,i,a,o]}function pv(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=qD(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var AO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mv(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ms(e,a,r);i&32&&(c=AO[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:l6(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function n2(e,t,r){if(r.biff<8)return IO(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(YD(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function IO(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Ll(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function FO(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=ms(e,n,r),a=ms(e,i,r);return[s,a]}function RO(e,t,r){var n=t2(e);e.l++;var i=e.read_shift(1);return t-=8,[c6(e,t,r),i,n]}function gv(e,t,r){var n=QD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,a6(e,t,r)]}function NO(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function DO(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Cs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function OO(e,t,r){return DO(e,t,r)}function PO(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(x0(e));return r}function LO(e,t,r){if(r&&r.biff<8)return bO(e,t,r);var n=r2(e),i=tO(e,t-22,n[1]);return{cmo:n,ft:i}}var MO={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function bO(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((MO[n]||Gt)(e,t,r)),{cmo:[i,n,s],ft:a}}function BO(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=VD(e,6,r);var o=e.read_shift(2);e.read_shift(2),ht(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=ms(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function UO(e,t){var r=x0(e);e.l+=16;var n=GD(e,t-24);return[r,n]}function WO(e,t){e.read_shift(2);var r=x0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(rr,""),[r,n]}function HO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=sv[r]||r,r=e.read_shift(2),t[1]=sv[r]||r,t}function VO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Zw(e));return r}function zO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Zw(e));return r}function jO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function i2(e,t,r){if(!r.cellStyles)return Gt(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function $O(e,t){var r={};return t<32||(e.l+=16,r.header=Vt(e),r.footer=Vt(e),e.l+=2),r}function GO(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var KO=xn,XO=Qw,YO=Ml;function qO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function QO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=xn(e);++e.l;var i=Cs(e,t-7,r);return n.t="str",n.val=i,n}function JO(e){var t=xn(e);++e.l;var r=Vt(e);return t.t="n",t.val=r,t}function ZO(e){var t=xn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function eP(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function tP(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function rP(e,t,r){var n=e.l+t,i=xn(e),s=e.read_shift(2),a=ms(e,s,r);return e.l=n,i.t="str",i.val=a,i}var nP=[2,3,48,49,131,139,140,245],vv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Wp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Oi(1);switch(l.type){case"base64":u=Kr(wr(o));break;case"binary":u=Kr(o);break;case"buffer":case"array":u=o;break}Ft(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,_=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(_=u.read_shift(2));var v=u.read_shift(2),x=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(x=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var g=[],S={},D=Math.min(u.length,f==2?521:_-10-(d?264:0)),k=p?32:11;u.l<D&&u[u.l]!=13;)switch(S={},S.name=ai.utils.decode(x,u.slice(u.l,u.l+k)).replace(/[\u0000\r\n].*$/g,""),u.l+=k,S.type=String.fromCharCode(u.read_shift(1)),f!=2&&!p&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),f==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&g.push(S),f!=2&&(u.l+=p?13:14),S.type){case"B":(!d||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var E=0,O=0;for(c[0]=[],O=0;O!=g.length;++O)c[0][O]=g[O].name;for(;m-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++E]=[],O=0,O=0;O!=g.length;++O){var N=u.slice(u.l,u.l+g[O].len);u.l+=g[O].len,Ft(N,0);var B=ai.utils.decode(x,N);switch(g[O].type){case"C":B.trim().length&&(c[E][O]=B.replace(/\s+$/,""));break;case"D":B.length===8?c[E][O]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):c[E][O]=B;break;case"F":c[E][O]=parseFloat(B.trim());break;case"+":case"I":c[E][O]=p?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":c[E][O]=!0;break;case"N":case"F":c[E][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[E][O]="##MEMO##"+(p?parseInt(B.trim(),10):N.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(c[E][O]=+B||0);break;case"@":c[E][O]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":c[E][O]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":c[E][O]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][O]=-N.read_shift(-8,"f");break;case"B":if(d&&g[O].len==8){c[E][O]=N.read_shift(8,"f");break}case"G":case"P":N.l+=g[O].len;break;case"0":if(g[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[O].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ma(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return Wi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Yr(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Mh(),f=Gh(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),p=o["!cols"]||[],m=0,_=0,v=0,x=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(_=0;_<1024;++_)if(h.indexOf(h[m]+"_"+_)==-1){h[m]+="_"+_;break}}}}var g=it(o["!ref"]),S=[],D=[],k=[];for(m=0;m<=g.e.c-g.s.c;++m){var E="",O="",N=0,B=[];for(_=0;_<d.length;++_)d[_][m]!=null&&B.push(d[_][m]);if(B.length==0||h[m]==null){S[m]="?";continue}for(_=0;_<B.length;++_){switch(typeof B[_]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=B[_]instanceof Date?"D":"C";break;default:O="C"}N=Math.max(N,String(B[_]).length),E=E&&E!=O?"C":O}N>250&&(N=250),O=((p[m]||{}).DBF||{}).type,O=="C"&&p[m].DBF.len>N&&(N=p[m].DBF.len),E=="B"&&O=="N"&&(E="N",k[m]=p[m].DBF.dec,N=p[m].DBF.len),D[m]=E=="C"||O=="N"?N:s[E]||0,x+=D[m],S[m]=E}var U=u.next(32);for(U.write_shift(4,318902576),U.write_shift(4,d.length),U.write_shift(2,296+32*v),U.write_shift(2,x),m=0;m<4;++m)U.write_shift(4,0);for(U.write_shift(4,0|(+t[nw]||3)<<8),m=0,_=0;m<h.length;++m)if(h[m]!=null){var b=u.next(32),Y=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,Y,"sbcs"),b.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),b.write_shift(4,_),b.write_shift(1,D[m]||s[S[m]]||0),b.write_shift(1,k[m]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),_+=D[m]||s[S[m]]||0}var me=u.next(264);for(me.write_shift(4,13),m=0;m<65;++m)me.write_shift(4,0);for(m=0;m<d.length;++m){var ie=u.next(x);for(ie.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(S[_]){case"L":ie.write_shift(1,d[m][_]==null?63:d[m][_]?84:70);break;case"B":ie.write_shift(8,d[m][_]||0,"f");break;case"N":var de="0";for(typeof d[m][_]=="number"&&(de=d[m][_].toFixed(k[_]||0)),v=0;v<D[_]-de.length;++v)ie.write_shift(1,32);ie.write_shift(1,de,"sbcs");break;case"D":d[m][_]?(ie.write_shift(4,("0000"+d[m][_].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(d[m][_].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+d[m][_].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var ce=String(d[m][_]!=null?d[m][_]:"").slice(0,D[_]);for(ie.write_shift(1,ce,"sbcs"),v=0;v<D[_]-ce.length;++v)ie.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),iP=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+mn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var p=e[d];return typeof p=="number"?Og(p):p},n=function(h,d,p){var m=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:Og(m)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s(wr(h),d);case"binary":return s(h,d);case"buffer":return s(Ie&&Buffer.isBuffer(h)?h.toString("binary"):ws(h),d);case"array":return s(ps(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var p=h.split(/[\n\r]+/),m=-1,_=-1,v=0,x=0,g=[],S=[],D=null,k={},E=[],O=[],N=[],B=0,U;for(+d.codepage>=0&&Yr(+d.codepage);v!==p.length;++v){B=0;var b=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Y=b.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),me=Y[0],ie;if(b.length>0)switch(me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&S.push(b.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,ce=!1,J=!1,M=!1,te=-1,ue=-1;for(x=1;x<Y.length;++x)switch(Y[x].charAt(0)){case"A":break;case"X":_=parseInt(Y[x].slice(1))-1,ce=!0;break;case"Y":for(m=parseInt(Y[x].slice(1))-1,ce||(_=0),U=g.length;U<=m;++U)g[U]=[];break;case"K":ie=Y[x].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(en(ie))?isNaN(Ea(ie).getDate())||(ie=At(ie)):(ie=en(ie),D!==null&&Pa(D)&&(ie=v0(ie))),de=!0;break;case"E":M=!0;var I=ia(Y[x].slice(1),{r:m,c:_});g[m][_]=[g[m][_],I];break;case"S":J=!0,g[m][_]=[g[m][_],"S5S"];break;case"G":break;case"R":te=parseInt(Y[x].slice(1))-1;break;case"C":ue=parseInt(Y[x].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+b)}if(de&&(g[m][_]&&g[m][_].length==2?g[m][_][0]=ie:g[m][_]=ie,D=null),J){if(M)throw new Error("SYLK shared formula cannot have own formula");var V=te>-1&&g[te][ue];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");g[m][_][1]=p2(V[1],{r:m-te,c:_-ue})}break;case"F":var L=0;for(x=1;x<Y.length;++x)switch(Y[x].charAt(0)){case"X":_=parseInt(Y[x].slice(1))-1,++L;break;case"Y":for(m=parseInt(Y[x].slice(1))-1,U=g.length;U<=m;++U)g[U]=[];break;case"M":B=parseInt(Y[x].slice(1))/20;break;case"F":break;case"G":break;case"P":D=S[parseInt(Y[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=Y[x].slice(1).split(" "),U=parseInt(N[0],10);U<=parseInt(N[1],10);++U)B=parseInt(N[2],10),O[U-1]=B===0?{hidden:!0}:{wch:B},wa(O[U-1]);break;case"C":_=parseInt(Y[x].slice(1))-1,O[_]||(O[_]={});break;case"R":m=parseInt(Y[x].slice(1))-1,E[m]||(E[m]={}),B>0?(E[m].hpt=B,E[m].hpx=ml(B)):B===0&&(E[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+b)}L<1&&(D=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+b)}}return E.length>0&&(k["!rows"]=E),O.length>0&&(k["!cols"]=O),d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),[g,k]}function a(h,d){var p=i(h,d),m=p[0],_=p[1],v=Ma(m,d);return mn(_).forEach(function(x){v[x]=_[x]}),v}function o(h,d){return Wi(a(h,d),d)}function l(h,d,p,m){var _="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+j8(h.f,{r:p,c:m}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,d){d.forEach(function(p,m){var _="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?_+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Lu(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Mu(p.wpx)),typeof p.wch=="number"&&(_+=Math.round(p.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function u(h,d){d.forEach(function(p,m){var _="F;";p.hidden?_+="M0;":p.hpt?_+="M"+20*p.hpt+";":p.hpx&&(_+="M"+20*f2(p.hpx)+";"),_.length>2&&h.push(_+"R"+(m+1))})}function f(h,d){var p=["ID;PWXL;N;E"],m=[],_=it(h["!ref"]),v,x=Array.isArray(h),g=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var S=_.s.r;S<=_.e.r;++S)for(var D=_.s.c;D<=_.e.c;++D){var k=_e({r:S,c:D});v=x?(h[S]||[])[D]:h[k],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,h,S,D))}return p.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),sP=function(){function e(s,a){switch(a.type){case"base64":return t(wr(s),a);case"binary":return t(s,a);case"buffer":return t(Ie&&Buffer.isBuffer(s)?s.toString("binary"):ws(s),a);case"array":return t(ps(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],p=h[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+d){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(en(p))?isNaN(Ea(p).getDate())?f[l][c]=p:f[l][c]=At(p):f[l][c]=en(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return Ma(e(s,a),a)}function n(s,a){return Wi(r(s,a),a)}var i=function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=it(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var m=_e({r:d,c:p});if(f=h?(l[d]||[])[p]:l[m],!f){a(c,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,_,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Br(f.z||Ee[14],ir(At(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var v=`\r
`,x=c.join(v);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),aP=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),p=-1,m=-1,_=0,v=[];_!==d.length;++_){var x=d[_].trim().split(":");if(x[0]==="cell"){var g=Zt(x[1]);if(v.length<=g.r)for(p=v.length;p<=g.r;++p)v[p]||(v[p]=[]);switch(p=g.r,m=g.c,x[2]){case"t":v[p][m]=e(x[3]);break;case"v":v[p][m]=+x[3];break;case"vtf":var S=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[p][m]=!!+x[4];break;default:v[p][m]=+x[4];break}x[2]=="vtf"&&(v[p][m]=[v[p][m],S])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return Ma(r(f,h),h)}function i(f,h){return Wi(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],p,m="",_=La(f["!ref"]),v=Array.isArray(f),x=_.s.r;x<=_.e.r;++x)for(var g=_.s.c;g<=_.e.c;++g)if(m=_e({r:x,c:g}),p=v?(f[x]||[])[g]:f[m],!(!p||p.v==null||p.t==="z")){switch(d=["cell",m,"t"],p.t){case"s":case"str":d.push(t(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=t(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var S=ir(At(p.v));d[2]="vtc",d[3]="nd",d[4]=""+S,d[5]=p.w||Br(p.z||Ee[14],S);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),dl=function(){function e(u,f,h,d,p){p.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(en(u))?isNaN(Ea(u).getDate())?f[h][d]=u:f[h][d]=At(u):f[h][d]=en(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var p=u.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var _=10,v=0,x=0;x<=m;++x)v=p[x].indexOf(" "),v==-1?v=p[x].length:v++,_=Math.max(_,v);for(x=0;x<=m;++x){d[x]=[];var g=0;for(e(p[x].slice(0,_).trim(),d,x,g,h),g=1;g<=(p[x].length-_)/10+1;++g)e(p[x].slice(_+(g-1)*10,_+g*10).trim(),d,x,g,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,p=0;d<u.length;++d)(p=u.charCodeAt(d))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&p.push([f[d],d]);if(!p.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&p.push([f[d],d])}return p.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[p.pop()[1]]||44}function s(u,f){var h=f||{},d="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var _=0,v=0,x=0,g=0,S=0,D=d.charCodeAt(0),k=!1,E=0,O=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var N=h.dateNF!=null?v3(h.dateNF):null;function B(){var U=u.slice(g,S),b={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)b.t="z";else if(h.raw)b.t="s",b.v=U;else if(U.trim().length===0)b.t="s",b.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(b.t="s",b.v=U.slice(2,-1).replace(/""/g,'"')):G8(U)?(b.t="n",b.f=U.slice(1)):(b.t="s",b.v=U);else if(U=="TRUE")b.t="b",b.v=!0;else if(U=="FALSE")b.t="b",b.v=!1;else if(!isNaN(x=en(U)))b.t="n",h.cellText!==!1&&(b.w=U),b.v=x;else if(!isNaN(Ea(U).getDate())||N&&U.match(N)){b.z=h.dateNF||Ee[14];var Y=0;N&&U.match(N)&&(U=x3(U,h.dateNF,U.match(N)||[]),Y=1),h.cellDates?(b.t="d",b.v=At(U,Y)):(b.t="n",b.v=ir(At(U,Y))),h.cellText!==!1&&(b.w=Br(b.z,b.v instanceof Date?ir(b.v):b.v)),h.cellNF||delete b.z}else b.t="s",b.v=U;if(b.t=="z"||(h.dense?(p[_]||(p[_]=[]),p[_][v]=b):p[_e({c:v,r:_})]=b),g=S+1,O=u.charCodeAt(g),m.e.c<v&&(m.e.c=v),m.e.r<_&&(m.e.r=_),E==D)++v;else if(v=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;S<u.length;++S)switch(E=u.charCodeAt(S)){case 34:O===34&&(k=!k);break;case D:case 10:case 13:if(!k&&B())break e;break}return S-g>0&&B(),p["!ref"]=Re(m),p}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Ma(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:s1(u,f);switch(f.type){case"base64":h=wr(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof ai<"u"?h=ai.utils.decode(f.codepage,u):h=Ie&&Buffer.isBuffer(u)?u.toString("binary"):ws(u);break;case"array":h=ps(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=ze(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ze(h):f.type=="binary"&&typeof ai<"u"&&f.codepage&&(h=ai.utils.decode(f.codepage,ai.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?aP.to_sheet(f.type=="string"?h:ze(h),f):a(h,f)}function l(u,f){return Wi(o(u,f),f)}function c(u){for(var f=[],h=it(u["!ref"]),d,p=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var _=[],v=h.s.c;v<=h.e.c;++v){var x=_e({r:m,c:v});if(d=p?(u[m]||[])[v]:u[x],!d||d.v==null){_.push("          ");continue}for(var g=(d.w||(zn(d),d.w)||"").slice(0,10);g.length<10;)g+=" ";_.push(g+(v===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function oP(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=iP.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return dl.to_workbook(e,t)}}var No=function(){function e(I,V,L){if(I){Ft(I,I.l||0);for(var P=L.Enum||te;I.l<I.length;){var X=I.read_shift(2),ne=P[X]||P[65535],fe=I.read_shift(2),se=I.l+fe,Z=ne.f&&ne.f(I,fe,L);if(I.l=se,V(Z,ne,X))return}}}function t(I,V){switch(V.type){case"base64":return r(Kr(wr(I)),V);case"binary":return r(Kr(I),V);case"buffer":case"array":return r(I,V)}throw"Unsupported type "+V.type}function r(I,V){if(!I)return I;var L=V||{},P=L.dense?[]:{},X="Sheet1",ne="",fe=0,se={},Z=[],Ne=[],R={s:{r:0,c:0},e:{r:0,c:0}},st=L.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)L.Enum=te,e(I,function(oe,at,Sr){switch(Sr){case 0:L.vers=oe,oe>=4096&&(L.qpro=!0);break;case 6:R=oe;break;case 204:oe&&(ne=oe);break;case 222:ne=oe;break;case 15:case 51:L.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Sr==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=L.dateNF||Ee[14],L.cellDates&&(oe[1].t="d",oe[1].v=v0(oe[1].v))),L.qpro&&oe[3]>fe&&(P["!ref"]=Re(R),se[X]=P,Z.push(X),P=L.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},fe=oe[3],X=ne||"Sheet"+(fe+1),ne="");var nn=L.dense?(P[oe[0].r]||[])[oe[0].c]:P[_e(oe[0])];if(nn){nn.t=oe[1].t,nn.v=oe[1].v,oe[1].z!=null&&(nn.z=oe[1].z),oe[1].f!=null&&(nn.f=oe[1].f);break}L.dense?(P[oe[0].r]||(P[oe[0].r]=[]),P[oe[0].r][oe[0].c]=oe[1]):P[_e(oe[0])]=oe[1];break}},L);else if(I[2]==26||I[2]==14)L.Enum=ue,I[2]==14&&(L.qpro=!0,I.l=0),e(I,function(oe,at,Sr){switch(Sr){case 204:X=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>fe&&(P["!ref"]=Re(R),se[X]=P,Z.push(X),P=L.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},fe=oe[3],X="Sheet"+(fe+1)),st>0&&oe[0].r>=st)break;L.dense?(P[oe[0].r]||(P[oe[0].r]=[]),P[oe[0].r][oe[0].c]=oe[1]):P[_e(oe[0])]=oe[1],R.e.c<oe[0].c&&(R.e.c=oe[0].c),R.e.r<oe[0].r&&(R.e.r=oe[0].r);break;case 27:oe[14e3]&&(Ne[oe[14e3][0]]=oe[14e3][1]);break;case 1537:Ne[oe[0]]=oe[1],oe[0]==fe&&(X=oe[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(P["!ref"]=Re(R),se[ne||X]=P,Z.push(ne||X),!Ne.length)return{SheetNames:Z,Sheets:se};for(var Pe={},Ue=[],Se=0;Se<Ne.length;++Se)se[Z[Se]]?(Ue.push(Ne[Se]||Z[Se]),Pe[Ne[Se]]=se[Ne[Se]]||se[Z[Se]]):(Ue.push(Ne[Se]),Pe[Ne[Se]]={"!ref":"A1"});return{SheetNames:Ue,Sheets:Pe}}function n(I,V){var L=V||{};if(+L.codepage>=0&&Yr(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Mh(),X=it(I["!ref"]),ne=Array.isArray(I),fe=[];Vr(P,0,s(1030)),Vr(P,6,l(X));for(var se=Math.min(X.e.r,8191),Z=X.s.r;Z<=se;++Z)for(var Ne=Ot(Z),R=X.s.c;R<=X.e.c;++R){Z===X.s.r&&(fe[R]=yt(R));var st=fe[R]+Ne,Pe=ne?(I[Z]||[])[R]:I[st];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")(Pe.v|0)==Pe.v&&Pe.v>=-32768&&Pe.v<=32767?Vr(P,13,d(Z,R,Pe.v)):Vr(P,14,m(Z,R,Pe.v));else{var Ue=zn(Pe);Vr(P,15,f(Z,R,Ue.slice(0,239)))}}return Vr(P,1),P.end()}function i(I,V){var L=V||{};if(+L.codepage>=0&&Yr(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Mh();Vr(P,0,a(I));for(var X=0,ne=0;X<I.SheetNames.length;++X)(I.Sheets[I.SheetNames[X]]||{})["!ref"]&&Vr(P,27,M(I.SheetNames[X],ne++));var fe=0;for(X=0;X<I.SheetNames.length;++X){var se=I.Sheets[I.SheetNames[X]];if(!(!se||!se["!ref"])){for(var Z=it(se["!ref"]),Ne=Array.isArray(se),R=[],st=Math.min(Z.e.r,8191),Pe=Z.s.r;Pe<=st;++Pe)for(var Ue=Ot(Pe),Se=Z.s.c;Se<=Z.e.c;++Se){Pe===Z.s.r&&(R[Se]=yt(Se));var oe=R[Se]+Ue,at=Ne?(se[Pe]||[])[Se]:se[oe];if(!(!at||at.t=="z"))if(at.t=="n")Vr(P,23,B(Pe,Se,fe,at.v));else{var Sr=zn(at);Vr(P,22,E(Pe,Se,fe,Sr.slice(0,239)))}}++fe}}return Vr(P,1),P.end()}function s(I){var V=mt(2);return V.write_shift(2,I),V}function a(I){var V=mt(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var L=0,P=0,X=0,ne=0;ne<I.SheetNames.length;++ne){var fe=I.SheetNames[ne],se=I.Sheets[fe];if(!(!se||!se["!ref"])){++X;var Z=La(se["!ref"]);L<Z.e.r&&(L=Z.e.r),P<Z.e.c&&(P=Z.e.c)}}return L>8191&&(L=8191),V.write_shift(2,L),V.write_shift(1,X),V.write_shift(1,P),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(I,V,L){var P={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&L.qpro?(P.s.c=I.read_shift(1),I.l++,P.s.r=I.read_shift(2),P.e.c=I.read_shift(1),I.l++,P.e.r=I.read_shift(2),P):(P.s.c=I.read_shift(2),P.s.r=I.read_shift(2),V==12&&L.qpro&&(I.l+=2),P.e.c=I.read_shift(2),P.e.r=I.read_shift(2),V==12&&L.qpro&&(I.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(I){var V=mt(8);return V.write_shift(2,I.s.c),V.write_shift(2,I.s.r),V.write_shift(2,I.e.c),V.write_shift(2,I.e.r),V}function c(I,V,L){var P=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(P[0].c=I.read_shift(1),P[3]=I.read_shift(1),P[0].r=I.read_shift(2),I.l+=2):(P[2]=I.read_shift(1),P[0].c=I.read_shift(2),P[0].r=I.read_shift(2)),P}function u(I,V,L){var P=I.l+V,X=c(I,V,L);if(X[1].t="s",L.vers==20768){I.l++;var ne=I.read_shift(1);return X[1].v=I.read_shift(ne,"utf8"),X}return L.qpro&&I.l++,X[1].v=I.read_shift(P-I.l,"cstr"),X}function f(I,V,L){var P=mt(7+L.length);P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,I),P.write_shift(1,39);for(var X=0;X<P.length;++X){var ne=L.charCodeAt(X);P.write_shift(1,ne>=128?95:ne)}return P.write_shift(1,0),P}function h(I,V,L){var P=c(I,V,L);return P[1].v=I.read_shift(2,"i"),P}function d(I,V,L){var P=mt(7);return P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,I),P.write_shift(2,L,"i"),P}function p(I,V,L){var P=c(I,V,L);return P[1].v=I.read_shift(8,"f"),P}function m(I,V,L){var P=mt(13);return P.write_shift(1,255),P.write_shift(2,V),P.write_shift(2,I),P.write_shift(8,L,"f"),P}function _(I,V,L){var P=I.l+V,X=c(I,V,L);if(X[1].v=I.read_shift(8,"f"),L.qpro)I.l=P;else{var ne=I.read_shift(2);S(I.slice(I.l,I.l+ne),X),I.l+=ne}return X}function v(I,V,L){var P=V&32768;return V&=-32769,V=(P?I:0)+(V>=8192?V-16384:V),(P?"":"$")+(L?yt(V):Ot(V))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(I,V){Ft(I,0);for(var L=[],P=0,X="",ne="",fe="",se="";I.l<I.length;){var Z=I[I.l++];switch(Z){case 0:L.push(I.read_shift(8,"f"));break;case 1:ne=v(V[0].c,I.read_shift(2),!0),X=v(V[0].r,I.read_shift(2),!1),L.push(ne+X);break;case 2:{var Ne=v(V[0].c,I.read_shift(2),!0),R=v(V[0].r,I.read_shift(2),!1);ne=v(V[0].c,I.read_shift(2),!0),X=v(V[0].r,I.read_shift(2),!1),L.push(Ne+R+":"+ne+X)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(I.read_shift(2));break;case 6:{for(var st="";Z=I[I.l++];)st+=String.fromCharCode(Z);L.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:se=L.pop(),fe=L.pop(),L.push(["AND","OR"][Z-20]+"("+fe+","+se+")");break;default:if(Z<32&&g[Z])se=L.pop(),fe=L.pop(),L.push(fe+g[Z]+se);else if(x[Z]){if(P=x[Z][1],P==69&&(P=I[I.l++]),P>L.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+L.join("|")+"|");return}var Pe=L.slice(-P);L.length-=P,L.push(x[Z][0]+"("+Pe.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}L.length==1?V[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function D(I){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=I.read_shift(2),V[3]=I[I.l++],V[0].c=I[I.l++],V}function k(I,V){var L=D(I);return L[1].t="s",L[1].v=I.read_shift(V-4,"cstr"),L}function E(I,V,L,P){var X=mt(6+P.length);X.write_shift(2,I),X.write_shift(1,L),X.write_shift(1,V),X.write_shift(1,39);for(var ne=0;ne<P.length;++ne){var fe=P.charCodeAt(ne);X.write_shift(1,fe>=128?95:fe)}return X.write_shift(1,0),X}function O(I,V){var L=D(I);L[1].v=I.read_shift(2);var P=L[1].v>>1;if(L[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return L[1].v=P,L}function N(I,V){var L=D(I),P=I.read_shift(4),X=I.read_shift(4),ne=I.read_shift(2);if(ne==65535)return P===0&&X===3221225472?(L[1].t="e",L[1].v=15):P===0&&X===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var fe=ne&32768;return ne=(ne&32767)-16446,L[1].v=(1-fe*2)*(X*Math.pow(2,ne+32)+P*Math.pow(2,ne)),L}function B(I,V,L,P){var X=mt(14);if(X.write_shift(2,I),X.write_shift(1,L),X.write_shift(1,V),P==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var ne=0,fe=0,se=0,Z=0;return P<0&&(ne=1,P=-P),fe=Math.log2(P)|0,P/=Math.pow(2,fe-31),Z=P>>>0,Z&2147483648||(P/=2,++fe,Z=P>>>0),P-=Z,Z|=2147483648,Z>>>=0,P*=Math.pow(2,32),se=P>>>0,X.write_shift(4,se),X.write_shift(4,Z),fe+=16383+(ne?32768:0),X.write_shift(2,fe),X}function U(I,V){var L=N(I);return I.l+=V-14,L}function b(I,V){var L=D(I),P=I.read_shift(4);return L[1].v=P>>6,L}function Y(I,V){var L=D(I),P=I.read_shift(8,"f");return L[1].v=P,L}function me(I,V){var L=Y(I);return I.l+=V-10,L}function ie(I,V){return I[I.l+V-1]==0?I.read_shift(V,"cstr"):""}function de(I,V){var L=I[I.l++];L>V-1&&(L=V-1);for(var P="";P.length<L;)P+=String.fromCharCode(I[I.l++]);return P}function ce(I,V,L){if(!(!L.qpro||V<21)){var P=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var X=I.read_shift(V-21,"cstr");return[P,X]}}function J(I,V){for(var L={},P=I.l+V;I.l<P;){var X=I.read_shift(2);if(X==14e3){for(L[X]=[0,""],L[X][0]=I.read_shift(2);I[I.l];)L[X][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return L}function M(I,V){var L=mt(5+I.length);L.write_shift(2,14e3),L.write_shift(2,V);for(var P=0;P<I.length;++P){var X=I.charCodeAt(P);L[L.l++]=X>127?95:X}return L[L.l++]=0,L}var te={0:{n:"BOF",f:ht},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function lP(e){var t={},r=e.match(Kt),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=ve(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Lp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var cP=function(){var e=fl("t"),t=fl("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:Oe(a[1])},l=s.match(t);return l&&(o.s=lP(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),uP=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),fP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,hP=/<(?:\w+:)?r>/,dP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Oe(ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ze(e),r&&(n.h=Vp(n.t))):e.match(hP)&&(n.r=ze(e),n.t=Oe(ze((e.replace(dP,"").match(fP)||[]).join("").replace(Kt,""))),r&&(n.h=uP(cP(n.r)))),n):{t:""}}var pP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,mP=/<(?:\w+:)?(?:si|sstItem)>/g,gP=/<\/(?:\w+:)?(?:si|sstItem)>/;function vP(e,t){var r=[],n="";if(!e)return r;var i=e.match(pP);if(i){n=i[2].replace(mP,"").split(gP);for(var s=0;s!=n.length;++s){var a=Jp(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=ve(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function xP(e){return[e.read_shift(4),e.read_shift(4)]}function _P(e,t){var r=[],n=!1;return Gn(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function s2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ln(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function yP(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ln(e,4),t.U=Ln(e,4),t.W=Ln(e,4),t}function EP(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function wP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(EP(e));return t}function TP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function kP(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ln(e,4),t.U=Ln(e,4),t.W=Ln(e,4),t}function SP(e){var t=kP(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function a2(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function o2(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function CP(e){var t=Ln(e);switch(t.Minor){case 2:return[t.Minor,AP(e)];case 3:return[t.Minor,IP()];case 4:return[t.Minor,FP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function AP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=a2(e,r),i=o2(e,e.length-e.l);return{t:"Std",h:n,v:i}}function IP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function FP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kt,function(s){var a=ve(s);switch(vn(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function RP(e,t){var r={},n=r.EncryptionVersionInfo=Ln(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=a2(e,i),t-=i,r.EncryptionVerifier=o2(e,t),r}function NP(e){var t={},r=t.EncryptionVersionInfo=Ln(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function DP(e){var t=0,r,n=s2(e),i=n.length+1,s,a,o,l,c;for(r=Oi(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var l2=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=s2(a),l=s(o),c=o.length,u=Oi(16),f=0;f!=16;++f)u[f]=0;var h,d,p;for((c&1)===1&&(h=l>>8,u[c]=i(e[0],h),--c,h=l&255,d=o[o.length-1],u[c]=i(d,h));c>0;)--c,h=l>>8,u[c]=i(o[c],h),--c,h=l&255,u[c]=i(o[c],h);for(c=15,p=15-o.length;p>0;)h=l>>8,u[c]=i(e[p],h),--c,--p,h=l&255,u[c]=i(o[c],h),--c,--p;return u}}(),OP=function(e,t,r,n,i){i||(i=t),n||(n=l2(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},PP=function(e){var t=0,r=l2(e);return function(n){var i=OP("",n,t,r);return t=i[1],i[0]}};function LP(e,t,r,n){var i={key:ht(e),verificationBytes:ht(e)};return r.password&&(i.verifier=DP(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=PP(r.password)),i}function MP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=NP(e):n.Data=RP(e,t),n}function bP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?MP(e,t-2,n):LP(e,r.biff>=8?t:t-2,r,n),n}var BP=function(){function e(i,s){switch(s.type){case"base64":return t(wr(i),s);case"binary":return t(i,s);case"buffer":return t(Ie&&Buffer.isBuffer(i)?i.toString("binary"):ws(i),s);case"array":return t(ps(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,p,m=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var _=u.slice(d,h.lastIndex-p[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var v={v:_,t:"s"};Array.isArray(o)?o[f][m]=v:o[_e({r:f,c:m})]=v}break}d=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Re(c),o}function r(i,s){return Wi(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=it(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=_e({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(zn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function UP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function pl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function WP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,l,c/2]}function HP(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Pu(e,t){if(t===0)return e;var r=WP(UP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),pl(HP(r))}var c2=6,VP=15,zP=1,Qt=c2;function Lu(e){return Math.floor((e+Math.round(128/Qt)/256)*Qt)}function Mu(e){return Math.floor((e-5)/Qt*100+.5)/100}function Wh(e){return Math.round((e*Qt+5)/Qt*256)/256}function pf(e){return Wh(Mu(Lu(e)))}function Zp(e){var t=Math.abs(e-pf(e)),r=Qt;if(t>.005)for(Qt=zP;Qt<VP;++Qt)Math.abs(e-pf(e))<=t&&(t=Math.abs(e-pf(e)),r=Qt);Qt=r}function wa(e){e.width?(e.wpx=Lu(e.width),e.wch=Mu(e.wpx),e.MDW=Qt):e.wpx?(e.wch=Mu(e.wpx),e.width=Wh(e.wch),e.MDW=Qt):typeof e.wch=="number"&&(e.width=Wh(e.wch),e.wpx=Lu(e.width),e.MDW=Qt),e.customWidth&&delete e.customWidth}var jP=96,u2=jP;function f2(e){return e*96/u2}function ml(e){return e*u2/96}var $P={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function GP(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Kt)||[]).forEach(function(a){var o=ve(a);switch(vn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Ge(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Ge(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function KP(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Kt)||[]).forEach(function(a){var o=ve(a);switch(vn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function XP(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Kt)||[]).forEach(function(a){var o=ve(a);switch(vn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=ze(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Ge(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Ge(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Ge(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Ge(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Ge(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Ge(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Ge(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Lp[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Ge(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=rs[i.color.index];i.color.index==81&&(l=rs[1]),l||(l=rs[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Pu(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function YP(e,t,r){t.NumberFmt=[];for(var n=mn(Ee),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Ee[n[i]];var s=e[0].match(Kt);if(s)for(i=0;i<s.length;++i){var a=ve(s[i]);switch(vn(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Oe(ze(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ts(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var dc=["numFmtId","fillId","fontId","borderId","xfId"],pc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Kt)||[]).forEach(function(s){var a=ve(s),o=0;switch(vn(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<dc.length;++o)n[dc[o]]&&(n[dc[o]]=parseInt(n[dc[o]],10));for(o=0;o<pc.length;++o)n[pc[o]]&&(n[pc[o]]=Ge(n[pc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Ge(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var QP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&YP(f,u,c),(f=o.match(i))&&XP(f,u,l,c),(f=o.match(n))&&KP(f,u,l,c),(f=o.match(s))&&GP(f,u,l,c),(f=o.match(r))&&qP(f,u,c),u}}();function JP(e,t){var r=e.read_shift(2),n=jt(e);return[r,n]}function ZP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=cD(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=lD(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jt(e),n}var e8=Gt;function t8(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var r8=Gt;function n8(e,t,r){var n={};n.NumberFmt=[];for(var i in Ee)n.NumberFmt[i]=Ee[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Gn(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ts(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Pu(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var i8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function s8(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kt)||[]).forEach(function(i){var s=ve(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[i8.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function a8(){}function o8(){}var l8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,c8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,u8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function f8(e,t,r){t.themeElements={};var n;[["clrScheme",l8,s8],["fontScheme",c8,a8],["fmtScheme",u8,o8]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var h8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function h2(e,t){(!e||e.length===0)&&(e=d8());var r,n={};if(!(r=e.match(h8)))throw new Error("themeElements not found in theme");return f8(r[0],n,t),n.raw=e,n}function d8(e,t){var r=[Tw];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function p8(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=ww(s,{type:"array"})}catch{return}var o=xr(a,"theme/theme/theme1.xml",!0);if(o)return h2(o,r)}}function m8(e){return e.read_shift(4)}function g8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=v8(e,4);break;case 2:t.xclrValue=Jw(e);break;case 3:t.xclrValue=m8(e);break;case 4:e.l+=4;break}return e.l+=8,t}function v8(e,t){return Gt(e,t)}function x8(e,t){return Gt(e,t)}function _8(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=g8(e);break;case 6:n[1]=x8(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function y8(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(_8(e,r-e.l));return{ixfe:n,ext:s}}function E8(e,t){t.forEach(function(r){switch(r[0]){}})}function w8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jt(e)}}function T8(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function k8(e){return e.l+=4,e.read_shift(4)!=0}function S8(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Gn(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function C8(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(Kt,function(o){var l=ve(o);switch(vn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function A8(e){var t=[];if(!e)return t;var r=1;return(e.match(Kt)||[]).forEach(function(n){var i=ve(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function I8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=_e(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function F8(e,t,r){var n=[];return Gn(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function R8(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Gn(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function N8(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function xv(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=Zt(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var l=it(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Re(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function D8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ve(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Zt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Jp(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function O8(e,t){var r=[],n=!1,i={},s=0;return e.replace(Kt,function(o,l){var c=ve(o);switch(vn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function P8(e,t){var r=[],n=!1;return e.replace(Kt,function(s){var a=ve(s);switch(vn(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function L8(e){var t={};t.iauthor=e.read_shift(4);var r=ks(e);return t.rfx=r.s,t.ref=_e(r.s),e.l+=16,t}var M8=jt;function b8(e,t){var r=[],n=[],i={},s=!1;return Gn(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var B8="application/vnd.ms-office.vbaProject";function U8(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Fe.write(t)}function W8(){return{"!type":"dialog"}}function H8(){return{"!type":"dialog"}}function V8(){return{"!type":"macro"}}function z8(){return{"!type":"macro"}}var ia=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+yt(u)+(l?"":"$")+Ot(c)}return function(i,s){return t=s,i.replace(e,r)}}(),d2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,j8=function(){return function(t,r){return t.replace(d2,function(n,i,s,a,o,l){var c=Gp(a)-(s?0:r.c),u=$p(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function p2(e,t){return e.replace(d2,function(r,n,i,s,a,o){return n+(i=="$"?i+s:yt(Gp(s)+t.c))+(a=="$"?a+o:Ot($p(o)+t.r))})}function $8(e,t,r){var n=La(t),i=n.s,s=Zt(r),a={r:s.r-i.r,c:s.c-i.c};return p2(e,a)}function G8(e){return e.length!=1}function _v(e){return e.replace(/_xlfn\./g,"")}function ut(e){e.l+=1}function Pi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function m2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return g2(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=Pi(e),o=Pi(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function g2(e){var t=Pi(e),r=Pi(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function K8(e,t,r){if(r.biff<8)return g2(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Pi(e),a=Pi(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function v2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return X8(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Pi(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function X8(e){var t=Pi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Y8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function q8(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Q8(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function Q8(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function J8(e,t,r){var n=(e[e.l++]&96)>>5,i=m2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Z8(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=m2(e,s,r);return[n,i,a]}function eL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tL(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function rL(e,t,r){var n=(e[e.l++]&96)>>5,i=K8(e,t-1,r);return[n,i]}function nL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function yv(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function iL(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function sL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function aL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function lL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function x2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function cL(e){return e.read_shift(2),x2(e)}function uL(e){return e.read_shift(2),x2(e)}function fL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=v2(e,0,r);return[n,i]}function hL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=q8(e,0,r);return[n,i]}function dL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=v2(e,0,r);return[n,i,s]}function pL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[m6[i],E2[i],n]}function mL(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:gL(e);return[i,(s[0]===0?E2:p6)[s[1]]]}function gL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vL(e,t,r){e.l+=r&&r.biff==2?3:4}function xL(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function _L(e){return e.l++,Ss[e.read_shift(1)]}function yL(e){return e.l++,e.read_shift(2)}function EL(e){return e.l++,e.read_shift(1)!==0}function wL(e){return e.l++,Vt(e)}function TL(e,t,r){return e.l++,Ll(e,t-1,r)}function kL(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=lt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ss[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Vt(e);break;case 2:r[1]=Cs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function SL(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ks:x0)(e));return i}function CL(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=kL(e,r.biff);return a}function AL(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function IL(e,t,r){if(r.biff==5)return FL(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function FL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function RL(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function NL(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function DL(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function OL(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var PL=Gt,LL=Gt,ML=Gt;function bl(e,t,r){return e.l+=2,[Y8(e)]}function e1(e){return e.l+=6,[]}var bL=bl,BL=e1,UL=e1,WL=bl;function _2(e){return e.l+=2,[ht(e),e.read_shift(2)&1]}var HL=bl,VL=_2,zL=e1,jL=bl,$L=bl,GL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function KL(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=GL[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function XL(e){return e.l+=2,[e.read_shift(4)]}function YL(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function qL(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function QL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function JL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ZL(e){return e.l+=4,[0,0]}var Ev={1:{n:"PtgExp",f:xL},2:{n:"PtgTbl",f:ML},3:{n:"PtgAdd",f:ut},4:{n:"PtgSub",f:ut},5:{n:"PtgMul",f:ut},6:{n:"PtgDiv",f:ut},7:{n:"PtgPower",f:ut},8:{n:"PtgConcat",f:ut},9:{n:"PtgLt",f:ut},10:{n:"PtgLe",f:ut},11:{n:"PtgEq",f:ut},12:{n:"PtgGe",f:ut},13:{n:"PtgGt",f:ut},14:{n:"PtgNe",f:ut},15:{n:"PtgIsect",f:ut},16:{n:"PtgUnion",f:ut},17:{n:"PtgRange",f:ut},18:{n:"PtgUplus",f:ut},19:{n:"PtgUminus",f:ut},20:{n:"PtgPercent",f:ut},21:{n:"PtgParen",f:ut},22:{n:"PtgMissArg",f:ut},23:{n:"PtgStr",f:TL},26:{n:"PtgSheet",f:YL},27:{n:"PtgEndSheet",f:qL},28:{n:"PtgErr",f:_L},29:{n:"PtgBool",f:EL},30:{n:"PtgInt",f:yL},31:{n:"PtgNum",f:wL},32:{n:"PtgArray",f:nL},33:{n:"PtgFunc",f:pL},34:{n:"PtgFuncVar",f:mL},35:{n:"PtgName",f:AL},36:{n:"PtgRef",f:fL},37:{n:"PtgArea",f:J8},38:{n:"PtgMemArea",f:RL},39:{n:"PtgMemErr",f:PL},40:{n:"PtgMemNoMem",f:LL},41:{n:"PtgMemFunc",f:NL},42:{n:"PtgRefErr",f:DL},43:{n:"PtgAreaErr",f:eL},44:{n:"PtgRefN",f:hL},45:{n:"PtgAreaN",f:rL},46:{n:"PtgMemAreaN",f:QL},47:{n:"PtgMemNoMemN",f:JL},57:{n:"PtgNameX",f:IL},58:{n:"PtgRef3d",f:dL},59:{n:"PtgArea3d",f:Z8},60:{n:"PtgRefErr3d",f:OL},61:{n:"PtgAreaErr3d",f:tL},255:{}},e6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},t6={1:{n:"PtgElfLel",f:_2},2:{n:"PtgElfRw",f:jL},3:{n:"PtgElfCol",f:bL},6:{n:"PtgElfRwV",f:$L},7:{n:"PtgElfColV",f:WL},10:{n:"PtgElfRadical",f:HL},11:{n:"PtgElfRadicalS",f:zL},13:{n:"PtgElfColS",f:BL},15:{n:"PtgElfColSV",f:UL},16:{n:"PtgElfRadicalLel",f:VL},25:{n:"PtgList",f:KL},29:{n:"PtgSxName",f:XL},255:{}},r6={0:{n:"PtgAttrNoop",f:ZL},1:{n:"PtgAttrSemi",f:lL},2:{n:"PtgAttrIf",f:aL},4:{n:"PtgAttrChoose",f:iL},8:{n:"PtgAttrGoto",f:sL},16:{n:"PtgAttrSum",f:vL},32:{n:"PtgAttrBaxcel",f:yv},33:{n:"PtgAttrBaxcel",f:yv},64:{n:"PtgAttrSpace",f:cL},65:{n:"PtgAttrSpaceSemi",f:uL},128:{n:"PtgAttrIfError",f:oL},255:{}};function Bl(e,t,r,n){if(n.biff<8)return Gt(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=CL(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=SL(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Gt(e,t)),s}function Ul(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Ev[s]||Ev[e6[s]],(s===24||s===25)&&(i=(s===24?t6:r6)[e[e.l+1]]),!i||!i.f?Gt(e,t):a.push([i.n,i.f(e,t,r)]);return a}function n6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var i6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function s6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function y2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function wv(e,t,r){var n=y2(e,t,r);return n=="#REF"?n:s6(n,r)}function Wt(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,_="",v=0,x=e[0].length;v<x;++v){var g=e[0][v];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:_=tt(" ",e[0][m][1][1]);break;case 1:_=tt("\r",e[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+_,m=-1}o.push(c+i6[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ao(g[1][1],a,i),o.push(Io(u,s));break;case"PtgRefN":u=r?Ao(g[1][1],r,i):g[1][1],o.push(Io(u,s));break;case"PtgRef3d":f=g[1][1],u=Ao(g[1][2],a,i),p=wv(n,f,i),o.push(p+"!"+Io(u,s));break;case"PtgFunc":case"PtgFuncVar":var S=g[1][0],D=g[1][1];S||(S=0),S&=127;var k=S==0?[]:o.slice(-S);o.length-=S,D==="User"&&(D=k.shift()),o.push(D+"("+k.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":d=rv(g[1][1],r?{s:r}:a,i),o.push(hf(d,i));break;case"PtgArea":d=rv(g[1][1],a,i),o.push(hf(d,i));break;case"PtgArea3d":f=g[1][1],d=g[1][2],p=wv(n,f,i),o.push(p+"!"+hf(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],O=E?E.Name:"SH33TJSNAME"+String(h);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var N=g[1][1];h=g[1][2];var B;if(i.biff<=5)N<0&&(N=-N),n[N]&&(B=n[N][h]);else{var U="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][h]&&n[N][h].itab>0&&(U=n.SheetNames[n[N][h].itab-1]+"!"):U=n.SheetNames[h-1]+"!"),n[N]&&n[N][h])U+=n[N][h].Name;else if(n[0]&&n[0][h])U+=n[0][h].Name;else{var b=(y2(n,N,i)||"").split(";;");b[h-1]?U=b[h-1]:U+="SH33TJSERRX"}o.push(U);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var Y="(",me=")";if(m>=0){switch(_="",e[0][m][1][0]){case 2:Y=tt(" ",e[0][m][1][1])+Y;break;case 3:Y=tt("\r",e[0][m][1][1])+Y;break;case 4:me=tt(" ",e[0][m][1][1])+me;break;case 5:me=tt("\r",e[0][m][1][1])+me;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(Y+o.pop()+me);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:g[1][1],r:g[1][0]};var ie={c:r.c,r:r.r};if(n.sharedf[_e(u)]){var de=n.sharedf[_e(u)];o.push(Wt(de,a,ie,n,i))}else{var ce=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Wt(c[1],a,ie,n,i)),ce=!0;break}ce||o.push(g[1])}break;case"PtgArray":o.push("{"+n6(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&J.indexOf(e[0][v][0])==-1){g=e[0][m];var M=!0;switch(g[1][0]){case 4:M=!1;case 0:_=tt(" ",g[1][1]);break;case 5:M=!1;case 1:_=tt("\r",g[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((M?_:"")+o.pop()+(M?"":_)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function a6(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Gt(e,t-2)];var o=Ul(e,a,r);return t!==a+i&&(s=Bl(e,t-a-i,o,r)),e.l=n,[o,s]}function o6(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Gt(e,t-2)];var o=Ul(e,a,r);return t!==a+i&&(s=Bl(e,t-a-i,o,r)),e.l=n,[o,s]}function l6(e,t,r,n){var i=e.l+t,s=Ul(e,n,r),a;return i!==e.l&&(a=Bl(e,i-e.l,s,r)),[s,a]}function c6(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=Ul(e,s,r);return s==65535?[[],Gt(e,t-2)]:(t!==s+2&&(i=Bl(e,n-s-2,a,r)),[a,i])}function u6(e){var t;if(Nn(e,e.l+6)!==65535)return[Vt(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mf(e,t,r){var n=e.l+t,i=xn(e);r.biff==2&&++e.l;var s=u6(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=o6(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function _0(e,t,r){var n=e.read_shift(4),i=Ul(e,n,r),s=e.read_shift(4),a=s>0?Bl(e,s,i,r):null;return[i,a]}var f6=_0,y0=_0,h6=_0,d6=_0,p6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},E2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},m6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Tv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Do={},sa={};function Oo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function w2(e,t,r,n,i,s){try{n.cellNF&&(e.z=Ee[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=At(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ee[t]==null&&ts(g3[t]||"General",t),e.t==="e")e.w=e.w||Ss[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v);else if(e.t==="d"){var a=ir(e.v);(a|0)===a?e.w=a.toString(10):e.w=ul(a)}else{if(e.v===void 0)return"";e.w=ds(e.v,sa)}else e.t==="d"?e.w=Br(t,ir(e.v),sa):e.w=Br(t,e.v,sa)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Pu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Pu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function g6(e,t){var r=it(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Re(r))}var v6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,x6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_6=/<(?:\w:)?hyperlink [^>]*>/mg,y6=/"(\w*:\w*)"/,E6=/<(?:\w:)?col\b[^>]*[\/]?>/g,w6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,T6=/<(?:\w:)?pageMargins[^>]*\/>/g,T2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,k6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,S6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function C6(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(x6);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var h=c.match(T2);h?t1(h[0],o,i,r):(h=c.match(k6))&&A6(h[0],h[1]||"",o,i,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=c.slice(d,d+50).match(y6);p&&g6(o,p[1])}var m=c.match(S6);m&&m[1]&&O6(m[1],i);var _=[];if(t.cellStyles){var v=c.match(E6);v&&R6(_,v)}f&&P6(f[1],o,t,l,s,a);var x=u.match(w6);x&&(o["!autofilter"]=N6(x[0]));var g=[],S=u.match(v6);if(S)for(d=0;d!=S.length;++d)g[d]=it(S[d].slice(S[d].indexOf('"')+1));var D=u.match(_6);D&&I6(o,D,n);var k=u.match(T6);if(k&&(o["!margins"]=F6(ve(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Re(l)),t.sheetRows>0&&o["!ref"]){var E=it(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Re(E))}return _.length>0&&(o["!cols"]=_),g.length>0&&(o["!merges"]=g),o}function t1(e,t,r,n){var i=ve(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Oe(ze(i.codeName)))}function A6(e,t,r,n,i){t1(e.slice(0,e.indexOf(">")),r,n,i)}function I6(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=ve(ze(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Oe(s.location))):(s.Target="#"+Oe(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=it(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=_e({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function F6(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function R6(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=ve(t[n],!0);i.hidden&&(i.hidden=Ge(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Zp(i.width)),wa(i);s<=a;)e[s++]=Dt(i)}}function N6(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var D6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function O6(e,t){t.Views||(t.Views=[{}]),(e.match(D6)||[]).forEach(function(r,n){var i=ve(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Ge(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var P6=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=fl("v"),a=fl("f");return function(l,c,u,f,h,d){for(var p=0,m="",_=[],v=[],x=0,g=0,S=0,D="",k,E,O=0,N=0,B,U,b=0,Y=0,me=Array.isArray(d.CellXf),ie,de=[],ce=[],J=Array.isArray(c),M=[],te={},ue=!1,I=!!u.sheetStubs,V=l.split(t),L=0,P=V.length;L!=P;++L){m=V[L].trim();var X=m.length;if(X!==0){var ne=0;e:for(p=0;p<X;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(E=ve(m.slice(ne,p),!0),O=E.r!=null?parseInt(E.r,10):O+1,N=-1,u.sheetRows&&u.sheetRows<O)continue;te={},ue=!1,E.ht&&(ue=!0,te.hpt=parseFloat(E.ht),te.hpx=ml(te.hpt)),E.hidden=="1"&&(ue=!0,te.hidden=!0),E.outlineLevel!=null&&(ue=!0,te.level=+E.outlineLevel),ue&&(M[O-1]=te)}break;case"<":ne=p;break}if(ne>=p)break;if(E=ve(m.slice(ne,p),!0),O=E.r!=null?parseInt(E.r,10):O+1,N=-1,!(u.sheetRows&&u.sheetRows<O)){f.s.r>O-1&&(f.s.r=O-1),f.e.r<O-1&&(f.e.r=O-1),u&&u.cellStyles&&(te={},ue=!1,E.ht&&(ue=!0,te.hpt=parseFloat(E.ht),te.hpx=ml(te.hpt)),E.hidden=="1"&&(ue=!0,te.hidden=!0),E.outlineLevel!=null&&(ue=!0,te.level=+E.outlineLevel),ue&&(M[O-1]=te)),_=m.slice(p).split(e);for(var fe=0;fe!=_.length&&_[fe].trim().charAt(0)=="<";++fe);for(_=_.slice(fe),p=0;p!=_.length;++p)if(m=_[p].trim(),m.length!==0){if(v=m.match(r),x=p,g=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(x=0,D=v[1],g=0;g!=D.length&&!((S=D.charCodeAt(g)-64)<1||S>26);++g)x=26*x+S;--x,N=x}else++N;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,E=ve(m.slice(0,g),!0),E.r||(E.r=_e({r:O-1,c:N})),D=m.slice(g),k={t:""},(v=D.match(s))!=null&&v[1]!==""&&(k.v=Oe(v[1])),u.cellFormula){if((v=D.match(a))!=null&&v[1]!==""){if(k.f=Oe(ze(v[1])).replace(/\r\n/g,`
`),u.xlfn||(k.f=_v(k.f)),v[0].indexOf('t="array"')>-1)k.F=(D.match(i)||[])[1],k.F.indexOf(":")>-1&&de.push([it(k.F),k.F]);else if(v[0].indexOf('t="shared"')>-1){U=ve(v[0]);var se=Oe(ze(v[1]));u.xlfn||(se=_v(se)),ce[parseInt(U.si,10)]=[U,se,E.r]}}else(v=D.match(/<f[^>]*\/>/))&&(U=ve(v[0]),ce[U.si]&&(k.f=$8(ce[U.si][1],ce[U.si][2],E.r)));var Z=Zt(E.r);for(g=0;g<de.length;++g)Z.r>=de[g][0].s.r&&Z.r<=de[g][0].e.r&&Z.c>=de[g][0].s.c&&Z.c<=de[g][0].e.c&&(k.F=de[g][1])}if(E.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(I)k.t="z";else continue;else k.t=E.t||"n";switch(f.s.c>N&&(f.s.c=N),f.e.c<N&&(f.e.c=N),k.t){case"n":if(k.v==""||k.v==null){if(!I)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!I)continue;k.t="z"}else B=Do[parseInt(k.v,10)],k.v=B.t,k.r=B.r,u.cellHTML&&(k.h=B.h);break;case"str":k.t="s",k.v=k.v!=null?ze(k.v):"",u.cellHTML&&(k.h=Vp(k.v));break;case"inlineStr":v=D.match(n),k.t="s",v!=null&&(B=Jp(v[1]))?(k.v=B.t,u.cellHTML&&(k.h=B.h)):k.v="";break;case"b":k.v=Ge(k.v);break;case"d":u.cellDates?k.v=At(k.v,1):(k.v=ir(At(k.v,1)),k.t="n");break;case"e":(!u||u.cellText!==!1)&&(k.w=k.v),k.v=jw[k.v];break}if(b=Y=0,ie=null,me&&E.s!==void 0&&(ie=d.CellXf[E.s],ie!=null&&(ie.numFmtId!=null&&(b=ie.numFmtId),u.cellStyles&&ie.fillId!=null&&(Y=ie.fillId))),w2(k,b,Y,u,h,d),u.cellDates&&me&&k.t=="n"&&Pa(Ee[b])&&(k.t="d",k.v=v0(k.v)),E.cm&&u.xlmeta){var Ne=(u.xlmeta.Cell||[])[+E.cm-1];Ne&&Ne.type=="XLDAPR"&&(k.D=!0)}if(J){var R=Zt(E.r);c[R.r]||(c[R.r]=[]),c[R.r][R.c]=k}else c[E.r]=k}}}}M.length>0&&(c["!rows"]=M)}}();function L6(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var M6=ks;function b6(){}function B6(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=aD(e),r}function U6(e){var t=Ur(e);return[t]}function W6(e){var t=Ts(e);return[t]}function H6(e){var t=Ur(e),r=e.read_shift(1);return[t,r,"b"]}function V6(e){var t=Ts(e),r=e.read_shift(1);return[t,r,"b"]}function z6(e){var t=Ur(e),r=e.read_shift(1);return[t,r,"e"]}function j6(e){var t=Ts(e),r=e.read_shift(1);return[t,r,"e"]}function $6(e){var t=Ur(e),r=e.read_shift(4);return[t,r,"s"]}function G6(e){var t=Ts(e),r=e.read_shift(4);return[t,r,"s"]}function K6(e){var t=Ur(e),r=Vt(e);return[t,r,"n"]}function k2(e){var t=Ts(e),r=Vt(e);return[t,r,"n"]}function X6(e){var t=Ur(e),r=Yp(e);return[t,r,"n"]}function Y6(e){var t=Ts(e),r=Yp(e);return[t,r,"n"]}function q6(e){var t=Ur(e),r=Kp(e);return[t,r,"is"]}function Q6(e){var t=Ur(e),r=jt(e);return[t,r,"str"]}function J6(e){var t=Ts(e),r=jt(e);return[t,r,"str"]}function Z6(e,t,r){var n=e.l+t,i=Ur(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=y0(e,n-e.l,r);a[3]=Wt(o,null,i,r.supbooks,r)}else e.l=n;return a}function eM(e,t,r){var n=e.l+t,i=Ur(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=y0(e,n-e.l,r);a[3]=Wt(o,null,i,r.supbooks,r)}else e.l=n;return a}function tM(e,t,r){var n=e.l+t,i=Ur(e);i.r=r["!row"];var s=Vt(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=y0(e,n-e.l,r);a[3]=Wt(o,null,i,r.supbooks,r)}else e.l=n;return a}function rM(e,t,r){var n=e.l+t,i=Ur(e);i.r=r["!row"];var s=jt(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=y0(e,n-e.l,r);a[3]=Wt(o,null,i,r.supbooks,r)}else e.l=n;return a}var nM=ks;function iM(e,t){var r=e.l+t,n=ks(e),i=Xp(e),s=jt(e),a=jt(e),o=jt(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function sM(){}function aM(e,t,r){var n=e.l+t,i=Hw(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=f6(e,n-e.l,r);a[1]=o}else e.l=n;return a}function oM(e,t,r){var n=e.l+t,i=ks(e),s=[i];if(r.cellFormula){var a=d6(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}var lM=["left","right","top","bottom","header","footer"];function cM(e){var t={};return lM.forEach(function(r){t[r]=Vt(e)}),t}function uM(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function fM(){}function hM(){}function dM(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,p,m,_,v,x,g,S,D,k=[];o.biff=12,o["!row"]=0;var E=0,O=!1,N=[],B={},U=o.supbooks||i.supbooks||[[]];if(U.sharedf=B,U.arrayf=N,U.SheetNames=i.SheetNames||i.Sheets.map(function(J){return J.name}),!o.supbooks&&(o.supbooks=U,i.Names))for(var b=0;b<i.Names.length;++b)U[0][b+1]=i.Names[b];var Y=[],me=[],ie=!1;bu[16]={n:"BrtShortReal",f:k2};var de;if(Gn(e,function(M,te,ue){if(!h)switch(ue){case 148:c=M;break;case 0:d=M,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),S=Ot(_=d.r),o["!row"]=d.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=ml(M.hpt)),me[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:M[2]},M[2]){case"n":p.v=M[1];break;case"s":g=Do[M[1]],p.v=g.t,p.r=g.r;break;case"b":p.v=!!M[1];break;case"e":p.v=M[1],o.cellText!==!1&&(p.w=Ss[p.v]);break;case"str":p.t="s",p.v=M[1];break;case"is":p.t="s",p.v=M[1].t;break}if((m=a.CellXf[M[0].iStyleRef])&&w2(p,m.numFmtId,null,o,s,a),v=M[0].c==-1?v+1:M[0].c,o.dense?(l[_]||(l[_]=[]),l[_][v]=p):l[yt(v)+S]=p,o.cellFormula){for(O=!1,E=0;E<N.length;++E){var I=N[E];d.r>=I[0].s.r&&d.r<=I[0].e.r&&v>=I[0].s.c&&v<=I[0].e.c&&(p.F=Re(I[0]),O=!0)}!O&&M.length>3&&(p.f=M[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>v&&(u.s.c=v),u.e.r<d.r&&(u.e.r=d.r),u.e.c<v&&(u.e.c=v),o.cellDates&&m&&p.t=="n"&&Pa(Ee[m.numFmtId])){var V=Ji(p.v);V&&(p.t="d",p.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}de&&(de.type=="XLDAPR"&&(p.D=!0),de=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},v=M[0].c==-1?v+1:M[0].c,o.dense?(l[_]||(l[_]=[]),l[_][v]=p):l[yt(v)+S]=p,u.s.r>d.r&&(u.s.r=d.r),u.s.c>v&&(u.s.c=v),u.e.r<d.r&&(u.e.r=d.r),u.e.c<v&&(u.e.c=v),de&&(de.type=="XLDAPR"&&(p.D=!0),de=void 0);break;case 176:k.push(M);break;case 49:de=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var L=n["!id"][M.relId];for(L?(M.Target=L.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=L):M.relId==""&&(M.Target="#"+M.loc),_=M.rfx.s.r;_<=M.rfx.e.r;++_)for(v=M.rfx.s.c;v<=M.rfx.e.c;++v)o.dense?(l[_]||(l[_]=[]),l[_][v]||(l[_][v]={t:"z",v:void 0}),l[_][v].l=M):(x=_e({c:v,r:_}),l[x]||(l[x]={t:"z",v:void 0}),l[x].l=M);break;case 426:if(!o.cellFormula)break;N.push(M),D=o.dense?l[_][v]:l[yt(v)+S],D.f=Wt(M[1],u,{r:d.r,c:v},U,o),D.F=Re(M[0]);break;case 427:if(!o.cellFormula)break;B[_e(M[0].s)]=M[1],D=o.dense?l[_][v]:l[yt(v)+S],D.f=Wt(M[1],u,{r:d.r,c:v},U,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)Y[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ie||(ie=!0,Zp(M.w/256)),wa(Y[M.e+1]);break;case 161:l["!autofilter"]={ref:Re(M)};break;case 476:l["!margins"]=M;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),M.name&&(i.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),M.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!te.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Re(c||u)),o.sheetRows&&l["!ref"]){var ce=it(l["!ref"]);o.sheetRows<=+ce.e.r&&(ce.e.r=o.sheetRows-1,ce.e.r>u.e.r&&(ce.e.r=u.e.r),ce.e.r<ce.s.r&&(ce.s.r=ce.e.r),ce.e.c>u.e.c&&(ce.e.c=u.e.c),ce.e.c<ce.s.c&&(ce.s.c=ce.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Re(ce))}return k.length>0&&(l["!merges"]=k),Y.length>0&&(l["!cols"]=Y),me.length>0&&(l["!rows"]=me),l}function pM(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=Oe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function mM(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=pM(f);u.s.r=u.s.c=0,u.e.c=o,c=yt(o),h[0].forEach(function(d,p){a[c+Ot(p)]={t:"n",v:d,z:h[1]},l=p}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=Re(u)),a}function gM(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(T2);return o&&t1(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function vM(e,t){e.l+=10;var r=jt(e);return{name:r}}function xM(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Gn(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var S2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_M=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yM=[],EM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kv(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ge(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Sv(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ge(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function C2(e){Sv(e.WBProps,S2),Sv(e.CalcPr,EM),kv(e.WBView,_M),kv(e.Sheets,yM),sa.date1904=Ge(e.WBProps.date1904)}var wM="][*?/\\".split("");function TM(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wM.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var kM=/<\w+:workbook/;function SM(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(Kt,function(l,c){var u=ve(l);switch(vn(u[0])){case"<?xml":break;case"<workbook":l.match(kM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":S2.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ge(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=ze(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Oe(ze(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ze(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Ge(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Oe(ze(e.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),z3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return C2(r),r}function CM(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=bh(e),r.name=jt(e),r}function AM(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?jt(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function IM(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function FM(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=oD(e),a=h6(e,0,r),o=Xp(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function RM(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],bu[16]={n:"BrtFRTArchID$",f:IM},Gn(e,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Wt(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),C2(r),r.Names=s,r.supbooks=a,r}function NM(e,t,r){return t.slice(-4)===".bin"?RM(e,r):SM(e,r)}function DM(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?dM(e,n,r,i,s,a,o):C6(e,n,r,i,s,a,o)}function OM(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?xM(e,n,r,i,s):gM(e,n,r,i,s)}function PM(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?V8():z8()}function LM(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?W8():H8()}function MM(e,t,r,n){return t.slice(-4)===".bin"?n8(e,r,n):QP(e,r,n)}function bM(e,t,r){return h2(e,r)}function BM(e,t,r){return t.slice(-4)===".bin"?_P(e,r):vP(e,r)}function UM(e,t,r){return t.slice(-4)===".bin"?b8(e,r):D8(e,r)}function WM(e,t,r){return t.slice(-4)===".bin"?F8(e):A8(e)}function HM(e,t,r,n){return r.slice(-4)===".bin"?R8(e,t,r,n):void 0}function VM(e,t,r){return t.slice(-4)===".bin"?S8(e,t,r):C8(e,t,r)}var A2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,I2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hr(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(A2),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(I2),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function zM(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(A2),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(I2),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Po;function jM(e,t){var r=Po[e]||Oe(e);return r==="General"?ds(t):Br(r,t)}function $M(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ge(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=At(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Oe(t)]=i}function GM(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ss[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v):e.w=ds(e.v):e.w=jM(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Po[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Pa(n)){var i=Ji(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function KM(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=$P[n.Pattern]||n.Pattern)}e[t.ID]=t}function XM(e,t,r,n,i,s,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var d=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&d.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ge(e);break;case"String":n.t="s",n.r=Kg(Oe(e)),n.v=e.indexOf("<")>-1?Oe(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(At(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Oe(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jw[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Kg(t||e));break}if(GM(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Oe(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ia(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ia("RC:RC",i):n.ArrayRange&&(n.F=ia(n.ArrayRange,i),l.push([it(n.F),n.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(n.F=l[p][1]);c.cellStyles&&(d.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function YM(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vf(e,t){var r=t||{};gw();var n=ao(zp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ze(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Dt(r);return a.type="string",dl.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(at){i.indexOf("<"+at)>=0&&(s=!0)}),s)return i5(n,r);Po={"General Number":"General","General Date":Ee[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ee[15],"Short Date":Ee[14],"Long Time":Ee[19],"Medium Time":Ee[18],"Short Time":Ee[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ee[2],Standard:Ee[4],Percent:Ee[10],Scientific:Ee[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},d="",p={},m={},_=Hr('<Data ss:Type="String">'),v=0,x=0,g=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},k={},E="",O=0,N=[],B={},U={},b=0,Y=[],me=[],ie={},de=[],ce,J=!1,M=[],te=[],ue={},I=0,V=0,L={Sheets:[],WBProps:{date1904:!1}},P={};hl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";o=hl.exec(n);)switch(o[3]=(X=o[3]).toLowerCase()){case"data":if(X=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?XM(n.slice(v,o.index),E,_,l[l.length-1][0]=="comment"?ie:p,{c:x,r:g},D,de[x],m,M,r):(E="",_=Hr(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(me.length>0&&(p.c=me),(!r.sheetRows||r.sheetRows>g)&&p.v!==void 0&&(r.dense?(h[g]||(h[g]=[]),h[g][x]=p):h[yt(x)+Ot(g)]=p),p.HRef&&(p.l={Target:Oe(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(I=x+(parseInt(p.MergeAcross,10)|0),V=g+(parseInt(p.MergeDown,10)|0),N.push({s:{c:x,r:g},e:{c:I,r:V}})),!r.sheetStubs)p.MergeAcross?x=I+1:++x;else if(p.MergeAcross||p.MergeDown){for(var ne=x;ne<=I;++ne)for(var fe=g;fe<=V;++fe)(ne>x||fe>g)&&(r.dense?(h[fe]||(h[fe]=[]),h[fe][ne]={t:"z"}):h[yt(ne)+Ot(fe)]={t:"z"});x=I+1}else++x;else p=zM(o[0]),p.Index&&(x=+p.Index-1),x<S.s.c&&(S.s.c=x),x>S.e.c&&(S.e.c=x),o[0].slice(-2)==="/>"&&++x,me=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<S.s.r&&(S.s.r=g),g>S.e.r&&(S.e.r=g),o[0].slice(-2)==="/>"&&(m=Hr(o[0]),m.Index&&(g=+m.Index-1)),x=0,++g):(m=Hr(o[0]),m.Index&&(g=+m.Index-1),ue={},(m.AutoFitHeight=="0"||m.Height)&&(ue.hpx=parseInt(m.Height,10),ue.hpt=f2(ue.hpx),te[g]=ue),m.Hidden=="1"&&(ue.hidden=!0,te[g]=ue));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(d),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=Re(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=Re(S))),N.length&&(h["!merges"]=N),de.length>0&&(h["!cols"]=de),te.length>0&&(h["!rows"]=te),u[d]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=x=0,l.push([o[3],!1]),c=Hr(o[0]),d=Oe(c.Name),h=r.dense?[]:{},N=[],M=[],te=[],P={name:d,Hidden:0},L.Sheets.push(P);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),de=[],J=!1}break;case"style":o[1]==="/"?KM(D,k,r):k=Hr(o[0]);break;case"numberformat":k.nf=Oe(Hr(o[0]).Format||"General"),Po[k.nf]&&(k.nf=Po[k.nf]);for(var se=0;se!=392&&Ee[se]!=k.nf;++se);if(se==392){for(se=57;se!=392;++se)if(Ee[se]==null){ts(k.nf,se);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ce=Hr(o[0]),ce.Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!J&&ce.wpx>10){J=!0,Qt=c2;for(var Z=0;Z<de.length;++Z)de[Z]&&wa(de[Z])}J&&wa(ce),de[ce.Index-1||de.length]=ce;for(var Ne=0;Ne<+ce.Span;++Ne)de[de.length]=Dt(ce);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var R=ve(o[0]),st={Name:R.Name,Ref:ia(R.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(st.Sheet=L.Sheets.length-1),L.Names.push(st);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(O,o.index):O=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Hr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?DD(B,X,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));YM(ie),me.push(ie)}else l.push([o[3],!1]),c=Hr(o[0]),ie={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Pe=Hr(o[0]);h["!autofilter"]={ref:ia(Pe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Nv(n,r);var Ue=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ue=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ue=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ue=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ue=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else b=o.index+o[0].length;break;case"header":h["!margins"]||Oo(h["!margins"]={},"xlml"),isNaN(+ve(o[0]).Margin)||(h["!margins"].header=+ve(o[0]).Margin);break;case"footer":h["!margins"]||Oo(h["!margins"]={},"xlml"),isNaN(+ve(o[0]).Margin)||(h["!margins"].footer=+ve(o[0]).Margin);break;case"pagemargins":var Se=ve(o[0]);h["!margins"]||Oo(h["!margins"]={},"xlml"),isNaN(+Se.Top)||(h["!margins"].top=+Se.Top),isNaN(+Se.Left)||(h["!margins"].left=+Se.Left),isNaN(+Se.Right)||(h["!margins"].right=+Se.Right),isNaN(+Se.Bottom)||(h["!margins"].bottom=+Se.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ue=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ue=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ue=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ue=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ue=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ue=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ue=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ue=!1}break;case"smarttags":break;default:Ue=!1;break}if(Ue||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$M(U,X,Y,n.slice(b,o.index)):(Y=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var oe={};return!r.bookSheets&&!r.bookProps&&(oe.Sheets=u),oe.SheetNames=f,oe.Workbook=L,oe.SSF=Dt(Ee),oe.Props=B,oe.Custprops=U,oe}function Hh(e,t){switch(i1(t=t||{}),t.type||"base64"){case"base64":return vf(wr(e),t);case"binary":case"buffer":case"file":return vf(e,t);case"array":return vf(ws(e),t)}}function qM(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=uD(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=fD(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var QM=[60,1084,2066,2165,2175];function JM(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Nn(r,r.l),c=Vh[l],u=0;c!=null&&QM.indexOf(l)>-1;)s=Nn(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=Vh[l=Nn(r,r.l)];var f=oi(a);Ft(f,0);var h=0;f.lens=[];for(var d=0;d<a.length;++d)f.lens.push(h),h+=a[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function on(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ee[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ss[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ul(e.v):e.w=ds(e.v):e.w=Br(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Pa(Ee[n]||String(n))){var i=Ji(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function mc(e,t,r){return{v:e,ixfe:t,t:r}}function ZM(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,l=[],c="",u={},f,h="",d,p,m,_,v={},x=[],g,S,D=[],k=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},N=function(we){return we<8?rs[we]:we<64&&k[we-8]||rs[we]},B=function(we,ot,Cr){var pt=ot.XF.data;if(!(!pt||!pt.patternType||!Cr||!Cr.cellStyles)){ot.s={},ot.s.patternType=pt.patternType;var Hi;(Hi=pl(N(pt.icvFore)))&&(ot.s.fgColor={rgb:Hi}),(Hi=pl(N(pt.icvBack)))&&(ot.s.bgColor={rgb:Hi})}},U=function(we,ot,Cr){if(!(ue>1)&&!(Cr.sheetRows&&we.r>=Cr.sheetRows)){if(Cr.cellStyles&&ot.XF&&ot.XF.data&&B(we,ot,Cr),delete ot.ixfe,delete ot.XF,f=we,h=_e(we),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),we.r<a.s.r&&(a.s.r=we.r),we.c<a.s.c&&(a.s.c=we.c),we.r+1>a.e.r&&(a.e.r=we.r+1),we.c+1>a.e.c&&(a.e.c=we.c+1),Cr.cellFormula&&ot.f){for(var pt=0;pt<x.length;++pt)if(!(x[pt][0].s.c>we.c||x[pt][0].s.r>we.r)&&!(x[pt][0].e.c<we.c||x[pt][0].e.r<we.r)){ot.F=Re(x[pt][0]),(x[pt][0].s.c!=we.c||x[pt][0].s.r!=we.r)&&delete ot.f,ot.f&&(ot.f=""+Wt(x[pt][1],a,we,M,b));break}}Cr.dense?(i[we.r]||(i[we.r]=[]),i[we.r][we.c]=ot):i[h]=ot}},b={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(b.password=t.password);var Y,me=[],ie=[],de=[],ce=[],J=!1,M=[];M.SheetNames=b.snames,M.sharedf=b.sharedf,M.arrayf=b.arrayf,M.names=[],M.XTI=[];var te=0,ue=0,I=0,V=[],L=[],P;b.codepage=1200,Yr(1200);for(var X=!1;e.l<e.length-1;){var ne=e.l,fe=e.read_shift(2);if(fe===0&&te===10)break;var se=e.l===e.length?0:e.read_shift(2),Z=Vh[fe];if(Z&&Z.f){if(t.bookSheets&&te===133&&fe!==133)break;if(te=fe,Z.r===2||Z.r==12){var Ne=e.read_shift(2);if(se-=2,!b.enc&&Ne!==fe&&((Ne&255)<<8|Ne>>8)!==fe)throw new Error("rt mismatch: "+Ne+"!="+fe);Z.r==12&&(e.l+=10,se-=10)}var R={};if(fe===10?R=Z.f(e,se,b):R=JM(fe,Z,e,se,b),ue==0&&[9,521,1033,2057].indexOf(te)===-1)continue;switch(fe){case 34:r.opts.Date1904=E.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=R,!t.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=R;break;case 66:var st=Number(R);switch(st){case 21010:st=1200;break;case 32768:st=1e4;break;case 32769:st=1252;break}Yr(b.codepage=st),X=!0;break;case 317:b.rrtabid=R;break;case 25:b.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:b.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(i["!type"]="dialog"),R.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),R.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:D.push(R);break;case 430:M.push([R]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(R);break;case 24:case 536:P={Name:R.Name,Ref:Wt(R.rgce,a,null,M,b)},R.itab>0&&(P.Sheet=R.itab-1),M.names.push(P),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(L[R.itab-1]={ref:Re(R.rgce[0][0][1][2])});break;case 22:b.ExternCount=R;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(R),M.XTI=M.XTI.concat(R);break;case 2196:if(b.biff<8)break;P!=null&&(P.Comment=R[1]);break;case 18:i["!protect"]=R;break;case 19:R!==0&&b.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,b.snames.push(R.name);break;case 10:{if(--ue)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Re(a),t.sheetRows&&t.sheetRows<=a.e.r){var Pe=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Re(a),a.e.r=Pe}a.e.r++,a.e.c++}me.length>0&&(i["!merges"]=me),ie.length>0&&(i["!objects"]=ie),de.length>0&&(i["!cols"]=de),ce.length>0&&(i["!rows"]=ce),E.Sheets.push(O)}c===""?u=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),b.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(b.biff=5,X=!0,Yr(b.codepage=28591)),b.biff==8&&R.BIFFVer==0&&R.dt==16&&(b.biff=2),ue++)break;if(i=t.dense?[]:{},b.biff<8&&!X&&(X=!0,Yr(b.codepage=t.codepage||1252)),b.biff<5||R.BIFFVer==0&&R.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Ue={pos:e.l-se,name:c};s[Ue.pos]=Ue,b.snames.push(c)}else c=(s[ne]||{name:""}).name;R.dt==32&&(i["!type"]="chart"),R.dt==64&&(i["!type"]="macro"),me=[],ie=[],b.arrayf=x=[],de=[],ce=[],J=!1,O={Hidden:(s[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[R.r]||[])[R.c]:i[_e({c:R.c,r:R.r})])&&++R.c,g={ixfe:R.ixfe,XF:D[R.ixfe]||{},v:R.val,t:"n"},I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:R.c,r:R.r},g,t);break;case 5:case 517:g={ixfe:R.ixfe,XF:D[R.ixfe],v:R.val,t:R.t},I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:R.c,r:R.r},g,t);break;case 638:g={ixfe:R.ixfe,XF:D[R.ixfe],v:R.rknum,t:"n"},I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:R.c,r:R.r},g,t);break;case 189:for(var Se=R.c;Se<=R.C;++Se){var oe=R.rkrec[Se-R.c][0];g={ixfe:oe,XF:D[oe],v:R.rkrec[Se-R.c][1],t:"n"},I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:Se,r:R.r},g,t)}break;case 6:case 518:case 1030:{if(R.val=="String"){o=R;break}if(g=mc(R.val,R.cell.ixfe,R.tt),g.XF=D[g.ixfe],t.cellFormula){var at=R.formula;if(at&&at[0]&&at[0][0]&&at[0][0][0]=="PtgExp"){var Sr=at[0][0][1][0],nn=at[0][0][1][1],_n=_e({r:Sr,c:nn});v[_n]?g.f=""+Wt(R.formula,a,R.cell,M,b):g.F=((t.dense?(i[Sr]||[])[nn]:i[_n])||{}).F}else g.f=""+Wt(R.formula,a,R.cell,M,b)}I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U(R.cell,g,t),o=R}break;case 7:case 519:if(o)o.val=R,g=mc(R,o.cell.ixfe,"s"),g.XF=D[g.ixfe],t.cellFormula&&(g.f=""+Wt(o.formula,a,o.cell,M,b)),I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(R);var ba=_e(R[0].s);if(d=t.dense?(i[R[0].s.r]||[])[R[0].s.c]:i[ba],t.cellFormula&&d){if(!o||!ba||!d)break;d.f=""+Wt(R[1],a,R[0],M,b),d.F=Re(R[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[_e(o.cell)]=R[0],d=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[_e(o.cell)],(d||{}).f=""+Wt(R[0],a,f,M,b)}}break;case 253:g=mc(l[R.isst].t,R.ixfe,"s"),l[R.isst].h&&(g.h=l[R.isst].h),g.XF=D[g.ixfe],I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:R.c,r:R.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:R.ixfe,XF:D[R.ixfe],t:"z"},I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:R.c,r:R.r},g,t));break;case 190:if(t.sheetStubs)for(var Kn=R.c;Kn<=R.C;++Kn){var mr=R.ixfe[Kn-R.c];g={ixfe:mr,XF:D[mr],t:"z"},I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:Kn,r:R.r},g,t)}break;case 214:case 516:case 4:g=mc(R.val,R.ixfe,"s"),g.XF=D[g.ixfe],I>0&&(g.z=V[g.ixfe>>8&63]),on(g,t,r.opts.Date1904),U({c:R.c,r:R.r},g,t);break;case 0:case 512:ue===1&&(a=R);break;case 252:l=R;break;case 1054:if(b.biff==4){V[I++]=R[1];for(var yn=0;yn<I+163&&Ee[yn]!=R[1];++yn);yn>=163&&ts(R[1],I+163)}else ts(R[1],R[0]);break;case 30:{V[I++]=R;for(var Xn=0;Xn<I+163&&Ee[Xn]!=R;++Xn);Xn>=163&&ts(R,I+163)}break;case 229:me=me.concat(R);break;case 93:ie[R.cmo[0]]=b.lastobj=R;break;case 438:b.lastobj.TxO=R;break;case 127:b.lastobj.ImData=R;break;case 440:for(_=R[0].s.r;_<=R[0].e.r;++_)for(m=R[0].s.c;m<=R[0].e.c;++m)d=t.dense?(i[_]||[])[m]:i[_e({c:m,r:_})],d&&(d.l=R[1]);break;case 2048:for(_=R[0].s.r;_<=R[0].e.r;++_)for(m=R[0].s.c;m<=R[0].e.c;++m)d=t.dense?(i[_]||[])[m]:i[_e({c:m,r:_})],d&&d.l&&(d.l.Tooltip=R[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;d=t.dense?(i[R[0].r]||[])[R[0].c]:i[_e(R[0])];var Ba=ie[R[2]];d||(t.dense?(i[R[0].r]||(i[R[0].r]=[]),d=i[R[0].r][R[0].c]={t:"z"}):d=i[_e(R[0])]={t:"z"},a.e.r=Math.max(a.e.r,R[0].r),a.s.r=Math.min(a.s.r,R[0].r),a.e.c=Math.max(a.e.c,R[0].c),a.s.c=Math.min(a.s.c,R[0].c)),d.c||(d.c=[]),p={a:R[1],t:Ba.TxO.t},d.c.push(p)}break;case 2173:E8(D[R.ixfe],R.ext);break;case 125:{if(!b.cellStyles)break;for(;R.e>=R.s;)de[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},J||(J=!0,Zp(R.w/256)),wa(de[R.e+1])}break;case 520:{var Xt={};R.level!=null&&(ce[R.r]=Xt,Xt.level=R.level),R.hidden&&(ce[R.r]=Xt,Xt.hidden=!0),R.hpt&&(ce[R.r]=Xt,Xt.hpt=R.hpt,Xt.hpx=ml(R.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Oo(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=R;break;case 161:i["!margins"]||Oo(i["!margins"]={}),i["!margins"].header=R.header,i["!margins"].footer=R.footer;break;case 574:R.RTL&&(E.Views[0].RTL=!0);break;case 146:k=R;break;case 2198:Y=R;break;case 140:S=R;break;case 442:c?O.CodeName=R||O.name:E.WBProps.CodeName=R||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=se}return r.SheetNames=mn(s).sort(function(sn,we){return Number(sn)-Number(we)}).map(function(sn){return s[sn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&L.forEach(function(sn,we){r.Sheets[r.SheetNames[we]]["!autofilter"]=sn}),r.Strings=l,r.SSF=Dt(Ee),b.enc&&(r.Encryption=b.enc),Y&&(r.Themes=Y),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),M.names.length>0&&(E.Names=M.names),r.Workbook=E,r}var Cv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function e5(e,t,r){var n=Fe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=cv(n,vD,Cv.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Fe.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=cv(a,xD,Cv.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Gw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function F2(e,t){t||(t={}),i1(t),iw(),t.codepage&&Mp(t.codepage);var r,n;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),n=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=Kr(wr(e));break;case"binary":e=Kr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ft(e,0),n={content:e}}var i,s;if(r&&qM(r),t.bookProps&&!t.bookSheets)i={};else{var a=Ie?"buffer":"array";if(n&&n.content)i=ZM(n.content,t);else if((s=Fe.find(e,"PerfectOffice_MAIN"))&&s.content)i=No.to_workbook(s.content,(t.type=a,t));else if((s=Fe.find(e,"NativeContent_MAIN"))&&s.content)i=No.to_workbook(s.content,(t.type=a,t));else throw(s=Fe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=U8(e))}var o={};return e.FullPaths&&e5(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var bu={0:{f:L6},1:{f:U6},2:{f:X6},3:{f:z6},4:{f:H6},5:{f:K6},6:{f:Q6},7:{f:$6},8:{f:rM},9:{f:tM},10:{f:Z6},11:{f:eM},12:{f:W6},13:{f:Y6},14:{f:j6},15:{f:V6},16:{f:k2},17:{f:J6},18:{f:G6},19:{f:Kp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:FM},40:{},42:{},43:{f:ZP},44:{f:JP},45:{f:e8},46:{f:r8},47:{f:t8},48:{},49:{f:nD},50:{},51:{f:T8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:i2},62:{f:q6},63:{f:I8},64:{f:fM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:uM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:B6},148:{f:M6,p:16},151:{f:sM},152:{},153:{f:AM},154:{},155:{},156:{f:CM},157:{},158:{},159:{T:1,f:xP},160:{T:-1},161:{T:1,f:ks},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:w8},336:{T:-1},337:{f:k8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:n2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aM},427:{f:oM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:b6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:iM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:M8},633:{T:1},634:{T:-1},635:{T:1,f:L8},636:{T:-1},637:{f:sD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:vM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vh={6:{f:mf},10:{f:Qn},12:{f:ht},13:{f:ht},14:{f:lt},15:{f:lt},16:{f:Vt},17:{f:lt},18:{f:lt},19:{f:ht},20:{f:dv},21:{f:dv},23:{f:n2},24:{f:mv},25:{f:lt},26:{},27:{},28:{f:OO},29:{},34:{f:lt},35:{f:pv},38:{f:Vt},39:{f:Vt},40:{f:Vt},41:{f:Vt},42:{f:lt},43:{f:lt},47:{f:bP},49:{f:pO},51:{f:ht},60:{},61:{f:fO},64:{f:lt},65:{f:dO},66:{f:ht},77:{},80:{},81:{},82:{},85:{f:ht},89:{},90:{},91:{},92:{f:nO},93:{f:LO},94:{},95:{f:lt},96:{},97:{},99:{f:lt},125:{f:i2},128:{f:kO},129:{f:iO},130:{f:ht},131:{f:lt},132:{f:lt},133:{f:sO},134:{},140:{f:HO},141:{f:ht},144:{},146:{f:zO},151:{},152:{},153:{},154:{},155:{},156:{f:ht},157:{},158:{},160:{f:XO},161:{f:$O},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yO},190:{f:EO},193:{f:Qn},197:{},198:{},199:{},200:{},201:{},202:{f:lt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ht},220:{},221:{f:lt},222:{},224:{f:TO},225:{f:rO},226:{f:Qn},227:{},229:{f:PO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aO},253:{f:mO},255:{f:oO},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Qw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:lt},353:{f:Qn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:CO},431:{f:lt},432:{},433:{},434:{},437:{},438:{f:BO},439:{f:lt},440:{f:UO},441:{},442:{f:Ml},443:{},444:{f:ht},445:{},446:{},448:{f:Qn},449:{f:uO,r:2},450:{f:Qn},512:{f:fv},513:{f:KO},515:{f:SO},516:{f:gO},517:{f:hv},519:{f:YO},520:{f:lO},523:{},545:{f:gv},549:{f:uv},566:{},574:{f:hO},638:{f:_O},659:{},1048:{},1054:{f:vO},1084:{},1212:{f:RO},2048:{f:WO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:hc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:jO,r:12},2173:{f:y8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:lt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:FO,r:12},2197:{},2198:{f:p8,r:12},2199:{},2200:{},2201:{},2202:{f:NO,r:12},2203:{f:Qn},2204:{},2205:{},2206:{},2207:{},2211:{f:cO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ht},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:GO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:VO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fv},1:{},2:{f:ZO},3:{f:JO},4:{f:QO},5:{f:hv},7:{f:eP},8:{},9:{f:hc},11:{},22:{f:ht},30:{f:xO},31:{},32:{},33:{f:gv},36:{},37:{f:uv},50:{f:tP},62:{},52:{},67:{},68:{f:ht},69:{},86:{},126:{},127:{f:qO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rP},223:{},234:{},354:{},421:{},518:{f:mf},521:{f:hc},536:{f:mv},547:{f:pv},561:{},579:{},1030:{f:mf},1033:{f:hc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vr(e,t,r,n){var i=t;if(!isNaN(i)){var s=(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Bw(r)&&e.push(r)}}function Av(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,l=S3(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var m=l[a].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var x=v[o].trim();if(x.match(/<t[dh]/i)){for(var g=x,S=0;g.charAt(0)=="<"&&(S=g.indexOf(">"))>-1;)g=g.slice(S+1);for(var D=0;D<p.length;++D){var k=p[D];k.s.c==u&&k.s.r<c&&c<=k.e.r&&(u=k.e.c+1,D=-1)}var E=ve(x.slice(0,x.indexOf(">")));h=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||h>1)&&p.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var O=E.t||E["data-t"]||"";if(!g.length){u+=h;continue}if(g=Sw(g),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!g.length){u+=h;continue}var N={t:"s",v:g};r.raw||!g.trim().length||O=="s"||(g==="TRUE"?N={t:"b",v:!0}:g==="FALSE"?N={t:"b",v:!1}:isNaN(en(g))?isNaN(Ea(g).getDate())||(N={t:"d",v:At(g)},r.cellDates||(N={t:"n",v:ir(N.v)}),N.z=r.dateNF||Ee[14]):N={t:"n",v:en(g)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=N):n[_e({r:c,c:u})]=N,u+=h}}}}return n["!ref"]=Re(d),p.length&&(n["!merges"]=p),n}function t5(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=_e({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||Vp(f.w||(zn(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(H3("td",h,d))}}var p="<tr>";return p+s.join("")+"</tr>"}var r5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',n5="</body></html>";function i5(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Wi(Av(r[0],t),t);var n=a1();return r.forEach(function(i,s){o1(n,Av(i,t),"Sheet"+(s+1))}),n}function s5(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function a5(e,t){var r=t||{},n=r.header!=null?r.header:r5,i=r.footer!=null?r.footer:n5,s=[n],a=La(e["!ref"]);r.dense=Array.isArray(e),s.push(s5(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(t5(e,a,o,r));return s.push("</table>"+i),s.join("")}function R2(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Zt(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=La(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,_=0,v=0,x=0,g=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var S=o[p];if(Iv(S)){if(n.display)continue;d[m]={hidden:!0}}var D=S.children;for(_=v=0;_<D.length;++_){var k=D[_];if(!(n.display&&Iv(k))){var E=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):Sw(k.innerHTML),O=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var N=f[h];N.s.c==v+s&&N.s.r<m+i&&m+i<=N.e.r&&(v=N.e.c+1-s,h=-1)}g=+k.getAttribute("colspan")||1,((x=+k.getAttribute("rowspan")||1)>1||g>1)&&f.push({s:{r:m+i,c:v+s},e:{r:m+i+(x||1)-1,c:v+s+(g||1)-1}});var B={t:"s",v:E},U=k.getAttribute("data-t")||k.getAttribute("t")||"";E!=null&&(E.length==0?B.t=U||"z":n.raw||E.trim().length==0||U=="s"||(E==="TRUE"?B={t:"b",v:!0}:E==="FALSE"?B={t:"b",v:!1}:isNaN(en(E))?isNaN(Ea(E).getDate())||(B={t:"d",v:At(E)},n.cellDates||(B={t:"n",v:ir(B.v)}),B.z=n.dateNF||Ee[14]):B={t:"n",v:en(E)})),B.z===void 0&&O!=null&&(B.z=O);var b="",Y=k.getElementsByTagName("A");if(Y&&Y.length)for(var me=0;me<Y.length&&!(Y[me].hasAttribute("href")&&(b=Y[me].getAttribute("href"),b.charAt(0)!="#"));++me);b&&b.charAt(0)!="#"&&(B.l={Target:b}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][v+s]=B):e[_e({c:v+s,r:m+i})]=B,c.e.c<v+s&&(c.e.c=v+s),v+=g}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=Re(c),m>=l&&(e["!fullref"]=Re((c.e.r=o.length-p+m-1+i,c))),e}function N2(e,t){var r=t||{},n=r.dense?[]:{};return R2(n,e,t)}function o5(e,t){return Wi(N2(e,t),t)}function Iv(e){var t="",r=l5(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function l5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function c5(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Oe(t.replace(/<[^>]*>/g,""));return[r]}var Fv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function D2(e,t){var r=t||{},n=zp(e),i=[],s,a,o={name:""},l="",c=0,u,f,h={},d=[],p=r.dense?[]:{},m,_,v={value:""},x="",g=0,S=[],D=-1,k=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,N={},B=[],U={},b=0,Y=0,me=[],ie=1,de=1,ce=[],J={Names:[]},M={},te=["",""],ue=[],I={},V="",L=0,P=!1,X=!1,ne=0;for(hl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=hl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=Re(E):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Re(E)),B.length&&(p["!merges"]=B),me.length&&(p["!rows"]=me),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=p,X=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=ve(m[0],!1),D=k=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=r.dense?[]:{},B=[],me=[],X=!0);break;case"table-row-group":m[1]==="/"?--O:++O;break;case"table-row":case"":if(m[1]==="/"){D+=ie,ie=1;break}if(f=ve(m[0],!1),f.?D=f.-1:D==-1&&(D=0),ie=+f["number-rows-repeated"]||1,ie<10)for(ne=0;ne<ie;++ne)O>0&&(me[D+ne]={level:O});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(p[D]||(p[D]=[]),p[D][k]={t:"z"}):p[_e({r:D,c:k})]={t:"z"}),x="",S=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++k,v=ve(m[0],!1),de=parseInt(v["number-columns-repeated"]||"1",10),_={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(_.f=Tv(Oe(v.formula))),(v.||v["value-type"])=="string"&&(_.t="s",_.v=Oe(v["string-value"]||""),r.dense?(p[D]||(p[D]=[]),p[D][k]=_):p[_e({r:D,c:k})]=_),k+=de-1;else if(m[1]!=="/"){++k,x="",g=0,S=[],de=1;var fe=ie?D+ie-1:D;if(k>E.e.c&&(E.e.c=k),k<E.s.c&&(E.s.c=k),D<E.s.r&&(E.s.r=D),fe>E.e.r&&(E.e.r=fe),v=ve(m[0],!1),ue=[],I={},_={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Oe(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(b=parseInt(v["number-matrix-rows-spanned"],10)||0,Y=parseInt(v["number-matrix-columns-spanned"],10)||0,U={s:{r:D,c:k},e:{r:D+b-1,c:k+Y-1}},_.F=Re(U),ce.push([U,_.F])),v.formula)_.f=Tv(v.formula);else for(ne=0;ne<ce.length;++ne)D>=ce[ne][0].s.r&&D<=ce[ne][0].e.r&&k>=ce[ne][0].s.c&&k<=ce[ne][0].e.c&&(_.F=ce[ne][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(b=parseInt(v["number-rows-spanned"],10)||0,Y=parseInt(v["number-columns-spanned"],10)||0,U={s:{r:D,c:k},e:{r:D+b-1,c:k+Y-1}},B.push(U)),v["number-columns-repeated"]&&(de=parseInt(v["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Ge(v["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(v.value);break;case"percentage":_.t="n",_.v=parseFloat(v.value);break;case"currency":_.t="n",_.v=parseFloat(v.value);break;case"date":_.t="d",_.v=At(v["date-value"]),r.cellDates||(_.t="n",_.v=ir(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=w3(v["time-value"])/86400,r.cellDates&&(_.t="d",_.v=v0(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(v.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",v["string-value"]!=null&&(x=Oe(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(P=!1,_.t==="s"&&(_.v=x||"",S.length&&(_.R=S),P=g==0),M.Target&&(_.l=M),ue.length>0&&(_.c=ue,ue=[]),x&&r.cellText!==!1&&(_.w=x),P&&(_.t="z",delete _.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var se=0;se<ie;++se){if(de=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[D+se]||(p[D+se]=[]),p[D+se][k]=se==0?_:Dt(_);--de>0;)p[D+se][k+de]=Dt(_);else for(p[_e({r:D+se,c:k})]=_;--de>0;)p[_e({r:D+se,c:k+de})]=Dt(_);E.e.c<=k&&(E.e.c=k)}de=parseInt(v["number-columns-repeated"]||"1",10),k+=de-1,de=0,_={},x="",S=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;I.t=x,S.length&&(I.R=S),I.a=V,ue.push(I)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);V="",L=0,x="",g=0,S=[];break;case"creator":m[1]==="/"?V=n.slice(L,m.index):L=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);x="",g=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(N[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=ve(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ve(m[0],!1),l+=Fv[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ve(m[0],!1),l+=Fv[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":a=ve(m[0],!1),te=gf(a["cell-range-address"]);var Z={Name:a.name,Ref:te[0]+"!"+te[1]};X&&(Z.Sheet=d.length),J.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var Ne=c5(n.slice(g,m.index));x=(x.length>0?x+`
`:"")+Ne[0]}else ve(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{te=gf(ve(m[0])["target-range-address"]),h[te[0]]["!autofilter"]={ref:te[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(M=ve(m[0],!1),!M.href)break;M.Target=Oe(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(te=gf(M.Target.slice(1)),M.Target="#"+te[0]+"!"+te[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var R={Sheets:h,SheetNames:d,Workbook:J};return r.bookSheets&&delete R.Sheets,R}function Rv(e,t){t=t||{},Fr(e,"META-INF/manifest.xml")&&SD(ft(e,"META-INF/manifest.xml"),t);var r=xr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=D2(ze(r),t);return Fr(e,"meta.xml")&&(n.Props=$w(ft(e,"meta.xml"))),n}function Nv(e,t){return D2(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function r1(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ze(ws(e))}function jh(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Dv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function u5(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function gl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Et(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=gl(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=gl(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function n1(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function f5(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=gl(e,n),s=zt(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Et(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=zt(o.data),c=Et(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=Et(s[3][0].data)>>>0>0),r.push(a)}return r}function h5(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=gl(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[jh(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=jh(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function d5(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(h5(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return jh(t)}function p5(e,t,r,n){var i=r1(e),s=i.getUint32(4,!0),a=(n>1?12:8)+Dv(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Dv(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function m5(e,t,r){var n=r1(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=u5(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function g5(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return p5(e,t,r,e[0]);case 5:return m5(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ai(e){var t=zt(e);return gl(t[1][0].data)}function Ov(e,t){var r=zt(t.data),n=Et(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=zt(a.data),l=Et(o[1][0].data)>>>0;switch(n){case 1:s[l]=zh(o[3][0].data);break;case 8:{var c=e[Ai(o[9][0].data)][0],u=zt(c.data),f=e[Ai(u[1][0].data)][0],h=Et(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=zt(f.data);s[l]=d[3].map(function(p){return zh(p.data)}).join("")}break}}),s}function v5(e,t){var r,n,i,s,a,o,l,c,u,f,h,d,p,m,_=zt(e),v=Et(_[1][0].data)>>>0,x=Et(_[2][0].data)>>>0,g=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Et(_[8][0].data)>0||!1,S,D;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&t!=0)S=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,D=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=_[4])==null?void 0:u[0])!=null&&f.data&&t!=1)S=(d=(h=_[4])==null?void 0:h[0])==null?void 0:d.data,D=(m=(p=_[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=g?4:1,E=r1(S),O=[],N=0;N<S.length/2;++N){var B=E.getUint16(N*2,!0);B<65535&&O.push([N,B])}if(O.length!=x)throw"Expected ".concat(x," cells, found ").concat(O.length);var U=[];for(N=0;N<O.length-1;++N)U[O[N][0]]=D.subarray(O[N][1]*k,O[N+1][1]*k);return O.length>=1&&(U[O[O.length-1][0]]=D.subarray(O[O.length-1][1]*k)),{R:v,cells:U}}function x5(e,t){var r,n=zt(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Et(n[7][0].data)>>>0>0?1:0:-1,s=n1(n[5],function(a){return v5(a,i)});return{nrows:Et(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function _5(e,t,r){var n,i=zt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Et(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Et(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Re(s);var a=zt(i[4][0].data),o=Ov(e,e[Ai(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Ov(e,e[Ai(a[17][0].data)][0]):[],c=zt(a[3][0].data),u=0;c[1].forEach(function(f){var h=zt(f.data),d=e[Ai(h[2][0].data)][0],p=Et(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=x5(e,d);m.data.forEach(function(_,v){_.forEach(function(x,g){var S=_e({r:u+v,c:g}),D=g5(x,o,l);D&&(r[S]=D)})}),u+=m.nrows})}function y5(e,t){var r=zt(t.data),n={"!ref":"A1"},i=e[Ai(r[2][0].data)],s=Et(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return _5(e,i[0],n),n}function E5(e,t){var r,n=zt(t.data),i={name:(r=n[1])!=null&&r[0]?zh(n[1][0].data):"",sheets:[]},s=n1(n[2],Ai);return s.forEach(function(a){e[a].forEach(function(o){var l=Et(o.meta[1][0].data);l==6e3&&i.sheets.push(y5(e,o))})}),i}function w5(e,t){var r=a1(),n=zt(t.data),i=n1(n[1],Ai);if(i.forEach(function(s){e[s].forEach(function(a){var o=Et(a.meta[1][0].data);if(o==2){var l=E5(e,a);l.sheets.forEach(function(c,u){o1(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function xf(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=d5(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=f5(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Et(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var u=Et(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return w5(s,o)}function T5(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function i1(e){T5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function k5(e){return $s.WS.indexOf(e)>-1?"sheet":e==$s.CS?"chart":e==$s.DS?"dialog":e==$s.MS?"macro":e&&e.length?e:"sheet"}function S5(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,k5(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function C5(e,t,r,n,i,s,a,o,l,c,u,f){try{s[n]=Fo(xr(e,r,!0),t);var h=ft(e,t),d;switch(o){case"sheet":d=DM(h,t,i,l,s[n],c,u,f);break;case"chart":if(d=OM(h,t,i,l,s[n],c,u,f),!d||!d["!drawel"])break;var p=lo(d["!drawel"].Target,t),m=Bh(p),_=N8(xr(e,p,!0),Fo(xr(e,m,!0),p)),v=lo(_,p),x=Bh(v);d=mM(xr(e,v,!0),v,l,Fo(xr(e,x,!0),v),c,d);break;case"macro":d=PM(h,t,i,l,s[n],c,u,f);break;case"dialog":d=LM(h,t,i,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var g=[];s&&s[n]&&mn(s[n]).forEach(function(S){var D="";if(s[n][S].Type==$s.CMNT){D=lo(s[n][S].Target,t);var k=UM(ft(e,D,!0),D,l);if(!k||!k.length)return;xv(d,k,!1)}s[n][S].Type==$s.TCMNT&&(D=lo(s[n][S].Target,t),g=g.concat(O8(ft(e,D,!0),l)))}),g&&g.length&&xv(d,g,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function Ar(e){return e.charAt(0)=="/"?e.slice(1):e}function A5(e,t){if(gw(),t=t||{},i1(t),Fr(e,"META-INF/manifest.xml")||Fr(e,"objectdata.xml"))return Rv(e,t);if(Fr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xf<"u"){if(e.FileIndex)return xf(e);var r=Fe.utils.cfb_new();return $g(e).forEach(function(me){I3(r,me,A3(e,me))}),xf(r)}throw new Error("Unsupported NUMBERS file")}if(!Fr(e,"[Content_Types].xml"))throw Fr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=$g(e),i=TD(xr(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",ft(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!ft(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Do=[],i.sst)try{Do=BM(ft(e,Ar(i.sst)),i.sst,t)}catch(me){if(t.WTF)throw me}t.cellStyles&&i.themes.length&&(l=bM(xr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=MM(ft(e,Ar(i.style)),i.style,l,t))}i.links.map(function(me){try{var ie=Fo(xr(e,Bh(Ar(me))),me);return HM(ft(e,Ar(me)),ie,me,t)}catch{}});var u=NM(ft(e,Ar(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=ft(e,Ar(i.coreprops[0]),!0),h&&(f=$w(h)),i.extprops.length!==0&&(h=ft(e,Ar(i.extprops[0]),!0),h&&ID(h,f,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=xr(e,Ar(i.custprops[0]),!0),h&&(d=RD(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(ie){return ie.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=d),t.bookSheets&&typeof a<"u"&&(p.SheetNames=a),t.bookSheets?p.SheetNames:t.bookProps))return p;a={};var m={};t.bookDeps&&i.calcchain&&(m=WM(ft(e,Ar(i.calcchain)),i.calcchain));var _=0,v={},x,g;{var S=u.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var D=0;D!=S.length;++D)f.SheetNames[D]=S[D].name}var k=s?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),O=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Fr(e,O)||(O="xl/_rels/workbook."+k+".rels");var N=Fo(xr(e,O,!0),O.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=VM(ft(e,Ar(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=P8(ft(e,Ar(i.people[0])),t)),N&&(N=S5(N,u.Sheets));var B=ft(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var U="sheet";if(N&&N[_]?(x="xl/"+N[_][1].replace(/[\/]?xl\//,""),Fr(e,x)||(x=N[_][1]),Fr(e,x)||(x=O.replace(/_rels\/.*$/,"")+N[_][1]),U=N[_][2]):(x="xl/worksheets/sheet"+(_+1-B)+"."+k,x=x.replace(/sheet0\./,"sheet.")),g=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var b=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==_&&(b=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==f.SheetNames[_].toLowerCase()&&(b=1);if(!b)continue e}}C5(e,x,g,f.SheetNames[_],_,v,a,U,t,u,l,c)}return p={Directory:i,Workbook:u,Props:f,Custprops:d,Deps:m,Sheets:a,SheetNames:f.SheetNames,Strings:Do,Styles:c,Themes:l,SSF:Dt(Ee)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(me,ie){me=me.replace(/^Root Entry[\/]/,""),p.keys.push(me),p.files[me]=e.FileIndex[ie]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=ft(e,Ar(i.vba[0]),!0):i.defaults&&i.defaults.bin===B8&&(p.vbaraw=ft(e,"xl/vbaProject.bin",!0))),p}function I5(e,t){var r=t||{},n="Workbook",i=Fe.find(e,n);try{if(n="/!DataSpaces/Version",i=Fe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(yP(i.content),n="/!DataSpaces/DataSpaceMap",i=Fe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=wP(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Fe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=TP(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Fe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);SP(i.content)}catch{}if(n="/EncryptionInfo",i=Fe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=CP(i.content);if(n="/EncryptedPackage",i=Fe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function s1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=wr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function F5(e,t){return Fe.find(e,"EncryptedPackage")?I5(e,t):F2(e,t)}function R5(e,t){var r,n=e,i=t||{};return i.type||(i.type=Ie&&Buffer.isBuffer(e)?"buffer":"base64"),r=ww(n,i),A5(r,i)}function O2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Hh(e.slice(r),t);default:break e}return dl.to_workbook(e,t)}function N5(e,t){var r="",n=s1(e,t);switch(t.type){case"base64":r=wr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ps(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ze(r)),t.type="binary",O2(r,t)}function D5(e,t){var r=e;return t.type=="base64"&&(r=wr(r)),r=ai.utils.decode(1200,r.slice(2),"str"),t.type="binary",O2(r,t)}function O5(e){return e.match(/[^\x00-\x7F]/)?co(e):e}function _f(e,t,r,n){return n?(r.type="string",dl.to_workbook(e,r)):dl.to_workbook(t,r)}function $h(e,t){iw();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $h(new Uint8Array(e),(r=Dt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),sa={},r.dateNF&&(sa.dateNF=r.dateNF),r.type||(r.type=Ie&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ie?"buffer":"binary",n=y3(e),typeof Uint8Array<"u"&&!Ie&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=O5(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Dt(r),r.type="array",$h(bp(n),r)}switch((i=s1(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return F5(Fe.read(n,r),r);break;case 9:if(i[1]<=8)return F2(n,r);break;case 60:return Hh(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return oP(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return sP.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?R5(n,r):_f(e,n,r,s);case 239:return i[3]===60?Hh(n,r):_f(e,n,r,s);case 255:if(i[1]===254)return D5(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return No.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return No.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return vv.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return BP.to_workbook(n,r);break;case 10:case 13:case 32:return N5(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return nP.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?vv.to_workbook(n,r):_f(e,n,r,s)}function P5(e,t,r,n,i,s,a,o){var l=Ot(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var p=a?e[r][d]:e[n[d]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[d]!=null){if(m==null)if(p.t=="e"&&m===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(u&&m===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:zn(p,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Gh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=it(u);break;case"number":l=it(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=Ot(l.s.r),h=[],d=[],p=0,m=0,_=Array.isArray(e),v=l.s.r,x=0,g={};_&&!e[v]&&(e[v]=[]);var S=c.skipHidden&&e["!cols"]||[],D=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(S[x]||{}).hidden)switch(h[x]=yt(x),r=_?e[v][x]:e[h[x]+f],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=h[x];break;case 3:s[x]=c.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=zn(r,null,c),m=g[a]||0,!m)g[a]=1;else{do o=a+"_"+m++;while(g[o]);g[a]=m,g[o]=1}s[x]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(D[v]||{}).hidden){var k=P5(e,l,v,h,n,s,_,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[p++]=k.row)}return d.length=p,d}var Pv=/"/g;function L5(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=Ot(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:zn(d,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){u='"'+u.replace(Pv,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Pv,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function P2(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=it(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(f[p]=yt(p));for(var m=0,_=i.s.r;_<=i.e.r;++_)(d[_]||{}).hidden||(u=L5(e,i,_,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function M5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=P2(e,t);return r}function b5(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=it(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=yt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Ot(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function L2(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Zt(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=it(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(m,_){mn(m).forEach(function(v){(d=h.indexOf(v))==-1&&(h[d=h.length]=v);var x=m[v],g="z",S="",D=_e({c:o+d,r:a+_+i});c=vl(s,D),x&&typeof x=="object"&&!(x instanceof Date)?s[D]=x:(typeof x=="number"?g="n":typeof x=="boolean"?g="b":typeof x=="string"?g="s":x instanceof Date?(g="d",n.cellDates||(g="n",x=ir(x)),S=n.dateNF||Ee[14]):x===null&&n.nullError&&(g="e",x=0),c?(c.t=g,c.v=x,delete c.w,delete c.R,S&&(c.z=S)):s[D]=c={t:g,v:x},S&&(c.z=S))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var p=Ot(a);if(i)for(d=0;d<h.length;++d)s[yt(d+o)+p]={t:"s",v:h[d]};return s["!ref"]=Re(u),s}function B5(e,t){return L2(null,e,t)}function vl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Zt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vl(e,_e(t)):vl(e,_e({r:t,c:r||0}))}function U5(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function a1(){return{SheetNames:[],Sheets:{}}}function o1(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(TM(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function W5(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=U5(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function H5(e,t){return e.z=t,e}function M2(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function V5(e,t,r){return M2(e,"#"+t,r)}function z5(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function j5(e,t,r,n){for(var i=typeof t!="string"?t:it(t),s=typeof t=="string"?t:Re(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=vl(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var $5={encode_col:yt,encode_row:Ot,encode_cell:_e,encode_range:Re,decode_col:Gp,decode_row:$p,split_cell:rD,decode_cell:Zt,decode_range:La,format_cell:zn,sheet_add_aoa:Ww,sheet_add_json:L2,sheet_add_dom:R2,aoa_to_sheet:Ma,json_to_sheet:B5,table_to_sheet:N2,table_to_book:o5,sheet_to_csv:P2,sheet_to_txt:M5,sheet_to_json:Gh,sheet_to_html:a5,sheet_to_formulae:b5,sheet_to_row_object_array:Gh,sheet_get_cell:vl,book_new:a1,book_append_sheet:o1,book_set_sheet_visibility:W5,cell_set_number_format:H5,cell_set_hyperlink:M2,cell_set_internal_link:V5,cell_add_comment:z5,sheet_set_array_formula:j5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const G5={customerName:["nom","client","nom client","customer","customer name"],address:["adresse","address","adresse client"],phoneNumber:["telephone","tlphone","tel","tl","phone","numro"],treeSize:["taille","size","taille sapin","tree size"],requestedDeliveryDate:["date","date souhaite","date livraison","delivery date"]},K5={scoutDeliveryRequested:["scout","livraison scout","scout delivery","livraison par scout","demande scout","scout demand"]},X5=e=>{const t={},r=e.map(n=>(n==null?void 0:n.toLowerCase().trim())||"");return Object.entries(G5).forEach(([n,i])=>{const s=r.findIndex(a=>i.some(o=>a.includes(o)));if(s===-1)throw new Error(`Colonne obligatoire manquante: ${n}`);t[n]=e[s]}),Object.entries(K5).forEach(([n,i])=>{const s=r.findIndex(a=>i.some(o=>a.includes(o)));s!==-1?t[n]=e[s]:console.log(`Info: Colonne optionnelle non trouve: ${n}. Une valeur par dfaut sera utilise.`)}),t},Y5=e=>{if(!e)return"";const t=String(e).replace(/\D/g,"");return(t.length===9?`0${t}`:t).replace(/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5")},q5=e=>{if(!e)return null;if(typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;try{if(typeof e=="number"){const t=new Date((e-25569)*86400*1e3),r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${i}`}if(typeof e=="string"){const[t,r,n]=e.split("/");if(t&&r&&n)return`${n}-${r.padStart(2,"0")}-${t.padStart(2,"0")}`}return null}catch(t){return console.error("Erreur lors du parsing de la date:",t),null}},Q5=e=>{if(e==null)return!1;if(typeof e=="boolean")return e;if(typeof e=="number")return e===1;const t=String(e).toLowerCase().trim();return["true","oui","yes","1","vrai","x"].includes(t)},J5=(e,t)=>{var c,u,f;const r=[];let n,i,s,a,o,l;try{if(n=(c=e[t.customerName])==null?void 0:c.toString().trim(),n?n.length<2&&r.push("Nom du client trop court"):r.push("Nom du client manquant"),i=(u=e[t.address])==null?void 0:u.toString().trim(),i?i.length<5&&r.push("Adresse trop courte"):r.push("Adresse manquante"),s=Y5(e[t.phoneNumber]),(!s||s.length!==14)&&r.push("Numro de tlphone invalide (format attendu: XX XX XX XX XX)"),a=(f=e[t.treeSize])==null?void 0:f.toString().trim(),a||r.push("Taille du sapin manquante"),o=q5(e[t.requestedDeliveryDate]),o||r.push("Date de livraison invalide (format attendu: JJ/MM/AAAA)"),l=t.scoutDeliveryRequested?Q5(e[t.scoutDeliveryRequested]):!1,r.length>0)throw new Error(`Erreurs pour "${n||"Client inconnu"}": ${r.join(", ")}`);return{customerName:n,address:i,phoneNumber:s,treeSize:a,requestedDeliveryDate:o,isDelivered:!1,scoutDeliveryRequested:l}}catch(h){throw new Error(`Erreur de validation: ${h.message}`)}};function Z5(){const[e,t]=Ke.useState(null),[r,n]=Ke.useState(null),i=Ke.useRef(null),s=async a=>{try{t(null),n(null);const o=a.target.files[0];if(!o)return;const l=await o.arrayBuffer(),c=$h(l),u=c.Sheets[c.SheetNames[0]],f=$5.sheet_to_json(u);if(!f||f.length===0)throw new Error("Le fichier Excel est vide ou mal format");console.log("Donnes Excel brutes:",f);const h=X5(Object.keys(f[0]));console.log("Mapping des colonnes:",h);const d=Cu(Ng,"deliveries"),m=(await wN(d)).val()||{},_=new Set(Object.values(m).map(S=>`${S.customerName}-${S.phoneNumber}-${S.treeSize}`)),v={},x=[],g=[];for(const[S,D]of f.entries())try{console.log(`Traitement ligne ${S+2}:`,D);const k=J5(D,h);console.log("Livraison valide:",k);const E=`${k.customerName}-${k.phoneNumber}-${k.treeSize}`;if(_.has(E)){x.push(k.customerName);continue}const O=`delivery_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;v[O]={...k,history:{[`${Date.now()}`]:{userId:"import_excel",timestamp:Date.now(),action:"Import depuis Excel",previousStatus:!1,newStatus:!1}}}}catch(k){console.error(`Erreur ligne ${S+2}:`,k),g.push(`Ligne ${S+2}: ${k.message}`)}if(g.length>0)throw new Error(`Erreurs lors de l'import:
`+g.join(`
`));if(Object.keys(v).length===0&&x.length===0)throw new Error("Aucune donne valide  importer");Object.keys(v).length>0&&await yN(Cu(Ng,"deliveries"),{...m,...v}),n(`${Object.keys(v).length} livraisons importes avec succs.${x.length>0?`
${x.length} doublons ignors.`:""}`),i.current&&(i.current.value="")}catch(o){console.error("Erreur lors de l'import:",o),t(o.message)}};return K.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg shadow",children:[K.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Importer des commandes depuis Excel"}),K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{children:[K.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Format du fichier Excel :"}),K.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[K.jsxs("li",{children:[K.jsx("strong",{children:"Nom client"})," ou ",K.jsx("strong",{children:"Client"})," (obligatoire)"]}),K.jsxs("li",{children:[K.jsx("strong",{children:"Adresse"})," (obligatoire)"]}),K.jsxs("li",{children:[K.jsx("strong",{children:"Tlphone"})," ou ",K.jsx("strong",{children:"Tl"})," (obligatoire)"]}),K.jsxs("li",{children:[K.jsx("strong",{children:"Taille sapin"})," (obligatoire)"]}),K.jsxs("li",{children:[K.jsx("strong",{children:"Date souhaite"})," (obligatoire, format JJ/MM/AAAA)"]}),K.jsxs("li",{children:[K.jsx("strong",{children:"Scout"})," (optionnel, valeurs acceptes : oui, non, true, false, x)"]})]}),K.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Note : Les en-ttes de colonnes peuvent varier lgrement mais doivent contenir les mots-cls ci-dessus."})]}),K.jsx("div",{className:"flex items-center gap-4",children:K.jsx("input",{type:"file",ref:i,onChange:s,accept:".xlsx,.xls",className:`block w-full text-sm text-gray-500
              file:mr-4 file:py-2 file:px-4
              file:rounded-md file:border-0
              file:text-sm file:font-semibold
              file:bg-green-50 file:text-green-700
              hover:file:bg-green-100
              cursor-pointer`})}),e&&K.jsxs("div",{className:"bg-red-50 text-red-700 p-3 rounded-md",children:[K.jsx("p",{className:"font-semibold",children:"Erreur :"}),K.jsx("p",{className:"whitespace-pre-line",children:e})]}),r&&K.jsxs("div",{className:"bg-green-50 text-green-700 p-3 rounded-md",children:[K.jsx("p",{className:"font-semibold",children:"Succs :"}),K.jsx("p",{className:"whitespace-pre-line",children:r})]})]})]})}const eb=e=>{const t=e.replace(/\D/g,"");return t.length===10?t.replace(/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/,"$1 $2 $3 $4 $5"):e},tb=e=>{if(!e)return"";const[t,r,n]=e.split("-");return`${n}/${r}/${t}`},rb=()=>K.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 border border-yellow-200",children:[K.jsx("span",{className:"mr-1",children:""}),"Scout"]});function nb({user:e}){const[t,r]=Ke.useState([]),[n,i]=Ke.useState(""),[s,a]=Ke.useState("name"),[o,l]=Ke.useState(null),[c,u]=Ke.useState(!1),[f,h]=Ke.useState(!1);Ke.useEffect(()=>{const k=Lh(),E=Cu(k,"deliveries"),O=kN(E,N=>{const B=N.val(),U=B?Object.entries(B).map(([b,Y])=>({id:b,...Y,scoutDeliveryRequested:Y.scoutDeliveryRequested||!1})):[];if(f){const b=m(U,s);r(b)}else r(U)});return()=>O()},[s,f]);const d=async()=>{try{await nI(zy())}catch(k){console.error("Erreur de dconnexion:",k)}},p=async k=>{h(!1);const E=Lh(),O=Cu(E,`deliveries/${k.id}`),N=!k.isDelivered;try{await EN(O,{isDelivered:N,deliveryDate:N?Rg():null,[`history/${Date.now()}`]:{userId:e.email,timestamp:Rg(),action:N?"Marqu comme livr":"Marqu comme non livr",previousStatus:k.isDelivered,newStatus:N}})}catch(B){console.error("Erreur lors de la mise  jour:",B)}},m=(k,E)=>[...k].sort((O,N)=>{switch(E){case"name":return O.customerName.localeCompare(N.customerName);case"status":return O.isDelivered===N.isDelivered?0:O.isDelivered?1:-1;case"size":return O.treeSize.localeCompare(N.treeSize);case"date":return(O.requestedDeliveryDate||"").localeCompare(N.requestedDeliveryDate||"");case"scout":return O.scoutDeliveryRequested===N.scoutDeliveryRequested?0:O.scoutDeliveryRequested?-1:1;default:return 0}}),_=k=>{a(k),h(!0);const E=m([...t],k);r(E)},v=t.filter(k=>{const E=n.toLowerCase();return k.customerName.toLowerCase().includes(E)||k.phoneNumber.replace(/\s/g,"").includes(n.replace(/\s/g,""))}),x=v.filter(k=>!k.isDelivered).length,g=v.length,S=v.filter(k=>k.scoutDeliveryRequested&&!k.isDelivered).length,D=v.filter(k=>k.scoutDeliveryRequested).length;return K.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-green-800 to-green-600",children:[K.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:K.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6",children:[K.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8",children:[K.jsx("h1",{className:"text-3xl font-bold text-green-800 mb-4 sm:mb-0",children:" Les Sapins de Saint Roch"}),K.jsxs("div",{className:"flex gap-4",children:[K.jsx("button",{onClick:()=>u(!c),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200",children:c?"Masquer l'import":"Importer des commandes"}),K.jsx("button",{onClick:d,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Se dconnecter"})]})]}),c&&K.jsx("div",{className:"mb-8",children:K.jsx(Z5,{})}),K.jsx("div",{className:"grid gap-4 mb-6",children:K.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[K.jsx("h2",{className:"text-lg font-bold text-green-800 mb-2",children:"Rsum des livraisons"}),K.jsxs("div",{className:"space-y-2",children:[K.jsxs("p",{children:[K.jsx("strong",{children:x})," sapins restant  livrer sur ",g," commandes"]}),K.jsxs("p",{className:"flex items-center gap-2",children:[K.jsx("span",{className:"inline-block",children:""}),K.jsxs("span",{children:[K.jsx("strong",{children:S})," livraisons scouts en attente sur ",D," demandes"]})]})]})]})}),K.jsxs("div",{className:"grid gap-6 mb-6 sm:grid-cols-2",children:[K.jsx(HN,{searchTerm:n,onSearchChange:i}),K.jsx(VN,{sortBy:s,onSortChange:_})]}),K.jsx("div",{className:"space-y-4",children:v.map(k=>K.jsx("div",{className:`p-4 rounded-lg shadow transition-colors duration-200 ${k.isDelivered?"bg-green-50":k.scoutDeliveryRequested?"bg-yellow-50 border border-yellow-200":"bg-white"}`,children:K.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[K.jsxs("div",{className:"flex-1",children:[K.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[K.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:k.customerName}),k.scoutDeliveryRequested&&K.jsx(rb,{})]}),K.jsx("p",{className:"text-gray-600",children:k.address}),K.jsxs("p",{className:"text-gray-600",children:["Tl: ",eb(k.phoneNumber)]}),K.jsxs("p",{className:"text-gray-600",children:[K.jsx("strong",{children:"Taille du sapin:"})," ",K.jsx("span",{className:"font-extrabold text-lg",children:k.treeSize})]}),K.jsxs("p",{className:"text-gray-600",children:[K.jsx("strong",{children:"Date souhaite:"})," ",tb(k.requestedDeliveryDate)]}),K.jsx("button",{onClick:()=>l(k),className:"text-sm text-green-600 hover:text-green-800 mt-2",children:"Voir l'historique"})]}),K.jsx("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:K.jsx("button",{onClick:()=>p(k),className:`px-4 py-2 rounded-lg transition-colors duration-200 ${k.isDelivered?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-600 text-white hover:bg-green-700"}`,children:k.isDelivered?"Annuler":"Marquer comme livr"})})]})},k.id))})]})}),o&&K.jsx(zN,{delivery:o,onClose:()=>l(null)})]})}function ib(){const{user:e,loading:t}=bN();return t?K.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:K.jsx("div",{className:"text-2xl text-green-600",children:"Chargement..."})}):e?K.jsx(nb,{user:e}):K.jsx(BN,{})}K_(document.getElementById("root")).render(K.jsx(pT.StrictMode,{children:K.jsx(ib,{})}));
